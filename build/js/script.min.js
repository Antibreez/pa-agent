"use strict";!function(){var e=document.querySelectorAll(".checkbox-2__input");e[0]&&e.forEach((function(e){e.addEventListener("change",(function(e){var t=e.target;!0===t.checked?t.parentNode.classList.add("checked"):t.parentNode.classList.remove("checked")}))}))}(),$(".date-input").datepicker(),function(){var e=document.querySelectorAll(".input-file__label");function t(e){var t=e.querySelector("input"),n=e.parentNode.querySelector(".file-load__clear");function a(e){e.preventDefault(),e.stopPropagation()}function i(t){e.classList.add("highlight")}function o(t){e.classList.remove("highlight")}["dragenter","dragover","dragleave","drop"].forEach((function(t){e.addEventListener(t,a,!1)})),["dragenter","dragover"].forEach((function(t){e.addEventListener(t,i,!1)})),["dragleave","drop"].forEach((function(t){e.addEventListener(t,o,!1)})),e.addEventListener("drop",(function(e){var n=e.dataTransfer.files;t.files&&t.files[0]&&(t.value="",/safari/i.test(navigator.userAgent)||(t.type="",t.type="file"));t.files=n,c()}),!1);var c=function(){r(t)},r=function(t){if(t.files&&t.files[0]){var n=new FileReader;n.onload=function(n){e.parentNode.classList.add("loaded"),e.nextElementSibling.querySelector(".file-load__name").textContent=t.files[0].name},n.readAsDataURL(t.files[0])}};t.addEventListener("change",c),n.addEventListener("click",(function(){e.parentNode.classList.remove("loaded"),t.value="",/safari/i.test(navigator.userAgent)||(t.type="",t.type="file")}))}window.makeFileLoad=t,e[0]&&e.forEach((function(e){t(e)}))}(),function(){var e=document.querySelectorAll(".input-text");e[0]&&e.forEach((function(e){e.addEventListener("blur",(function(){""===e.value.split(" ").join("")&&(e.value=""),""===e.value||e.classList.contains("js-inputed")||e.classList.add("js-inputed"),""===e.value&&e.classList.contains("js-inputed")&&e.classList.remove("js-inputed")}))}))}(),function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"));var t=document.querySelector("body");function n(e,t){this.trigger=e,this.modal=t,this.overlay=this.modal.querySelector(".modal__overlay"),this.closeBtn=this.modal.querySelector(".modal__close"),this.onOverlayClick=this.onOverlayClick.bind(this),this.onCloseClick=this.onCloseClick.bind(this),this.onTriggerClick=this.onTriggerClick.bind(this),this.onResize=this.onResize.bind(this),this.addEventListeners()}n.prototype.open=function(){this.modal.classList.add("js-show"),t.classList.add("js__body-no-scroll")},n.prototype.close=function(){this.modal.classList.remove("js-show"),t.classList.remove("js__body-no-scroll")},n.prototype.onOverlayClick=function(e){e.target===this.overlay&&this.close()},n.prototype.onCloseClick=function(){this.close()},n.prototype.onTriggerClick=function(){this.open()},n.prototype.onResize=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))},n.prototype.addEventListeners=function(){var e,t;this.overlay.addEventListener("click",this.onOverlayClick),this.closeBtn.addEventListener("click",this.onCloseClick),this.trigger.addEventListener("click",this.onTriggerClick),window.addEventListener("resize",(e=this.onResize,function(n){t&&clearTimeout(t),t=setTimeout(e,100,n)}))},window.Modal=n}(),$(".input-money").mask("# ##0 ₽",{reverse:!0}),function(){var e=document.querySelectorAll(".input-phone");if(e[0]){var t=new Inputmask("+7(999) 999-99-99");e.forEach((function(e){t.mask(e)}))}}(),function(){var e=document.querySelectorAll(".search"),t=document.querySelectorAll(".search + .search-close");e[0]&&(e.forEach((function(e){e.addEventListener("blur",(function(){""===e.value.split(" ").join("")&&(e.value=""),""===e.value||e.classList.contains("js-inputed")||e.classList.add("js-inputed"),""===e.value&&e.classList.contains("js-inputed")&&e.classList.remove("js-inputed")}))})),t.forEach((function(e){e.addEventListener("click",(function(){var t=e.previousElementSibling;t.value="",t.classList.contains("js-inputed")&&t.classList.remove("js-inputed")}))})))}(),function(){function e(e){var t=e.text.split("splitter");return t.length>1?$("<span>"+t[0]+"</span><span>"+t[1]+"</span>"):e.text}$(".select").select2({templateResult:e,templateSelection:e}),$(".select").on("select2:select",(function(e){$(this).addClass("picked")}))}(),function(){var e=document.querySelectorAll(".delivery-or-pickup__modal-time");if(e[0]){var t=new Inputmask("99:99");e.forEach((function(e){t.mask(e)}))}}(),$(".agents__users-btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){var e=document.querySelectorAll(".contract-info__cancellation");if(e[0]){var t=document.getElementById("cancellation__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".contract-creation__client-type  input");if(e[0]){var t=document.querySelector(".contract-creation__details");e.forEach((function(e){e.addEventListener("change",n)}))}function n(){e[0].checked&&t.classList.remove("show-for-entity"),e[1].checked&&t.classList.add("show-for-entity")}}(),$(".delivery-or-pickup.done").click((function(){$(this).find(".contract-info__delivered-adress").slideToggle(),$(this).find(".contract-info__delivered-toggle").toggleClass("opened")})),function(){if(document.querySelector(".contract-services")){var e=document.querySelectorAll(".contract-services__link"),t=function(e){var t=e.target;(t.classList.contains("checkbox-btn__label")||t.classList.contains("checkbox-btn__checkbox")||t.classList.contains("deliver-or-pickup__confirm-btn")||t.classList.contains("contract-services__delivery-confirm"))&&e.preventDefault()};e.forEach((function(e){e.addEventListener("click",t)}))}}(),function(){var e=document.querySelectorAll(".contracts__link");if(e[0]){var t=function(e){var t=e.target;(t.classList.contains("checkbox-btn__label")||t.classList.contains("checkbox-btn__checkbox")||t.classList.contains("contract-info__verification")||t.classList.contains("payment-waiting__confirm-btn")||t.classList.contains("contract-services__delivery-confirm"))&&e.preventDefault()};e.forEach((function(e){e.addEventListener("click",t)}))}}(),function(){var e=document.querySelectorAll(".subscription-page__action-item--delete");if(e[0]){var t=document.getElementById("delete-service__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".deliver-or-pickup__confirm-btn");if(e[0]){var t=document.getElementById("delivery-or-pickup__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("delivery-or-pickup__modal");if(e){$("#delivery-date").datepicker().on("change",(function(e){u()}));var t=e.querySelector(".modal__close"),n=e.querySelector(".modal__overlay"),a=e.querySelector(".modal__submit"),i=e.querySelector(".delivery-or-pickup__modal-input-file"),o=e.querySelector(".input-file__input"),c=e.querySelector(".file-load__clear"),r=e.querySelector(".delivery-or-pickup__modal-date"),s=e.querySelector(".delivery-or-pickup__modal-time"),l=e.querySelector(".checkbox__input"),d=function(){i.classList.contains("loaded")&&(i.classList.remove("loaded"),o.value="",a.setAttribute("disabled",""),/safari/i.test(navigator.userAgent)||(o.type="",o.type="file")),r.value="",s.value="",l.checked=!1,$("#delivery-date").datepicker("setDate","")},u=function(e){f()&&a.hasAttribute("disabled")?a.removeAttribute("disabled"):f()||a.hasAttribute("disabled")||a.setAttribute("disabled","")},f=function(){return $("#delivery-date").datepicker("getDate")&&""!==s.value&&!0===l.checked&&""!==o.value};t.addEventListener("click",d),n.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&d()})),r.addEventListener("input",u),s.addEventListener("input",u),o.addEventListener("change",u),l.addEventListener("change",u),c.addEventListener("click",(function(){a.hasAttribute("disabled")||a.setAttribute("disabled","")}))}}(),function(){var e=$(".mutual-calcs__earned-date-menu");$(".mutual-calcs__earned-date-btn");$.extend($.datepicker,{_inlineDatepicker2:$.datepicker._inlineDatepicker,_inlineDatepicker:function(e,t){this._inlineDatepicker2(e,t);var n=$.datepicker._get(t,"beforeShow");n&&n.apply(e,[e,t])}}),$(".mutual-calcs__earned-date-btn").on("click",(function(){$(".mutual-calcs__earned-date-menu").toggle()})),$(".date-input-period").datepicker({range:"period",inline:!0,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0,closeText:"Готово",beforeShow:function(e,t){t.dpDiv.css("transform","translateX(-24px)"),t.dpDiv.addClass("calendar-range")},onSelect:function(e,t,n){$(".mutual-calcs__earned-date-btn").text(n.startDateText+" - "+n.endDateText)}}),$(document).mouseup((function(e){var t=$(".mutual-calcs__earned-date-menu"),n=$(".mutual-calcs__earned-date-btn");t.is(e.target)||0!==t.has(e.target).length||n.is(e.target)||0!==n.has(e.target).length||t.hide()})),$(".mutual-calcs__earned-date-menu-btn").on("click",(function(){$(this).hasClass("all-time")?$(".mutual-calcs__earned-date-btn").text($(this).text()+" (с "+$(".earned-date__start-period").text()+")"):$(".mutual-calcs__earned-date-btn").text($(this).text()),e.hide()})),$(".mutual-calcs__earned-date-btn").text($(".mutual-calcs__earned-date-menu-btn.all-time").text()+" (с "+$(".earned-date__start-period").text()+")")}(),$(".filters__btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){var e=document.querySelectorAll(".installation__confirm-btn");if(e[0]){var t=document.getElementById("installation__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".delivery-or-pickup__installation-choose-block  input");if(e[0]){var t=e[0].parentNode.parentNode.parentNode.parentNode;e.forEach((function(e){e.addEventListener("change",n)}))}function n(){console.log(t),e[0].checked&&(t.classList.contains("show-for-manual")&&t.classList.remove("show-for-manual"),t.classList.contains("show-for-registration")&&t.classList.remove("show-for-registration"),t.classList.contains("show-for-delivery")||t.classList.add("show-for-delivery")),e[1].checked&&(t.classList.contains("show-for-manual")&&t.classList.remove("show-for-manual"),t.classList.contains("show-for-delivery")&&t.classList.remove("show-for-delivery"),t.classList.contains("show-for-registration")||t.classList.add("show-for-registration")),e[2].checked&&(t.classList.contains("show-for-delivery")&&t.classList.remove("show-for-delivery"),t.classList.contains("show-for-registration")&&t.classList.remove("show-for-registration"),t.classList.contains("show-for-manual")||t.classList.add("show-for-manual"))}}(),function(){var e=document.getElementById("installation__modal");if(e){$("#delivery-date").datepicker().on("change",(function(e){s()}));var t=e.querySelector(".modal__close"),n=e.querySelector(".modal__overlay"),a=e.querySelector(".modal__submit"),i=e.querySelector(".delivery-or-pickup__modal-date"),o=e.querySelector(".delivery-or-pickup__modal-time"),c=e.querySelector(".checkbox__input"),r=function(){i.value="",o.value="",c.checked=!1,$("#delivery-date").datepicker("setDate","")},s=function(e){l()&&a.hasAttribute("disabled")?a.removeAttribute("disabled"):l()||a.hasAttribute("disabled")||a.setAttribute("disabled","")},l=function(){return $("#delivery-date").datepicker("getDate")&&""!==o.value&&!0===c.checked};t.addEventListener("click",r),n.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&r()})),i.addEventListener("input",s),o.addEventListener("input",s),c.addEventListener("change",s)}}(),function(){var e=document.querySelectorAll(".mutual-calcs__make-payment");if(e[0]){var t=document.getElementById("payment-waiting__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".payment-waiting__confirm-btn");if(e[0]){var t=document.getElementById("payment-waiting__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("payment-waiting__modal");if(e){var t=e.querySelector(".modal__close"),n=e.querySelector(".modal__overlay"),a=e.querySelector(".transactions__check-all input"),i=e.querySelector(".payment-waiting__modal-sender input"),o=e.querySelector(".payment-waiting__modal-recipient input"),c=e.querySelector(".payment-waiting__modal-sum input"),r=e.querySelector(".payment-waiting__modal-purpose input"),s=function(){return e.querySelectorAll(".transactions__check input")},l=function(){a.checked=!1,s().forEach((function(e){e.checked=!1,e.parentNode.parentNode.parentNode.parentNode.classList.remove("checked")})),$("#payment-date").datepicker("setDate",""),i.value="",o.value="",c.value="",r.value=""},d=function(e){e.target.checked?e.target.parentNode.parentNode.parentNode.parentNode.classList.add("checked"):e.target.parentNode.parentNode.parentNode.parentNode.classList.remove("checked")};t.addEventListener("click",l),n.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&l()})),a.addEventListener("change",(function(){s().forEach((function(e){var t=e.parentNode.parentNode.parentNode.parentNode;a.checked?(e.checked=!0,t.classList.contains("checked")||t.classList.add("checked")):(e.checked=!1,t.classList.contains("checked")&&t.classList.remove("checked"))}))})),s().forEach((function(e){e.addEventListener("change",d)}))}}(),function(){var e=document.querySelectorAll(".mutual-calcs-payment-block__link");if(e[0]){var t=document.getElementById("payment-info__modal");e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".contract-device__schedule");if(e[0]){var t=document.getElementById("schedule__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){if(document.getElementById("schedule__modal")){var e=document.querySelectorAll(".schedule__modal-toggle input"),t=document.querySelector(".schedule__modal-toggle");e.forEach((function(e,n){e.addEventListener("change",(function(){0===n&&(t.classList.remove("second-tab"),t.classList.add("first-tab")),1===n&&(t.classList.remove("first-tab"),t.classList.add("second-tab"))}))}))}}(),$(".support__docs-btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){var e=document.querySelectorAll(".contract-info__verification");if(e[0]){var t=document.getElementById("verification__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("verification__modal");if(e){var t=e.querySelector(".verification__modal-input-file"),n=e.querySelector(".input-file__input"),a=e.querySelector(".modal__close"),i=e.querySelector(".modal__overlay"),o=e.querySelector(".modal__save"),c=e.querySelector(".file-load__clear"),r=function(){t.classList.contains("loaded")&&(t.classList.remove("loaded"),n.value="",o.setAttribute("disabled",""),/safari/i.test(navigator.userAgent)||(n.type="",n.type="file"))};a.addEventListener("click",r),i.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&r()})),n.addEventListener("change",(function(){""!==n.value&&o.removeAttribute("disabled")})),c.addEventListener("click",(function(){o.hasAttribute("disabled")||o.setAttribute("disabled","")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyIsImNoZWNrYm94LTIuanMiLCJkYXRlLWlucHV0LmpzIiwiaW5wdXQtZmlsZS5qcyIsImlucHV0LXRleHQuanMiLCJtb2RhbC5qcyIsIm1vbmV5LW1hc2suanMiLCJwaG9uZS1tYXNrLmpzIiwic2VhcmNoLmpzIiwic2VsZWN0LmpzIiwidGltZS1tYXNrLmpzIiwiYWdlbnRzLmpzIiwiY2FuY2VsbGF0aW9uLW1vZGFsLmpzIiwiY2xpZW50LXR5cGUuanMiLCJjb250cmFjdC1wYWdlLmpzIiwiY29udHJhY3Qtc2VydmljZXMuanMiLCJjb250cmFjdHMtYWxsLmpzIiwiZGVsZXRlLXNlcnZpY2UtbW9kYWwuanMiLCJkZWxpdmVyeS1tb2RhbC5qcyIsImRlbGl2ZXJ5LmpzIiwiZWFybmVkLWRhdGUuanMiLCJmaWx0ZXJzLmpzIiwiaW5zdGFsbGF0aW9uLW1vZGFsLmpzIiwiaW5zdGFsbGF0aW9uLXdhaXRpbmcuanMiLCJpbnN0YWxsYXRpb24uanMiLCJtYWtlLXBheW1lbnQtbW9kYWwuanMiLCJwYXltZW50LWNvbmZpcm0tbW9kYWwuanMiLCJwYXltZW50LWNvbmZpcm0uanMiLCJwYXltZW50LWluZm8tbW9kYWwuanMiLCJzY2hlZHVsZS1tb2RhbC5qcyIsInNjaGVkdWxlLmpzIiwic3VwcG9ydC5qcyIsInZlcmlmaWNhdGlvbi1tb2RhbC5qcyIsInZlcmlmaWNhdGlvbi5qcyJdLCJuYW1lcyI6WyJjaGVja2JveDIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiaXRlbSIsImFkZEV2ZW50TGlzdGVuZXIiLCJlIiwidGFyZ2V0IiwiY2hlY2tlZCIsInBhcmVudE5vZGUiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCIkIiwiZGF0ZXBpY2tlciIsImZpbGVEcm9wQXJlYSIsIm1ha2VGaWxlTG9hZCIsImZpbGVJbnB1dCIsInF1ZXJ5U2VsZWN0b3IiLCJmaWxlQ2xlYXIiLCJwcmV2ZW50RGVmYXVsdHMiLCJwcmV2ZW50RGVmYXVsdCIsInN0b3BQcm9wYWdhdGlvbiIsImhpZ2hsaWdodCIsInVuaGlnaGxpZ2h0IiwiZXZlbnROYW1lIiwiZmlsZXMiLCJkYXRhVHJhbnNmZXIiLCJ2YWx1ZSIsInRlc3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJ0eXBlIiwib25GaWxlQ2hhbmdlIiwicmVhZFVybCIsImlucHV0IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsIm5leHRFbGVtZW50U2libGluZyIsInRleHRDb250ZW50IiwibmFtZSIsInJlYWRBc0RhdGFVUkwiLCJ3aW5kb3ciLCJpbnB1dHMiLCJzcGxpdCIsImpvaW4iLCJjb250YWlucyIsInZoIiwiaW5uZXJIZWlnaHQiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsInNldFByb3BlcnR5IiwiY29uY2F0IiwiJGJvZHkiLCJNb2RhbCIsInRyaWdnZXIiLCJtb2RhbCIsInRoaXMiLCJvdmVybGF5IiwiY2xvc2VCdG4iLCJvbk92ZXJsYXlDbGljayIsImJpbmQiLCJvbkNsb3NlQ2xpY2siLCJvblRyaWdnZXJDbGljayIsIm9uUmVzaXplIiwiYWRkRXZlbnRMaXN0ZW5lcnMiLCJwcm90b3R5cGUiLCJvcGVuIiwiY2xvc2UiLCJmdW5jIiwidGltZXIiLCJldmVudCIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJtYXNrIiwicmV2ZXJzZSIsImltIiwiSW5wdXRtYXNrIiwiaXRlbXMiLCJzZWFyY2giLCJwcmV2aW91c0VsZW1lbnRTaWJsaW5nIiwiZm9ybWF0T3B0aW9uIiwidGV4dCIsImxlbmd0aCIsInNlbGVjdDIiLCJ0ZW1wbGF0ZVJlc3VsdCIsInRlbXBsYXRlU2VsZWN0aW9uIiwib24iLCJhZGRDbGFzcyIsImRlbGl2ZXJ5VGltZUlucHV0cyIsImNsaWNrIiwicGFyZW50IiwibmV4dCIsInNsaWRlVG9nZ2xlIiwidG9nZ2xlQ2xhc3MiLCJjYW5jZWxsYXRpb25CdG4iLCJnZXRFbGVtZW50QnlJZCIsInJhZGlvcyIsIndyYXBwZXIiLCJvblJhZGlvQ2hhbmdlIiwiZmluZCIsImxpbmtzIiwib25MaW5rQ2xpY2siLCJsaW5rIiwiY29udHJhY3RzTGlua0FsbCIsImRlbGl2ZXJ5QnRucyIsImJ0biIsImRhdGVUZXh0Iiwib25GaWVsZENoYW5nZSIsInN1Ym1pdCIsImZpbGVJbnB1dEJsb2NrIiwiZGF0ZUlucHV0IiwidGltZUlucHV0IiwiY29uZmlybUNoZWNrYm94Iiwic2V0QXR0cmlidXRlIiwiaXNGb3JtRmlsbGVkIiwiaGFzQXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwibWVudSIsImV4dGVuZCIsIl9pbmxpbmVEYXRlcGlja2VyMiIsIl9pbmxpbmVEYXRlcGlja2VyIiwiaW5zdCIsImJlZm9yZVNob3ciLCJfZ2V0IiwiYXBwbHkiLCJ0b2dnbGUiLCJyYW5nZSIsImlubGluZSIsInNob3dCdXR0b25QYW5lbCIsInNob3dPdGhlck1vbnRocyIsInNlbGVjdE90aGVyTW9udGhzIiwiY2xvc2VUZXh0IiwiZHBEaXYiLCJjc3MiLCJvblNlbGVjdCIsImV4dGVuc2lvblJhbmdlIiwic3RhcnREYXRlVGV4dCIsImVuZERhdGVUZXh0IiwibW91c2V1cCIsImlzIiwiaGFzIiwiaGlkZSIsImhhc0NsYXNzIiwiY29uc29sZSIsImxvZyIsInBheW1lbnRDb25maXJtQnRucyIsIm1haW5DaGVja2JveCIsInNlbmRlcklucHV0IiwicmVjaXBpZW50SW5wdXQiLCJzdW1JbnB1dCIsInB1cnBvc2VJbnB1dCIsImdldEFsbENoZWNrYm94Iiwib25DaGVja2JveENoYW5nZSIsInJvdyIsInBheW1lbnRzIiwic2NoZWR1bGVCdG5zIiwiaWQiLCJ2ZXJpZmljYXRpb25CdG4iLCJzYXZlQnRuIl0sIm1hcHBpbmdzIjoiQUFBQSxjQ0FBLFdBQ0EsSUFBQUEsRUFBQUMsU0FBQUMsaUJBQUEsc0JBRUFGLEVBQUEsSUFJQUEsRUFBQUcsU0FBQSxTQUFBQyxHQUNBQSxFQUFBQyxpQkFBQSxVQUFBLFNBQUFDLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUMsUUFDQSxJQUFB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OiJzY3JpcHQubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjaGVja2JveDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2hlY2tib3gtMl9faW5wdXQnKTtcblxuICBpZiAoIWNoZWNrYm94MlswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNoZWNrYm94Mi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZSkge1xuICAgICAgdmFyIHRhcmdldCA9IGUudGFyZ2V0O1xuXG4gICAgICBpZiAodGFyZ2V0LmNoZWNrZWQgPT09IHRydWUpIHtcbiAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICQoJy5kYXRlLWlucHV0JykuZGF0ZXBpY2tlcigpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGZpbGVEcm9wQXJlYSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbnB1dC1maWxlX19sYWJlbCcpO1xuXG4gIGZ1bmN0aW9uIG1ha2VGaWxlTG9hZChmaWxlRHJvcEFyZWEpIHtcbiAgICB2YXIgZmlsZUlucHV0ID0gZmlsZURyb3BBcmVhLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgdmFyIGZpbGVDbGVhciA9IGZpbGVEcm9wQXJlYS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7IC8vINCh0LHRgNCw0YHRi9Cy0LDQtdC8INGB0YLQsNC90LTQsNGA0YLQvdGL0LUg0YHQvtCx0YvRgtC40Y8g0L/RgNC4INC/0LXRgNC10YLQsNGB0LrQuNCy0LDQvdC40Lgg0YTQsNC50LvQsFxuXG4gICAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInLCAnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgcHJldmVudERlZmF1bHRzLCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdHMoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9XG5cbiAgICA7IC8vINCU0L7QsdCw0LLQu9GP0LXQvCDRgdGC0LjQu9C4INC/0YDQuCDQv9C10YDQtdGC0LDRgdC60LjQstCw0L3QuNC4INGE0LDQudC70LAg0L3QsNC0INC90YPQttC90L7QuSDQvtCx0LvQsNGB0YLRjNGOXG5cbiAgICBbJ2RyYWdlbnRlcicsICdkcmFnb3ZlciddLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoaWdobGlnaHQsIGZhbHNlKTtcbiAgICB9KTtcbiAgICBbJ2RyYWdsZWF2ZScsICdkcm9wJ10uZm9yRWFjaChmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIHVuaGlnaGxpZ2h0LCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICBmdW5jdGlvbiBoaWdobGlnaHQoZSkge1xuICAgICAgZmlsZURyb3BBcmVhLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpO1xuICAgIH1cblxuICAgIDtcblxuICAgIGZ1bmN0aW9uIHVuaGlnaGxpZ2h0KGUpIHtcbiAgICAgIGZpbGVEcm9wQXJlYS5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcbiAgICB9XG5cbiAgICA7IC8vXG5cbiAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZURyb3AsIGZhbHNlKTtcblxuICAgIGZ1bmN0aW9uIGhhbmRsZURyb3AoZSkge1xuICAgICAgdmFyIGR0ID0gZS5kYXRhVHJhbnNmZXI7XG4gICAgICB2YXIgZmlsZXMgPSBkdC5maWxlcztcblxuICAgICAgaWYgKGZpbGVJbnB1dC5maWxlcyAmJiBmaWxlSW5wdXQuZmlsZXNbMF0pIHtcbiAgICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG5cbiAgICAgICAgaWYgKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZmlsZUlucHV0LmZpbGVzID0gZmlsZXM7XG4gICAgICBvbkZpbGVDaGFuZ2UoKTtcbiAgICB9XG5cbiAgICA7XG5cbiAgICB2YXIgb25GaWxlQ2hhbmdlID0gZnVuY3Rpb24gb25GaWxlQ2hhbmdlKCkge1xuICAgICAgcmVhZFVybChmaWxlSW5wdXQpO1xuICAgIH07XG5cbiAgICB2YXIgcmVhZFVybCA9IGZ1bmN0aW9uIHJlYWRVcmwoaW5wdXQpIHtcbiAgICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlc1swXSkge1xuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBmaWxlRHJvcEFyZWEucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdsb2FkZWQnKTtcbiAgICAgICAgICBmaWxlRHJvcEFyZWEubmV4dEVsZW1lbnRTaWJsaW5nLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX25hbWUnKS50ZXh0Q29udGVudCA9IGlucHV0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBvbkNsZWFyKCkge1xuICAgICAgZmlsZURyb3BBcmVhLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgICAgaWYgKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWxlQ2hhbmdlKTtcbiAgICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsZWFyKTtcbiAgfVxuXG4gIHdpbmRvdy5tYWtlRmlsZUxvYWQgPSBtYWtlRmlsZUxvYWQ7XG5cbiAgaWYgKCFmaWxlRHJvcEFyZWFbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBmaWxlRHJvcEFyZWEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIG1ha2VGaWxlTG9hZChpdGVtKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXRleHQnKTtcblxuICBpZiAoIWlucHV0c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaW5wdXQudmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSA9PT0gJycpIHtcbiAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgIH1cblxuICAgICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJyAmJiAhaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJykpIHtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnICYmIGlucHV0LmNsYXNzTGlzdC5jb250YWlucygnanMtaW5wdXRlZCcpKSB7XG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBcIlwiLmNvbmNhdCh2aCwgXCJweFwiKSk7XG4gIHZhciAkYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcblxuICBmdW5jdGlvbiBkZWJvdW5jZShmdW5jKSB7XG4gICAgdmFyIHRpbWVyO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmICh0aW1lcikgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jLCAxMDAsIGV2ZW50KTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gTW9kYWwodHJpZ2dlciwgbW9kYWwpIHtcbiAgICB0aGlzLnRyaWdnZXIgPSB0cmlnZ2VyO1xuICAgIHRoaXMubW9kYWwgPSBtb2RhbDtcbiAgICB0aGlzLm92ZXJsYXkgPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAgIHRoaXMuY2xvc2VCdG4gPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgICB0aGlzLm9uT3ZlcmxheUNsaWNrID0gdGhpcy5vbk92ZXJsYXlDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DbG9zZUNsaWNrID0gdGhpcy5vbkNsb3NlQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uVHJpZ2dlckNsaWNrID0gdGhpcy5vblRyaWdnZXJDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25SZXNpemUgPSB0aGlzLm9uUmVzaXplLmJpbmQodGhpcyk7XG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCdqcy1zaG93Jyk7XG4gICAgJGJvZHkuY2xhc3NMaXN0LmFkZCgnanNfX2JvZHktbm8tc2Nyb2xsJyk7XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnanMtc2hvdycpO1xuICAgICRib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX19ib2R5LW5vLXNjcm9sbCcpO1xuICB9O1xuXG4gIE1vZGFsLnByb3RvdHlwZS5vbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLm92ZXJsYXkpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLm9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLm9uVHJpZ2dlckNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMub3BlbigpO1xuICB9O1xuXG4gIE1vZGFsLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aCcsIFwiXCIuY29uY2F0KHZoLCBcInB4XCIpKTtcbiAgfTtcblxuICBNb2RhbC5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbk92ZXJsYXlDbGljayk7XG4gICAgdGhpcy5jbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbG9zZUNsaWNrKTtcbiAgICB0aGlzLnRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uVHJpZ2dlckNsaWNrKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZGVib3VuY2UodGhpcy5vblJlc2l6ZSkpO1xuICB9O1xuXG4gIHdpbmRvdy5Nb2RhbCA9IE1vZGFsO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJCgnLmlucHV0LW1vbmV5JykubWFzaygnIyAjIzAg4oK9Jywge1xuICAgIHJldmVyc2U6IHRydWVcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXBob25lJyk7XG5cbiAgaWYgKCFpbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKFwiKzcoOTk5KSA5OTktOTktOTlcIik7XG4gIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaW0ubWFzayhpdGVtKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaXRlbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VhcmNoJyk7XG4gIHZhciBjbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWFyY2ggKyAuc2VhcmNoLWNsb3NlJyk7XG5cbiAgaWYgKCFpdGVtc1swXSkge1xuICAgIHJldHVybjtcbiAgfSAvLyBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+e1xuICAvLyAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnanMtZm9jdXMnKTtcbiAgLy8gICB9KTtcbiAgLy8gfSk7XG5cblxuICBpdGVtcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGl0ZW0udmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSA9PT0gJycpIHtcbiAgICAgICAgaXRlbS52YWx1ZSA9ICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAoaXRlbS52YWx1ZSAhPT0gJycgJiYgIWl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJykpIHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtLnZhbHVlID09PSAnJyAmJiBpdGVtLmNsYXNzTGlzdC5jb250YWlucygnanMtaW5wdXRlZCcpKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbiAgY2xvc2UuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgICB2YXIgc2VhcmNoID0gaXRlbS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgc2VhcmNoLnZhbHVlID0gJyc7XG5cbiAgICAgIGlmIChzZWFyY2guY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJykpIHtcbiAgICAgICAgc2VhcmNoLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICBmdW5jdGlvbiBmb3JtYXRPcHRpb24oaXRlbSkge1xuICAgIHZhciB2YWx1ZSA9IGl0ZW0udGV4dC5zcGxpdCgnc3BsaXR0ZXInKTtcblxuICAgIGlmICh2YWx1ZS5sZW5ndGggPiAxKSB7XG4gICAgICB2YXIgcmVzdWx0ID0gJCgnPHNwYW4+JyArIHZhbHVlWzBdICsgJzwvc3Bhbj48c3Bhbj4nICsgdmFsdWVbMV0gKyAnPC9zcGFuPicpO1xuICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGl0ZW0udGV4dDtcbiAgICB9XG4gIH1cblxuICAkKCcuc2VsZWN0Jykuc2VsZWN0Mih7XG4gICAgdGVtcGxhdGVSZXN1bHQ6IGZvcm1hdE9wdGlvbixcbiAgICB0ZW1wbGF0ZVNlbGVjdGlvbjogZm9ybWF0T3B0aW9uXG4gIH0pO1xuICAkKCcuc2VsZWN0Jykub24oJ3NlbGVjdDI6c2VsZWN0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAkKHRoaXMpLmFkZENsYXNzKCdwaWNrZWQnKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgZGVsaXZlcnlUaW1lSW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuXG4gIGlmICghZGVsaXZlcnlUaW1lSW5wdXRzWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGltID0gbmV3IElucHV0bWFzayhcIjk5Ojk5XCIpO1xuICBkZWxpdmVyeVRpbWVJbnB1dHMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIGltLm1hc2soaXRlbSk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJCgnLmFnZW50c19fdXNlcnMtYnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykucGFyZW50KCkubmV4dCgpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNhbmNlbGxhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX19jYW5jZWxsYXRpb24nKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWxsYXRpb25fX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNhbmNlbGxhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWNyZWF0aW9uX19jbGllbnQtdHlwZSAgaW5wdXQnKTtcblxuICBpZiAoIXJhZGlvc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyYWN0LWNyZWF0aW9uX19kZXRhaWxzJyk7XG5cbiAgZnVuY3Rpb24gb25SYWRpb0NoYW5nZSgpIHtcbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZW50aXR5Jyk7XG4gICAgfVxuXG4gICAgaWYgKHJhZGlvc1sxXS5jaGVja2VkKSB7XG4gICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3Nob3ctZm9yLWVudGl0eScpO1xuICAgIH1cbiAgfVxuXG4gIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvblJhZGlvQ2hhbmdlKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAkKCcuZGVsaXZlcnktb3ItcGlja3VwLmRvbmUnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzKS5maW5kKCcuY29udHJhY3QtaW5mb19fZGVsaXZlcmVkLWFkcmVzcycpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS5maW5kKCcuY29udHJhY3QtaW5mb19fZGVsaXZlcmVkLXRvZ2dsZScpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RTZXJ2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cmFjdC1zZXJ2aWNlcycpO1xuXG4gIGlmICghY29udHJhY3RTZXJ2aWNlcykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1zZXJ2aWNlc19fbGluaycpO1xuXG4gIHZhciBvbkxpbmtDbGljayA9IGZ1bmN0aW9uIG9uTGlua0NsaWNrKGUpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tib3gtYnRuX19sYWJlbCcpIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxpdmVyLW9yLXBpY2t1cF9fY29uZmlybS1idG4nKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb250cmFjdC1zZXJ2aWNlc19fZGVsaXZlcnktY29uZmlybScpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIGxpbmtzLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjb250cmFjdHNMaW5rQWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0c19fbGluaycpO1xuXG4gIGlmICghY29udHJhY3RzTGlua0FsbFswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBvbkxpbmtDbGljayA9IGZ1bmN0aW9uIG9uTGlua0NsaWNrKGUpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tib3gtYnRuX19sYWJlbCcpIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwYXltZW50LXdhaXRpbmdfX2NvbmZpcm0tYnRuJykgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3Qtc2VydmljZXNfX2RlbGl2ZXJ5LWNvbmZpcm0nKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICBjb250cmFjdHNMaW5rQWxsLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjYW5jZWxsYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3Vic2NyaXB0aW9uLXBhZ2VfX2FjdGlvbi1pdGVtLS1kZWxldGUnKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxldGUtc2VydmljZV9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2FuY2VsbGF0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJyk7XG5cbiAgaWYgKCFkZWxpdmVyeUJ0bnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH0gLy8gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGRhdGVUZXh0KSB7XG4gIC8vICAgb25GaWVsZENoYW5nZSgpO1xuICAvLyB9KTtcblxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyeS1vci1waWNrdXBfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgLy8gY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICAvLyBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cblxuICBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbiAoYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTsgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgLy8gICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAvLyAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgLy8gICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgLy8gICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gfVxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25GaWVsZENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoaXNGb3JtRmlsbGVkKCkgJiYgc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgLy8gICB9IGVsc2UgaWYgKCFpc0Zvcm1GaWxsZWQoKSAmJiAhc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IGlzRm9ybUZpbGxlZCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ2dldERhdGUnKVxuICAvLyAgICAgJiYgdGltZUlucHV0LnZhbHVlICE9PSAnJ1xuICAvLyAgICAgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWVcbiAgLy8gICAgICYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gfVxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyBjb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJyk7XG4gIC8vIGlmICghZGVsaXZlcnlCdG5zWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyeS1vci1waWNrdXBfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcigpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZGF0ZVRleHQpIHtcbiAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gIH0pO1xuICB2YXIgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIHZhciBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIHZhciBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICB2YXIgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIHZhciBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgdmFyIGZpbGVDbGVhciA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG4gIHZhciBkYXRlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1kYXRlJyk7XG4gIHZhciB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIHZhciBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7IC8vIGRlbGl2ZXJ5QnRucy5mb3JFYWNoKGZ1bmN0aW9uKGJ0bikge1xuICAvLyAgIG5ldyBNb2RhbChidG4sIG1vZGFsKTtcbiAgLy8gfSk7XG5cbiAgdmFyIG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uIG9uQ2xvc2VDbGljaygpIHtcbiAgICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgICBpZiAoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgfVxuICAgIH1cblxuICAgIGRhdGVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHRpbWVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICB9O1xuXG4gIHZhciBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIG9uT3ZlcmxheUNsaWNrKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbiBvbkZpZWxkQ2hhbmdlKGUpIHtcbiAgICBpZiAoaXNGb3JtRmlsbGVkKCkgJiYgc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9IGVsc2UgaWYgKCFpc0Zvcm1GaWxsZWQoKSAmJiAhc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkZpbGVDbGVhciA9IGZ1bmN0aW9uIG9uRmlsZUNsZWFyKCkge1xuICAgIGlmICghc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbiBpc0Zvcm1GaWxsZWQoKSB7XG4gICAgcmV0dXJuICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignZ2V0RGF0ZScpICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJycgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWUgJiYgZmlsZUlucHV0LnZhbHVlICE9PSAnJztcbiAgfTtcblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICBjb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG4gIGZpbGVDbGVhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uRmlsZUNsZWFyKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBtZW51ID0gJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudScpO1xuICB2YXIgYnRuID0gJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJyk7XG4gICQuZXh0ZW5kKCQuZGF0ZXBpY2tlciwge1xuICAgIC8vIFJlZmVyZW5jZSB0aGUgb3JpZ25hbCBmdW5jdGlvbiBzbyB3ZSBjYW4gb3ZlcnJpZGUgaXQgYW5kIGNhbGwgaXQgbGF0ZXJcbiAgICBfaW5saW5lRGF0ZXBpY2tlcjI6ICQuZGF0ZXBpY2tlci5faW5saW5lRGF0ZXBpY2tlcixcbiAgICAvLyBPdmVycmlkZSB0aGUgX2lubGluZURhdGVwaWNrZXIgbWV0aG9kXG4gICAgX2lubGluZURhdGVwaWNrZXI6IGZ1bmN0aW9uIF9pbmxpbmVEYXRlcGlja2VyKHRhcmdldCwgaW5zdCkge1xuICAgICAgLy8gQ2FsbCB0aGUgb3JpZ2luYWxcbiAgICAgIHRoaXMuX2lubGluZURhdGVwaWNrZXIyKHRhcmdldCwgaW5zdCk7XG5cbiAgICAgIHZhciBiZWZvcmVTaG93ID0gJC5kYXRlcGlja2VyLl9nZXQoaW5zdCwgJ2JlZm9yZVNob3cnKTtcblxuICAgICAgaWYgKGJlZm9yZVNob3cpIHtcbiAgICAgICAgYmVmb3JlU2hvdy5hcHBseSh0YXJnZXQsIFt0YXJnZXQsIGluc3RdKTtcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudScpLnRvZ2dsZSgpO1xuICB9KTtcbiAgJCgnLmRhdGUtaW5wdXQtcGVyaW9kJykuZGF0ZXBpY2tlcih7XG4gICAgcmFuZ2U6ICdwZXJpb2QnLFxuICAgIGlubGluZTogdHJ1ZSxcbiAgICBzaG93QnV0dG9uUGFuZWw6IHRydWUsXG4gICAgc2hvd090aGVyTW9udGhzOiB0cnVlLFxuICAgIHNlbGVjdE90aGVyTW9udGhzOiB0cnVlLFxuICAgIGNsb3NlVGV4dDogXCLQk9C+0YLQvtCy0L5cIixcbiAgICBiZWZvcmVTaG93OiBmdW5jdGlvbiBiZWZvcmVTaG93KGlucHV0LCBpbnN0KSB7XG4gICAgICBpbnN0LmRwRGl2LmNzcygndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVgoLTI0cHgpJyk7XG4gICAgICBpbnN0LmRwRGl2LmFkZENsYXNzKCdjYWxlbmRhci1yYW5nZScpO1xuICAgIH0sXG4gICAgb25TZWxlY3Q6IGZ1bmN0aW9uIG9uU2VsZWN0KGRhdGVUZXh0LCBpbnN0LCBleHRlbnNpb25SYW5nZSkge1xuICAgICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykudGV4dChleHRlbnNpb25SYW5nZS5zdGFydERhdGVUZXh0ICsgJyAtICcgKyBleHRlbnNpb25SYW5nZS5lbmREYXRlVGV4dCk7XG4gICAgfVxuICB9KTtcbiAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSkge1xuICAgIHZhciBtZW51ID0gJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudScpO1xuICAgIHZhciBidG4gPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKTtcblxuICAgIGlmICghbWVudS5pcyhlLnRhcmdldCkgJiYgbWVudS5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCAmJiAhYnRuLmlzKGUudGFyZ2V0KSAmJiBidG4uaGFzKGUudGFyZ2V0KS5sZW5ndGggPT09IDApIHtcbiAgICAgIG1lbnUuaGlkZSgpO1xuICAgIH1cbiAgfSk7XG4gICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLW1lbnUtYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkge1xuICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhbGwtdGltZScpKSB7XG4gICAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KCQodGhpcykudGV4dCgpICsgJyAo0YEgJyArICQoJy5lYXJuZWQtZGF0ZV9fc3RhcnQtcGVyaW9kJykudGV4dCgpICsgJyknKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykudGV4dCgkKHRoaXMpLnRleHQoKSk7XG4gICAgfVxuXG4gICAgbWVudS5oaWRlKCk7XG4gIH0pO1xuICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KCQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLW1lbnUtYnRuLmFsbC10aW1lJykudGV4dCgpICsgJyAo0YEgJyArICQoJy5lYXJuZWQtZGF0ZV9fc3RhcnQtcGVyaW9kJykudGV4dCgpICsgJyknKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICQoJy5maWx0ZXJzX19idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzKS5wYXJlbnQoKS5uZXh0KCkuc2xpZGVUb2dnbGUoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcblxuICBpZiAoIWRlbGl2ZXJ5QnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfSAvLyAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZGF0ZVRleHQpIHtcbiAgLy8gICBvbkZpZWxkQ2hhbmdlKCk7XG4gIC8vIH0pO1xuXG5cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RhbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgLy8gY29uc3QgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICAvLyBjb25zdCB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIC8vIGNvbnN0IGNvbmZpcm1DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcblxuXG4gIGRlbGl2ZXJ5QnRucy5mb3JFYWNoKGZ1bmN0aW9uIChidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pOyAvL2NvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAvLyAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAvLyAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gIC8vICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgdGltZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIC8vICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgLy8gICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gIC8vICAgICAvLyYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gfVxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy9maWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG4gIC8vY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZWxpdmVyeS1vci1waWNrdXBfX2luc3RhbGxhdGlvbi1jaG9vc2UtYmxvY2sgIGlucHV0Jyk7XG5cbiAgaWYgKCFyYWRpb3NbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgd3JhcHBlciA9IHJhZGlvc1swXS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuXG4gIGZ1bmN0aW9uIG9uUmFkaW9DaGFuZ2UoKSB7XG4gICAgY29uc29sZS5sb2cod3JhcHBlcik7XG5cbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzJdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItZGVsaXZlcnknKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLWRlbGl2ZXJ5Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByYWRpb3MuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25SYWRpb0NoYW5nZSk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgLy8gY29uc3QgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcbiAgLy8gaWYgKCFkZWxpdmVyeUJ0bnNbMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RhbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChkYXRlVGV4dCkge1xuICAgIG9uRmllbGRDaGFuZ2UoKTtcbiAgfSk7XG4gIHZhciBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgdmFyIG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgdmFyIHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7IC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcblxuICB2YXIgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICB2YXIgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICB2YXIgY29uZmlybUNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmNoZWNrYm94X19pbnB1dCcpOyAvLyBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgLy8gICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIC8vIH0pO1xuXG4gIHZhciBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbiBvbkNsb3NlQ2xpY2soKSB7XG4gICAgLy8gaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAvLyAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAgIC8vICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgLy8gICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICAvLyAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gICAgLy8gICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgLy8gICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgIC8vICAgfVxuICAgIC8vIH1cbiAgICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAgICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgfTtcblxuICB2YXIgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbiBvbk92ZXJsYXlDbGljayhlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAgICAgb25DbG9zZUNsaWNrKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24gb25GaWVsZENoYW5nZShlKSB7XG4gICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaXNGb3JtRmlsbGVkID0gZnVuY3Rpb24gaXNGb3JtRmlsbGVkKCkge1xuICAgIHJldHVybiAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ2dldERhdGUnKSAmJiB0aW1lSW5wdXQudmFsdWUgIT09ICcnICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlOyAvLyYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgfTtcblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTsgLy9maWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG5cbiAgY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHBheW1lbnRDb25maXJtQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdXR1YWwtY2FsY3NfX21ha2UtcGF5bWVudCcpO1xuXG4gIGlmICghcGF5bWVudENvbmZpcm1CdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtd2FpdGluZ19fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IG1haW5DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2FjdGlvbnNfX2NoZWNrLWFsbCBpbnB1dCcpO1xuICAvLyBjb25zdCBzZW5kZXJJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXNlbmRlciBpbnB1dCcpO1xuICAvLyBjb25zdCByZWNpcGllbnRJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXJlY2lwaWVudCBpbnB1dCcpO1xuICAvLyBjb25zdCBzdW1JbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXN1bSBpbnB1dCcpO1xuICAvLyBjb25zdCBwdXJwb3NlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1wdXJwb3NlIGlucHV0Jyk7XG4gIC8vIGNvbnN0IGdldEFsbENoZWNrYm94ID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX2NoZWNrIGlucHV0Jyk7XG4gIC8vIH07XG4gIC8vIGNvbnN0IG9uQWxsQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGNvbnN0IHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgLy8gICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAvLyAgICAgICBpZiAoIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0gZWxzZSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH07XG4gIC8vIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIG1haW5DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9KTtcbiAgLy8gICAkKCcjcGF5bWVudC1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gICBzZW5kZXJJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHJlY2lwaWVudElucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgc3VtSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBwdXJwb3NlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gfTtcbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uQ2hlY2tib3hDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuXG4gIHBheW1lbnRDb25maXJtQnRucy5mb3JFYWNoKGZ1bmN0aW9uIChidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pOyAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIG1haW5DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkFsbENoYW5nZSk7XG4gIC8vIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2hhbmdlKTtcbiAgLy8gfSlcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBwYXltZW50Q29uZmlybUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGF5bWVudC13YWl0aW5nX19jb25maXJtLWJ0bicpO1xuXG4gIGlmICghcGF5bWVudENvbmZpcm1CdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoKTtcblxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50LXdhaXRpbmdfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBtYWluQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNhY3Rpb25zX19jaGVjay1hbGwgaW5wdXQnKTtcbiAgLy8gY29uc3Qgc2VuZGVySW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zZW5kZXIgaW5wdXQnKTtcbiAgLy8gY29uc3QgcmVjaXBpZW50SW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1yZWNpcGllbnQgaW5wdXQnKTtcbiAgLy8gY29uc3Qgc3VtSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zdW0gaW5wdXQnKTtcbiAgLy8gY29uc3QgcHVycG9zZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcHVycG9zZSBpbnB1dCcpO1xuICAvLyBjb25zdCBnZXRBbGxDaGVja2JveCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcudHJhbnNhY3Rpb25zX19jaGVjayBpbnB1dCcpO1xuICAvLyB9O1xuICAvLyBjb25zdCBvbkFsbENoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgICBjb25zdCByb3cgPSBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gIC8vICAgICBpZiAobWFpbkNoZWNrYm94LmNoZWNrZWQpIHtcbiAgLy8gICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgLy8gICAgICAgaWYgKCFyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgLy8gICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9IGVsc2Uge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAgICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9KVxuICAvLyB9O1xuICAvLyBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBtYWluQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAgIGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgfSk7XG4gIC8vICAgJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vICAgc2VuZGVySW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICByZWNpcGllbnRJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHN1bUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgcHVycG9zZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vIH07XG4gIC8vIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgLy8gICAgIG9uQ2xvc2VDbGljaygpO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyBjb25zdCBvbkNoZWNrYm94Q2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgLy8gICB9IGVsc2Uge1xuICAvLyAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgfVxuICAvLyB9XG5cblxuICBwYXltZW50Q29uZmlybUJ0bnMuZm9yRWFjaChmdW5jdGlvbiAoYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTsgLy8gY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICAvLyBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAvLyBtYWluQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25BbGxDaGFuZ2UpO1xuICAvLyBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25DaGVja2JveENoYW5nZSk7XG4gIC8vIH0pXG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCBwYXltZW50Q29uZmlybUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGF5bWVudC13YWl0aW5nX19jb25maXJtLWJ0bicpO1xuICAvLyBpZiAoIXBheW1lbnRDb25maXJtQnRuc1swXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC13YWl0aW5nX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIHZhciBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIHZhciBtYWluQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNhY3Rpb25zX19jaGVjay1hbGwgaW5wdXQnKTtcbiAgdmFyIHNlbmRlcklucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc2VuZGVyIGlucHV0Jyk7XG4gIHZhciByZWNpcGllbnRJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXJlY2lwaWVudCBpbnB1dCcpO1xuICB2YXIgc3VtSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zdW0gaW5wdXQnKTtcbiAgdmFyIHB1cnBvc2VJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXB1cnBvc2UgaW5wdXQnKTtcblxuICB2YXIgZ2V0QWxsQ2hlY2tib3ggPSBmdW5jdGlvbiBnZXRBbGxDaGVja2JveCgpIHtcbiAgICByZXR1cm4gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnRyYW5zYWN0aW9uc19fY2hlY2sgaW5wdXQnKTtcbiAgfTtcblxuICB2YXIgb25BbGxDaGFuZ2UgPSBmdW5jdGlvbiBvbkFsbENoYW5nZSgpIHtcbiAgICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIHZhciByb3cgPSBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG5cbiAgICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuXG4gICAgICAgIGlmICghcm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG5cbiAgICAgICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAgICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfTtcblxuICB2YXIgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24gb25DbG9zZUNsaWNrKCkge1xuICAgIG1haW5DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgIGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfSk7XG4gICAgJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gICAgc2VuZGVySW5wdXQudmFsdWUgPSAnJztcbiAgICByZWNpcGllbnRJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHN1bUlucHV0LnZhbHVlID0gJyc7XG4gICAgcHVycG9zZUlucHV0LnZhbHVlID0gJyc7XG4gIH07XG5cbiAgdmFyIG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24gb25PdmVybGF5Q2xpY2soZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25DaGVja2JveENoYW5nZSA9IGZ1bmN0aW9uIG9uQ2hlY2tib3hDaGFuZ2UoZSkge1xuICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfVxuICB9OyAvLyBwYXltZW50Q29uZmlybUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgLy8gICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIC8vIH0pO1xuXG5cbiAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICBtYWluQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25BbGxDaGFuZ2UpO1xuICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDaGFuZ2UpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBwYXltZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdXR1YWwtY2FsY3MtcGF5bWVudC1ibG9ja19fbGluaycpO1xuXG4gIGlmICghcGF5bWVudHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC1pbmZvX19tb2RhbCcpO1xuICBwYXltZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgc2NoZWR1bGVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWRldmljZV9fc2NoZWR1bGUnKTtcblxuICBpZiAoIXNjaGVkdWxlQnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2hlZHVsZV9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGNvbnN0IHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY2hlZHVsZV9fbW9kYWwtdG9nZ2xlIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY2hlZHVsZV9fbW9kYWwtdG9nZ2xlJyk7XG4gIC8vIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGlkKSB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgLy8gICAgIGlmIChpZCA9PT0gMCkge1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnc2Vjb25kLXRhYicpO1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnZmlyc3QtdGFiJyk7XG4gIC8vICAgICB9XG4gIC8vICAgICBpZiAoaWQgPT09IDEpIHtcbiAgLy8gICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpcnN0LXRhYicpO1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnc2Vjb25kLXRhYicpO1xuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH0pXG5cblxuICBzY2hlZHVsZUJ0bnMuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgLy8gY29uc3Qgc2NoZWR1bGVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWRldmljZV9fc2NoZWR1bGUnKTtcbiAgLy8gaWYgKCFzY2hlZHVsZUJ0bnNbMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNjaGVkdWxlX19tb2RhbC10b2dnbGUgaW5wdXQnKTtcbiAgdmFyIHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY2hlZHVsZV9fbW9kYWwtdG9nZ2xlJyk7XG4gIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtLCBpZCkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24gKCkge1xuICAgICAgaWYgKGlkID09PSAwKSB7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWNvbmQtdGFiJyk7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdmaXJzdC10YWInKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlkID09PSAxKSB7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdmaXJzdC10YWInKTtcbiAgICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ3NlY29uZC10YWInKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7IC8vIHNjaGVkdWxlQnRucy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICAvLyB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICQoJy5zdXBwb3J0X19kb2NzLWJ0bicpLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAkKHRoaXMpLnBhcmVudCgpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ29wZW5lZCcpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciB2ZXJpZmljYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtaW5mb19fdmVyaWZpY2F0aW9uJyk7XG5cbiAgaWYgKCF2ZXJpZmljYXRpb25CdG5bMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmVyaWZpY2F0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gY29uc3QgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudmVyaWZpY2F0aW9uX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzYXZlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zYXZlJyk7XG4gIC8vIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIGlmIChmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2xvYWRlZCcpKSB7XG4gIC8vICAgICBmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdsb2FkZWQnKTtcbiAgLy8gICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gIC8vICAgICB9XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgLy8gICAgIG9uQ2xvc2VDbGljaygpO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyBjb25zdCBvbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgLy8gICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG5cbiAgdmVyaWZpY2F0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICB9KTsgLy8gY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICAvLyBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAvLyBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25JbnB1dENoYW5nZSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCB2ZXJpZmljYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtaW5mb19fdmVyaWZpY2F0aW9uJyk7XG4gIC8vIGlmICghdmVyaWZpY2F0aW9uQnRuWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZmljYXRpb25fX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52ZXJpZmljYXRpb25fX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgdmFyIGZpbGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICB2YXIgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIHZhciBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIHZhciBzYXZlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19zYXZlJyk7XG4gIHZhciBmaWxlQ2xlYXIgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZmlsZS1sb2FkX19jbGVhcicpO1xuXG4gIHZhciBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbiBvbkNsb3NlQ2xpY2soKSB7XG4gICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICBzYXZlQnRuLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG5cbiAgICAgIGlmICghL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpIHtcbiAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIG9uT3ZlcmxheUNsaWNrKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbiBvbklucHV0Q2hhbmdlKCkge1xuICAgIGlmIChmaWxlSW5wdXQudmFsdWUgIT09ICcnKSB7XG4gICAgICBzYXZlQnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uRmlsZUNsZWFyID0gZnVuY3Rpb24gb25GaWxlQ2xlYXIoKSB7XG4gICAgaWYgKCFzYXZlQnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTsgLy8gdmVyaWZpY2F0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIC8vIH0pXG5cblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbklucHV0Q2hhbmdlKTtcbiAgZmlsZUNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25GaWxlQ2xlYXIpO1xufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNoZWNrYm94MiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGVja2JveC0yX19pbnB1dCcpO1xuXG4gIGlmICghY2hlY2tib3gyWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2hlY2tib3gyLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oZSkge1xuICAgICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG4gICAgICBpZiAodGFyZ2V0LmNoZWNrZWQgPT09IHRydWUpIHtcbiAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGFyZ2V0LnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJCgnLmRhdGUtaW5wdXQnKS5kYXRlcGlja2VyKCk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBmaWxlRHJvcEFyZWEgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtZmlsZV9fbGFiZWwnKTtcblxuICBmdW5jdGlvbiBtYWtlRmlsZUxvYWQoZmlsZURyb3BBcmVhKSB7XG4gICAgY29uc3QgZmlsZUlucHV0ID0gZmlsZURyb3BBcmVhLnF1ZXJ5U2VsZWN0b3IoJ2lucHV0Jyk7XG4gICAgY29uc3QgZmlsZUNsZWFyID0gZmlsZURyb3BBcmVhLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmZpbGUtbG9hZF9fY2xlYXInKTtcbiAgICAvLyDQodCx0YDQsNGB0YvQstCw0LXQvCDRgdGC0LDQvdC00LDRgNGC0L3Ri9C1INGB0L7QsdGL0YLQuNGPINC/0YDQuCDQv9C10YDQtdGC0LDRgdC60LjQstCw0L3QuNC4INGE0LDQudC70LBcblxuICAgIFsnZHJhZ2VudGVyJywgJ2RyYWdvdmVyJywgJ2RyYWdsZWF2ZScsICdkcm9wJ10uZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBwcmV2ZW50RGVmYXVsdHMsIGZhbHNlKVxuICAgIH0pO1xuXG4gICAgZnVuY3Rpb24gcHJldmVudERlZmF1bHRzIChlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH07XG5cbiAgICAvLyDQlNC+0LHQsNCy0LvRj9C10Lwg0YHRgtC40LvQuCDQv9GA0Lgg0L/QtdGA0LXRgtCw0YHQutC40LLQsNC90LjQuCDRhNCw0LnQu9CwINC90LDQtCDQvdGD0LbQvdC+0Lkg0L7QsdC70LDRgdGC0YzRjlxuXG4gICAgWydkcmFnZW50ZXInLCAnZHJhZ292ZXInXS5mb3JFYWNoKGV2ZW50TmFtZSA9PiB7XG4gICAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhpZ2hsaWdodCwgZmFsc2UpXG4gICAgfSk7XG5cbiAgICBbJ2RyYWdsZWF2ZScsICdkcm9wJ10uZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCB1bmhpZ2hsaWdodCwgZmFsc2UpXG4gICAgfSlcblxuICAgIGZ1bmN0aW9uIGhpZ2hsaWdodChlKSB7XG4gICAgICBmaWxlRHJvcEFyZWEuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIHVuaGlnaGxpZ2h0KGUpIHtcbiAgICAgIGZpbGVEcm9wQXJlYS5jbGFzc0xpc3QucmVtb3ZlKCdoaWdobGlnaHQnKTtcbiAgICB9O1xuXG4gICAgLy9cblxuICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlRHJvcCwgZmFsc2UpXG5cbiAgICBmdW5jdGlvbiBoYW5kbGVEcm9wKGUpIHtcbiAgICAgIGxldCBkdCA9IGUuZGF0YVRyYW5zZmVyXG4gICAgICBsZXQgZmlsZXMgPSBkdC5maWxlc1xuXG4gICAgICBpZiAoZmlsZUlucHV0LmZpbGVzICYmIGZpbGVJbnB1dC5maWxlc1swXSkge1xuICAgICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgZmlsZUlucHV0LmZpbGVzID0gZmlsZXM7XG4gICAgICBvbkZpbGVDaGFuZ2UoKTtcbiAgICB9O1xuXG4gICAgY29uc3Qgb25GaWxlQ2hhbmdlID0gKCkgPT4ge1xuICAgICAgcmVhZFVybChmaWxlSW5wdXQpO1xuICAgIH1cblxuICAgIGNvbnN0IHJlYWRVcmwgPSAoaW5wdXQpID0+IHtcbiAgICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlc1swXSkge1xuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBmaWxlRHJvcEFyZWEucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdsb2FkZWQnKTtcbiAgICAgICAgICBmaWxlRHJvcEFyZWFcbiAgICAgICAgICAgIC5uZXh0RWxlbWVudFNpYmxpbmdcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZmlsZS1sb2FkX19uYW1lJylcbiAgICAgICAgICAgIC50ZXh0Q29udGVudCA9IGlucHV0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgIH1cblxuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChpbnB1dC5maWxlc1swXSk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gb25DbGVhcigpIHtcbiAgICAgIGZpbGVEcm9wQXJlYS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuXG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmlsZUNoYW5nZSk7XG4gICAgZmlsZUNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbGVhcik7XG4gIH1cblxuICB3aW5kb3cubWFrZUZpbGVMb2FkID0gbWFrZUZpbGVMb2FkO1xuXG5cbiAgaWYgKCFmaWxlRHJvcEFyZWFbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBmaWxlRHJvcEFyZWEuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbWFrZUZpbGVMb2FkKGl0ZW0pO1xuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGlucHV0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5pbnB1dC10ZXh0Jyk7XG5cbiAgaWYgKCFpbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpbnB1dCkge1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXQudmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSA9PT0gJydcbiAgICAgICkge1xuICAgICAgICBpbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGlucHV0LnZhbHVlICE9PSAnJ1xuICAgICAgICAmJiAhaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJylcbiAgICAgICkge1xuICAgICAgICBpbnB1dC5jbGFzc0xpc3QuYWRkKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXQudmFsdWUgPT09ICcnXG4gICAgICAgICYmIGlucHV0LmNsYXNzTGlzdC5jb250YWlucygnanMtaW5wdXRlZCcpXG4gICAgICApIHtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LnJlbW92ZSgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pKCk7XG4iLCIoKCkgPT4ge1xuICBsZXQgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBgJHt2aH1weGApO1xuXG4gIGNvbnN0ICRib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xuXG4gIGZ1bmN0aW9uIGRlYm91bmNlKGZ1bmMpe1xuICAgIHZhciB0aW1lcjtcbiAgICByZXR1cm4gZnVuY3Rpb24oZXZlbnQpe1xuICAgICAgaWYodGltZXIpIGNsZWFyVGltZW91dCh0aW1lcik7XG4gICAgICB0aW1lciA9IHNldFRpbWVvdXQoZnVuYywxMDAsZXZlbnQpO1xuICAgIH07XG4gIH1cblxuICBmdW5jdGlvbiBNb2RhbCAodHJpZ2dlciwgbW9kYWwpIHtcbiAgICB0aGlzLnRyaWdnZXIgPSB0cmlnZ2VyO1xuICAgIHRoaXMubW9kYWwgPSBtb2RhbDtcbiAgICB0aGlzLm92ZXJsYXkgPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAgIHRoaXMuY2xvc2VCdG4gPSB0aGlzLm1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcblxuICAgIHRoaXMub25PdmVybGF5Q2xpY2sgPSB0aGlzLm9uT3ZlcmxheUNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vbkNsb3NlQ2xpY2sgPSB0aGlzLm9uQ2xvc2VDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25UcmlnZ2VyQ2xpY2sgPSB0aGlzLm9uVHJpZ2dlckNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vblJlc2l6ZSA9IHRoaXMub25SZXNpemUuYmluZCh0aGlzKTtcblxuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCdqcy1zaG93Jyk7XG4gICAgJGJvZHkuY2xhc3NMaXN0LmFkZCgnanNfX2JvZHktbm8tc2Nyb2xsJyk7XG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLXNob3cnKTtcbiAgICAkYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdqc19fYm9keS1uby1zY3JvbGwnKTtcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMub3ZlcmxheSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUub25UcmlnZ2VyQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm9wZW4oKTtcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAgICAgbGV0IHZoID0gd2luZG93LmlubmVySGVpZ2h0ICogMC4wMTtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aCcsIGAke3ZofXB4YCk7XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbk92ZXJsYXlDbGljayk7XG4gICAgdGhpcy5jbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbG9zZUNsaWNrKTtcbiAgICB0aGlzLnRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uVHJpZ2dlckNsaWNrKTtcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncmVzaXplJywgZGVib3VuY2UodGhpcy5vblJlc2l6ZSkpO1xuICB9XG5cbiAgd2luZG93Lk1vZGFsID0gTW9kYWw7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAgICQoJy5pbnB1dC1tb25leScpLm1hc2soJyMgIyMwIOKCvScsIHtcbiAgICAgIHJldmVyc2U6IHRydWUsXG4gICAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtcGhvbmUnKTtcblxuICBpZiAoIWlucHV0c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGltID0gbmV3IElucHV0bWFzayhcIis3KDk5OSkgOTk5LTk5LTk5XCIpO1xuXG4gIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBpbS5tYXNrKGl0ZW0pO1xuICB9KVxufSkoKTtcbiIsIigoKSA9PiB7XG4gIGNvbnN0IGl0ZW1zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlYXJjaCcpO1xuICBjb25zdCBjbG9zZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWFyY2ggKyAuc2VhcmNoLWNsb3NlJyk7XG5cbiAgaWYgKCFpdGVtc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT57XG4gIC8vICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdqcy1mb2N1cycpO1xuICAvLyAgIH0pO1xuICAvLyB9KTtcblxuICBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdibHVyJywgKCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBpdGVtLnZhbHVlLnNwbGl0KCcgJykuam9pbignJykgPT09ICcnXG4gICAgICApIHtcbiAgICAgICAgaXRlbS52YWx1ZSA9ICcnO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGl0ZW0udmFsdWUgIT09ICcnXG4gICAgICAgICYmICFpdGVtLmNsYXNzTGlzdC5jb250YWlucygnanMtaW5wdXRlZCcpXG4gICAgICApIHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QuYWRkKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgaXRlbS52YWx1ZSA9PT0gJydcbiAgICAgICAgJiYgaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKVxuICAgICAgKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LnJlbW92ZSgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuICAgIH0pXG4gIH0pO1xuXG4gIGNsb3NlLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgY29uc3Qgc2VhcmNoID0gaXRlbS5wcmV2aW91c0VsZW1lbnRTaWJsaW5nO1xuICAgICAgc2VhcmNoLnZhbHVlID0gJyc7XG4gICAgICBpZiAoXG4gICAgICAgIHNlYXJjaC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKVxuICAgICAgKSB7XG4gICAgICAgIHNlYXJjaC5jbGFzc0xpc3QucmVtb3ZlKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG4gICAgfSlcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gIGZ1bmN0aW9uIGZvcm1hdE9wdGlvbiAoaXRlbSkge1xuICAgIGNvbnN0IHZhbHVlID0gaXRlbS50ZXh0LnNwbGl0KCdzcGxpdHRlcicpO1xuXG4gICAgaWYgKHZhbHVlLmxlbmd0aCA+IDEpIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9ICQoJzxzcGFuPidcbiAgICAgICAgKyB2YWx1ZVswXVxuICAgICAgICArICc8L3NwYW4+PHNwYW4+J1xuICAgICAgICArIHZhbHVlWzFdXG4gICAgICAgICsgJzwvc3Bhbj4nKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBpdGVtLnRleHQ7XG4gICAgfVxuICB9XG5cbiAgJCgnLnNlbGVjdCcpLnNlbGVjdDIoe1xuICAgIHRlbXBsYXRlUmVzdWx0OiBmb3JtYXRPcHRpb24sXG4gICAgdGVtcGxhdGVTZWxlY3Rpb246IGZvcm1hdE9wdGlvblxuICB9KTtcblxuICAkKCcuc2VsZWN0Jykub24oJ3NlbGVjdDI6c2VsZWN0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAkKHRoaXMpLmFkZENsYXNzKCdwaWNrZWQnKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBkZWxpdmVyeVRpbWVJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG5cbiAgaWYgKCFkZWxpdmVyeVRpbWVJbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKFwiOTk6OTlcIik7XG5cbiAgZGVsaXZlcnlUaW1lSW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGltLm1hc2soaXRlbSk7XG4gIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAkKCcuYWdlbnRzX191c2Vycy1idG4nKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAkKHRoaXMpLnBhcmVudCgpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ29wZW5lZCcpO1xuICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY2FuY2VsbGF0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWluZm9fX2NhbmNlbGxhdGlvbicpO1xuXG4gIGlmICghY2FuY2VsbGF0aW9uQnRuWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY2FuY2VsbGF0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjYW5jZWxsYXRpb25CdG4uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG5cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWNyZWF0aW9uX19jbGllbnQtdHlwZSAgaW5wdXQnKTtcblxuICBpZiAoIXJhZGlvc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJhY3QtY3JlYXRpb25fX2RldGFpbHMnKTtcblxuICBmdW5jdGlvbiBvblJhZGlvQ2hhbmdlKCkge1xuICAgIGlmIChyYWRpb3NbMF0uY2hlY2tlZCkge1xuICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1lbnRpdHknKTtcbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItZW50aXR5Jyk7XG4gICAgfVxuICB9XG5cbiAgcmFkaW9zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25SYWRpb0NoYW5nZSk7XG4gIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICQoJy5kZWxpdmVyeS1vci1waWNrdXAuZG9uZScpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQodGhpcykuZmluZCgnLmNvbnRyYWN0LWluZm9fX2RlbGl2ZXJlZC1hZHJlc3MnKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykuZmluZCgnLmNvbnRyYWN0LWluZm9fX2RlbGl2ZXJlZC10b2dnbGUnKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY29udHJhY3RTZXJ2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cmFjdC1zZXJ2aWNlcycpO1xuXG4gIGlmICghY29udHJhY3RTZXJ2aWNlcykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LXNlcnZpY2VzX19saW5rJyk7XG5cbiAgY29uc3Qgb25MaW5rQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAoXG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2JveC1idG5fX2xhYmVsJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbnRyYWN0LXNlcnZpY2VzX19kZWxpdmVyeS1jb25maXJtJylcbiAgICApIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cblxuICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNvbnRyYWN0c0xpbmtBbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3RzX19saW5rJyk7XG5cbiAgaWYgKCFjb250cmFjdHNMaW5rQWxsWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgb25MaW5rQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAoXG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2JveC1idG5fX2xhYmVsJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3QtaW5mb19fdmVyaWZpY2F0aW9uJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3Qtc2VydmljZXNfX2RlbGl2ZXJ5LWNvbmZpcm0nKVxuICAgICkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnRyYWN0c0xpbmtBbGwuZm9yRWFjaChmdW5jdGlvbihsaW5rKSB7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTGlua0NsaWNrKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBjYW5jZWxsYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3Vic2NyaXB0aW9uLXBhZ2VfX2FjdGlvbi1pdGVtLS1kZWxldGUnKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbGV0ZS1zZXJ2aWNlX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjYW5jZWxsYXRpb25CdG4uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSlcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmRlbGl2ZXItb3ItcGlja3VwX19jb25maXJtLWJ0bicpO1xuXG4gIGlmICghZGVsaXZlcnlCdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGRhdGVUZXh0KSB7XG4gIC8vICAgb25GaWVsZENoYW5nZSgpO1xuICAvLyB9KTtcblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyeS1vci1waWNrdXBfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgLy8gY29uc3QgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICAvLyBjb25zdCB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIC8vIGNvbnN0IGNvbmZpcm1DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcblxuICBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pO1xuXG4gIC8vIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIGlmIChmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2xvYWRlZCcpKSB7XG4gIC8vICAgICBmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdsb2FkZWQnKTtcblxuICAvLyAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAvLyAgICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gIC8vICAgICB9XG4gIC8vICAgfVxuXG4gIC8vICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgdGltZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChpc0Zvcm1GaWxsZWQoKSAmJiBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gIC8vICAgICBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH0gZWxzZSBpZiAoIWlzRm9ybUZpbGxlZCgpICYmICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gIC8vICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgLy8gICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gIC8vICAgICAmJiBmaWxlSW5wdXQudmFsdWUgIT09ICcnXG4gIC8vIH1cblxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyBjb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAvLyBjb25zdCBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJyk7XG5cbiAgLy8gaWYgKCFkZWxpdmVyeUJ0bnNbMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyeS1vci1waWNrdXBfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcigpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihkYXRlVGV4dCkge1xuICAgIG9uRmllbGRDaGFuZ2UoKTtcbiAgfSk7XG5cbiAgY29uc3QgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIGNvbnN0IG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgY29uc3Qgc3VibWl0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQnKTtcbiAgY29uc3QgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIGNvbnN0IGZpbGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICBjb25zdCBmaWxlQ2xlYXIgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZmlsZS1sb2FkX19jbGVhcicpO1xuICBjb25zdCBkYXRlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1kYXRlJyk7XG4gIGNvbnN0IHRpbWVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLXRpbWUnKTtcbiAgY29uc3QgY29uZmlybUNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmNoZWNrYm94X19pbnB1dCcpO1xuXG4gIC8vIGRlbGl2ZXJ5QnRucy5mb3JFYWNoKGZ1bmN0aW9uKGJ0bikge1xuICAvLyAgIG5ldyBNb2RhbChidG4sIG1vZGFsKTtcbiAgLy8gfSk7XG5cbiAgY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuXG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAgICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgfVxuXG4gIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uRmlsZUNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gICAgICAmJiBmaWxlSW5wdXQudmFsdWUgIT09ICcnXG4gIH1cblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICBjb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG4gIGZpbGVDbGVhci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uRmlsZUNsZWFyKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IG1lbnUgPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51Jyk7XG4gIGNvbnN0IGJ0biA9ICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpO1xuXG4gICAgJC5leHRlbmQoJC5kYXRlcGlja2VyLCB7XG5cbiAgICAgICAgLy8gUmVmZXJlbmNlIHRoZSBvcmlnbmFsIGZ1bmN0aW9uIHNvIHdlIGNhbiBvdmVycmlkZSBpdCBhbmQgY2FsbCBpdCBsYXRlclxuICAgICAgICBfaW5saW5lRGF0ZXBpY2tlcjI6ICQuZGF0ZXBpY2tlci5faW5saW5lRGF0ZXBpY2tlcixcblxuICAgICAgICAvLyBPdmVycmlkZSB0aGUgX2lubGluZURhdGVwaWNrZXIgbWV0aG9kXG4gICAgICAgIF9pbmxpbmVEYXRlcGlja2VyOiBmdW5jdGlvbiAodGFyZ2V0LCBpbnN0KSB7XG5cbiAgICAgICAgICAgIC8vIENhbGwgdGhlIG9yaWdpbmFsXG4gICAgICAgICAgICB0aGlzLl9pbmxpbmVEYXRlcGlja2VyMih0YXJnZXQsIGluc3QpO1xuXG4gICAgICAgICAgICB2YXIgYmVmb3JlU2hvdyA9ICQuZGF0ZXBpY2tlci5fZ2V0KGluc3QsICdiZWZvcmVTaG93Jyk7XG5cbiAgICAgICAgICAgIGlmIChiZWZvcmVTaG93KSB7XG4gICAgICAgICAgICAgICAgYmVmb3JlU2hvdy5hcHBseSh0YXJnZXQsIFt0YXJnZXQsIGluc3RdKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pO1xuXG5cbiAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudScpLnRvZ2dsZSgpO1xuICB9KTtcblxuICAkKCcuZGF0ZS1pbnB1dC1wZXJpb2QnKS5kYXRlcGlja2VyKHtcbiAgICByYW5nZTogJ3BlcmlvZCcsXG4gICAgaW5saW5lOiB0cnVlLFxuICAgIHNob3dCdXR0b25QYW5lbDogdHJ1ZSxcbiAgICBzaG93T3RoZXJNb250aHM6IHRydWUsXG4gICAgc2VsZWN0T3RoZXJNb250aHM6IHRydWUsXG4gICAgY2xvc2VUZXh0IDogXCLQk9C+0YLQvtCy0L5cIixcblxuICAgIGJlZm9yZVNob3c6IGZ1bmN0aW9uKGlucHV0LCBpbnN0KSB7XG4gICAgICBpbnN0LmRwRGl2LmNzcygndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZVgoLTI0cHgpJyk7XG4gICAgICBpbnN0LmRwRGl2LmFkZENsYXNzKCdjYWxlbmRhci1yYW5nZScpO1xuICAgIH0sXG5cbiAgICBvblNlbGVjdDogZnVuY3Rpb24oZGF0ZVRleHQsIGluc3QsIGV4dGVuc2lvblJhbmdlKSB7XG4gICAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KGV4dGVuc2lvblJhbmdlLnN0YXJ0RGF0ZVRleHQgKyAnIC0gJyArIGV4dGVuc2lvblJhbmdlLmVuZERhdGVUZXh0KTtcblxuICAgIH1cbiAgfSk7XG5cbiAgJChkb2N1bWVudCkubW91c2V1cChmdW5jdGlvbiAoZSl7XG5cdFx0Y29uc3QgbWVudSA9ICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLW1lbnUnKTtcblx0XHRjb25zdCBidG4gPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKTtcbiAgICBpZiAoIW1lbnUuaXMoZS50YXJnZXQpXG4gICAgICAmJiBtZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwXG4gICAgICAmJiAhYnRuLmlzKGUudGFyZ2V0KVxuICAgICAgJiYgYnRuLmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwXG4gICAgKSB7XG5cdFx0XHRtZW51LmhpZGUoKTtcblx0XHR9XG4gIH0pO1xuXG4gICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLW1lbnUtYnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24oKSB7XG4gICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2FsbC10aW1lJykpIHtcbiAgICAgICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLnRleHQoXG4gICAgICAgICQodGhpcykudGV4dCgpXG4gICAgICAgICsgJyAo0YEgJ1xuICAgICAgICArICQoJy5lYXJuZWQtZGF0ZV9fc3RhcnQtcGVyaW9kJykudGV4dCgpXG4gICAgICAgICsgJyknXG4gICAgICApXG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLnRleHQoXG4gICAgICAgICQodGhpcykudGV4dCgpXG4gICAgICApXG4gICAgfVxuXG4gICAgbWVudS5oaWRlKCk7XG5cbiAgfSk7XG5cbiAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykudGV4dChcbiAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51LWJ0bi5hbGwtdGltZScpLnRleHQoKVxuICAgICsgJyAo0YEgJ1xuICAgICsgJCgnLmVhcm5lZC1kYXRlX19zdGFydC1wZXJpb2QnKS50ZXh0KClcbiAgICArICcpJ1xuICApXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAkKCcuZmlsdGVyc19fYnRuJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgJCh0aGlzKS5wYXJlbnQoKS5uZXh0KCkuc2xpZGVUb2dnbGUoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5zdGFsbGF0aW9uX19jb25maXJtLWJ0bicpO1xuXG4gIGlmICghZGVsaXZlcnlCdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGRhdGVUZXh0KSB7XG4gIC8vICAgb25GaWVsZENoYW5nZSgpO1xuICAvLyB9KTtcblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdpbnN0YWxsYXRpb25fX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgLy8gY29uc3QgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICAvLyBjb25zdCB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIC8vIGNvbnN0IGNvbmZpcm1DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcblxuICBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pO1xuXG4gIC8vY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAvLyAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuXG4gICAgLy8gICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgICAvLyAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgLy8gICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgIC8vICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgIC8vICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgLy8gICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gfVxuXG4gIC8vIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgLy8gICAgIG9uQ2xvc2VDbGljaygpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIC8vIGNvbnN0IG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIC8vICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIC8vIGNvbnN0IGlzRm9ybUZpbGxlZCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ2dldERhdGUnKVxuICAvLyAgICAgJiYgdGltZUlucHV0LnZhbHVlICE9PSAnJ1xuICAvLyAgICAgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWVcbiAgLy8gICAgIC8vJiYgZmlsZUlucHV0LnZhbHVlICE9PSAnJ1xuICAvLyB9XG5cbiAgLy8gY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICAvLyBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAvLyBkYXRlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gdGltZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIC8vZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICAvL2NvbmZpcm1DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZWxpdmVyeS1vci1waWNrdXBfX2luc3RhbGxhdGlvbi1jaG9vc2UtYmxvY2sgIGlucHV0Jyk7XG5cbiAgaWYgKCFyYWRpb3NbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB3cmFwcGVyID0gcmFkaW9zWzBdLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG5cbiAgZnVuY3Rpb24gb25SYWRpb0NoYW5nZSgpIHtcbiAgICBjb25zb2xlLmxvZyh3cmFwcGVyKTtcbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIGlmICggd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLW1hbnVhbCcpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItbWFudWFsJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICggd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICggIXdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgIGlmICggd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLW1hbnVhbCcpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItbWFudWFsJyk7XG4gICAgICB9XG5cbiAgICAgIGlmICggd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLWRlbGl2ZXJ5JykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1kZWxpdmVyeScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoICF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzJdLmNoZWNrZWQpIHtcbiAgICAgIGlmICggd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLWRlbGl2ZXJ5JykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1kZWxpdmVyeScpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoICF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByYWRpb3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvblJhZGlvQ2hhbmdlKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAvLyBjb25zdCBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5zdGFsbGF0aW9uX19jb25maXJtLWJ0bicpO1xuXG4gIC8vIGlmICghZGVsaXZlcnlCdG5zWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdGFsbGF0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZGF0ZVRleHQpIHtcbiAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gIH0pO1xuXG4gIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIGNvbnN0IHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgY29uc3QgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICBjb25zdCB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIGNvbnN0IGNvbmZpcm1DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcblxuICAvLyBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgLy8gICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIC8vIH0pO1xuXG4gIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIGlmIChmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2xvYWRlZCcpKSB7XG4gICAgLy8gICBmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdsb2FkZWQnKTtcblxuICAgIC8vICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgLy8gICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAgIC8vICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgLy8gICB9XG4gICAgLy8gfVxuXG4gICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gICAgdGltZUlucHV0LnZhbHVlID0gJyc7XG4gICAgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIH1cblxuICBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChpc0Zvcm1GaWxsZWQoKSAmJiBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSBpZiAoIWlzRm9ybUZpbGxlZCgpICYmICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gICAgICAvLyYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgfVxuXG4gIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgZGF0ZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIHRpbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvL2ZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgcGF5bWVudENvbmZpcm1CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm11dHVhbC1jYWxjc19fbWFrZS1wYXltZW50Jyk7XG5cbiAgaWYgKCFwYXltZW50Q29uZmlybUJ0bnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50LXdhaXRpbmdfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IG1haW5DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2FjdGlvbnNfX2NoZWNrLWFsbCBpbnB1dCcpO1xuICAvLyBjb25zdCBzZW5kZXJJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXNlbmRlciBpbnB1dCcpO1xuICAvLyBjb25zdCByZWNpcGllbnRJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXJlY2lwaWVudCBpbnB1dCcpO1xuICAvLyBjb25zdCBzdW1JbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXN1bSBpbnB1dCcpO1xuICAvLyBjb25zdCBwdXJwb3NlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1wdXJwb3NlIGlucHV0Jyk7XG5cbiAgLy8gY29uc3QgZ2V0QWxsQ2hlY2tib3ggPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnRyYW5zYWN0aW9uc19fY2hlY2sgaW5wdXQnKTtcbiAgLy8gfTtcblxuICAvLyBjb25zdCBvbkFsbENoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgICBjb25zdCByb3cgPSBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gIC8vICAgICBpZiAobWFpbkNoZWNrYm94LmNoZWNrZWQpIHtcbiAgLy8gICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgLy8gICAgICAgaWYgKCFyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgLy8gICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9IGVsc2Uge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAgICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9KVxuICAvLyB9O1xuXG4gIC8vIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIG1haW5DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9KTtcbiAgLy8gICAkKCcjcGF5bWVudC1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gICBzZW5kZXJJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHJlY2lwaWVudElucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgc3VtSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBwdXJwb3NlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gfTtcblxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbkNoZWNrYm94Q2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgLy8gICB9IGVsc2Uge1xuICAvLyAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgcGF5bWVudENvbmZpcm1CdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTtcblxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIG1haW5DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkFsbENoYW5nZSk7XG4gIC8vIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2hhbmdlKTtcbiAgLy8gfSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHBheW1lbnRDb25maXJtQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wYXltZW50LXdhaXRpbmdfX2NvbmZpcm0tYnRuJyk7XG5cbiAgaWYgKCFwYXltZW50Q29uZmlybUJ0bnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCk7XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC13YWl0aW5nX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgLy8gY29uc3QgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIC8vIGNvbnN0IG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgLy8gY29uc3QgbWFpbkNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRyYW5zYWN0aW9uc19fY2hlY2stYWxsIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHNlbmRlcklucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc2VuZGVyIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHJlY2lwaWVudElucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcmVjaXBpZW50IGlucHV0Jyk7XG4gIC8vIGNvbnN0IHN1bUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc3VtIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHB1cnBvc2VJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXB1cnBvc2UgaW5wdXQnKTtcblxuICAvLyBjb25zdCBnZXRBbGxDaGVja2JveCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcudHJhbnNhY3Rpb25zX19jaGVjayBpbnB1dCcpO1xuICAvLyB9O1xuXG4gIC8vIGNvbnN0IG9uQWxsQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGNvbnN0IHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgLy8gICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAvLyAgICAgICBpZiAoIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0gZWxzZSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH07XG5cbiAgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgbWFpbkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgIH0pO1xuICAvLyAgICQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICAvLyAgIHNlbmRlcklucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgcmVjaXBpZW50SW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBzdW1JbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHB1cnBvc2VJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyB9O1xuXG4gIC8vIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgLy8gICAgIG9uQ2xvc2VDbGljaygpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIC8vIGNvbnN0IG9uQ2hlY2tib3hDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICBwYXltZW50Q29uZmlybUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pO1xuXG4gIC8vIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgLy8gb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgLy8gbWFpbkNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxsQ2hhbmdlKTtcbiAgLy8gZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDaGFuZ2UpO1xuICAvLyB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgLy8gY29uc3QgcGF5bWVudENvbmZpcm1CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKTtcblxuICAvLyBpZiAoIXBheW1lbnRDb25maXJtQnRuc1swXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtd2FpdGluZ19fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIGNvbnN0IG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgY29uc3QgbWFpbkNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRyYW5zYWN0aW9uc19fY2hlY2stYWxsIGlucHV0Jyk7XG4gIGNvbnN0IHNlbmRlcklucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc2VuZGVyIGlucHV0Jyk7XG4gIGNvbnN0IHJlY2lwaWVudElucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcmVjaXBpZW50IGlucHV0Jyk7XG4gIGNvbnN0IHN1bUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc3VtIGlucHV0Jyk7XG4gIGNvbnN0IHB1cnBvc2VJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXB1cnBvc2UgaW5wdXQnKTtcblxuICBjb25zdCBnZXRBbGxDaGVja2JveCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcudHJhbnNhY3Rpb25zX19jaGVjayBpbnB1dCcpO1xuICB9O1xuXG4gIGNvbnN0IG9uQWxsQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGNvbnN0IHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAgICAgICBpZiAoIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH07XG5cbiAgY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgbWFpbkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAgIH0pO1xuICAgICQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICAgIHNlbmRlcklucHV0LnZhbHVlID0gJyc7XG4gICAgcmVjaXBpZW50SW5wdXQudmFsdWUgPSAnJztcbiAgICBzdW1JbnB1dC52YWx1ZSA9ICcnO1xuICAgIHB1cnBvc2VJbnB1dC52YWx1ZSA9ICcnO1xuICB9O1xuXG4gIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uQ2hlY2tib3hDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgICB9XG4gIH1cblxuICAvLyBwYXltZW50Q29uZmlybUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgLy8gICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIC8vIH0pO1xuXG4gIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgbWFpbkNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxsQ2hhbmdlKTtcbiAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDaGFuZ2UpO1xuICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgcGF5bWVudHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubXV0dWFsLWNhbGNzLXBheW1lbnQtYmxvY2tfX2xpbmsnKTtcblxuICBpZiAoIXBheW1lbnRzWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC1pbmZvX19tb2RhbCcpO1xuXG4gIHBheW1lbnRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pXG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHNjaGVkdWxlQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1kZXZpY2VfX3NjaGVkdWxlJyk7XG5cbiAgaWYgKCFzY2hlZHVsZUJ0bnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzY2hlZHVsZV9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gY29uc3QgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNjaGVkdWxlX19tb2RhbC10b2dnbGUgaW5wdXQnKTtcbiAgLy8gY29uc3QgdG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjaGVkdWxlX19tb2RhbC10b2dnbGUnKTtcblxuICAvLyByYWRpb3MuZm9yRWFjaChmdW5jdGlvbihpdGVtLCBpZCkge1xuICAvLyAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgZnVuY3Rpb24oKSB7XG4gIC8vICAgICBpZiAoaWQgPT09IDApIHtcbiAgLy8gICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlY29uZC10YWInKTtcbiAgLy8gICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2ZpcnN0LXRhYicpO1xuICAvLyAgICAgfVxuXG4gIC8vICAgICBpZiAoaWQgPT09IDEpIHtcbiAgLy8gICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpcnN0LXRhYicpO1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnc2Vjb25kLXRhYicpO1xuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH0pXG5cbiAgc2NoZWR1bGVCdG5zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgLy8gY29uc3Qgc2NoZWR1bGVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWRldmljZV9fc2NoZWR1bGUnKTtcblxuICAvLyBpZiAoIXNjaGVkdWxlQnRuc1swXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCByYWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2NoZWR1bGVfX21vZGFsLXRvZ2dsZSBpbnB1dCcpO1xuICBjb25zdCB0b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2NoZWR1bGVfX21vZGFsLXRvZ2dsZScpO1xuXG4gIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGlkKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgICAgIGlmIChpZCA9PT0gMCkge1xuICAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnc2Vjb25kLXRhYicpO1xuICAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnZmlyc3QtdGFiJyk7XG4gICAgICB9XG5cbiAgICAgIGlmIChpZCA9PT0gMSkge1xuICAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnZmlyc3QtdGFiJyk7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdzZWNvbmQtdGFiJyk7XG4gICAgICB9XG4gICAgfSlcbiAgfSlcblxuICAvLyBzY2hlZHVsZUJ0bnMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgLy8gfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAkKCcuc3VwcG9ydF9fZG9jcy1idG4nKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAkKHRoaXMpLnBhcmVudCgpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykudG9nZ2xlQ2xhc3MoJ29wZW5lZCcpO1xuICB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgdmVyaWZpY2F0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWluZm9fX3ZlcmlmaWNhdGlvbicpO1xuXG4gIGlmICghdmVyaWZpY2F0aW9uQnRuWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmVyaWZpY2F0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52ZXJpZmljYXRpb25fX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHNhdmVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3NhdmUnKTtcblxuICAvLyBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAvLyAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgLy8gICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gIC8vICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAvLyAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAvLyAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgLy8gICAgIH1cbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgLy8gICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIHZlcmlmaWNhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICB9KVxuXG4gIC8vIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgLy8gb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgLy8gZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uSW5wdXRDaGFuZ2UpO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgLy8gY29uc3QgdmVyaWZpY2F0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWluZm9fX3ZlcmlmaWNhdGlvbicpO1xuXG4gIC8vIGlmICghdmVyaWZpY2F0aW9uQnRuWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmVyaWZpY2F0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52ZXJpZmljYXRpb25fX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIGNvbnN0IHNhdmVCdG4gPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3NhdmUnKTtcbiAgY29uc3QgZmlsZUNsZWFyID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmZpbGUtbG9hZF9fY2xlYXInKTtcblxuICBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGZpbGVJbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uRmlsZUNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFzYXZlQnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIC8vIHZlcmlmaWNhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICAvLyB9KVxuXG4gIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uSW5wdXRDaGFuZ2UpO1xuICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG59KSgpO1xuIl19
