"use strict";!function(){var e=document.querySelectorAll(".checkbox-2__input");e[0]&&e.forEach((function(e){e.addEventListener("change",(function(e){var t=e.target;!0===t.checked?t.parentNode.classList.add("checked"):t.parentNode.classList.remove("checked")}))}))}(),$(".date-input").datepicker(),function(){var e=document.querySelectorAll(".input-file__label");function t(e){var t=e.querySelector("input"),n=e.parentNode.querySelector(".file-load__clear");function i(e){e.preventDefault(),e.stopPropagation()}function a(t){e.classList.add("highlight")}function o(t){e.classList.remove("highlight")}["dragenter","dragover","dragleave","drop"].forEach((function(t){e.addEventListener(t,i,!1)})),["dragenter","dragover"].forEach((function(t){e.addEventListener(t,a,!1)})),["dragleave","drop"].forEach((function(t){e.addEventListener(t,o,!1)})),e.addEventListener("drop",(function(e){var n=e.dataTransfer.files;t.files&&t.files[0]&&(t.value="",/safari/i.test(navigator.userAgent)||(t.type="",t.type="file"));t.files=n,c(),window.onVerificationFileDrop&&window.onVerificationFileDrop(),window.onDeliveryFileDrop&&window.onDeliveryFileDrop(),window.onInstallationFileDrop&&window.onInstallationFileDrop()}),!1);var c=function(){r(t)},r=function(t){if(t.files&&t.files[0]){var n=new FileReader;n.onload=function(n){e.parentNode.classList.add("loaded"),e.nextElementSibling.querySelector(".file-load__name").textContent=t.files[0].name},n.readAsDataURL(t.files[0])}};t.addEventListener("change",c),n.addEventListener("click",(function(){e.parentNode.classList.remove("loaded"),t.value="",/safari/i.test(navigator.userAgent)||(t.type="",t.type="file")}))}window.makeFileLoad=t,e[0]&&e.forEach((function(e){t(e)}))}(),function(){var e=document.querySelectorAll(".input-text");e[0]&&e.forEach((function(e){e.addEventListener("blur",(function(){""===e.value.split(" ").join("")&&(e.value=""),""===e.value||e.classList.contains("js-inputed")||e.classList.add("js-inputed"),""===e.value&&e.classList.contains("js-inputed")&&e.classList.remove("js-inputed")}))}))}(),function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"));var t,n,i=document.querySelector("body");function a(e,t){this.trigger=e,this.modal=t,this.overlay=this.modal.querySelector(".modal__overlay"),this.closeBtn=this.modal.querySelector(".modal__close"),this.onOverlayClick=this.onOverlayClick.bind(this),this.onCloseClick=this.onCloseClick.bind(this),this.onTriggerClick=this.onTriggerClick.bind(this),this.addEventListeners()}window.addEventListener("resize",(t=function(){var e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh","".concat(e,"px"))},function(e){n&&clearTimeout(n),n=setTimeout(t,100,e)})),a.prototype.open=function(){this.modal.classList.add("js-show"),i.classList.add("js__body-no-scroll")},a.prototype.close=function(){this.modal.classList.remove("js-show"),i.classList.remove("js__body-no-scroll")},a.prototype.onOverlayClick=function(e){e.target===this.overlay&&this.close()},a.prototype.onCloseClick=function(){this.close()},a.prototype.onTriggerClick=function(){this.open()},a.prototype.addEventListeners=function(){this.overlay.addEventListener("click",this.onOverlayClick),this.closeBtn.addEventListener("click",this.onCloseClick),this.trigger.addEventListener("click",this.onTriggerClick)},window.Modal=a}(),$(".input-money").mask("# ##0 ₽",{reverse:!0}),function(){var e=document.querySelectorAll(".input-phone");if(e[0]){var t=new Inputmask("+7(999) 999-99-99");e.forEach((function(e){t.mask(e)}))}}(),function(){var e=document.querySelectorAll(".search"),t=document.querySelectorAll(".search + .search-close");e[0]&&(e.forEach((function(e){e.addEventListener("blur",(function(){""===e.value.split(" ").join("")&&(e.value=""),""===e.value||e.classList.contains("js-inputed")||e.classList.add("js-inputed"),""===e.value&&e.classList.contains("js-inputed")&&e.classList.remove("js-inputed")}))})),t.forEach((function(e){e.addEventListener("click",(function(){var t=e.previousElementSibling;t.value="",t.classList.contains("js-inputed")&&t.classList.remove("js-inputed")}))})))}(),function(){function e(e){var t=e.text.split("splitter"),n=window.matchMedia("(max-width: 999px)").matches?"<br>":"";return t.length>1?$("<span>"+t[0]+"</span>"+n+"<span>"+t[1]+"</span>"):e.text}$(".select").select2({templateResult:e,templateSelection:e}),$(".select").on("select2:select",(function(e){$(this).addClass("picked")}))}(),function(){var e=document.querySelectorAll(".delivery-or-pickup__modal-time");if(e[0]){var t=new Inputmask("99:99");e.forEach((function(e){t.mask(e)}))}}(),function(){if(document.querySelector(".agents__users-block-mobile")){new Swiper(".agents__users-block-mobile__slider",{slidesPerView:1,pagination:{el:".agents__users-block-mobile__pagination",dynamicBullets:!0}});$(".agents__users-btn").parent().next().slideToggle()}}(),$(".agents__users-btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){var e=document.querySelectorAll(".contract-info__cancellation");if(e[0]){var t=document.getElementById("cancellation__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".contract-creation__client-type  input");if(e[0]){var t=document.querySelector(".contract-creation__details");e.forEach((function(e){e.addEventListener("change",n)}))}function n(){e[0].checked&&t.classList.remove("show-for-entity"),e[1].checked&&t.classList.add("show-for-entity")}}(),function(){if(document.querySelector(".clients-mobile-block"))new Swiper(".clients-mobile-block__slider",{slidesPerView:1,pagination:{el:".clients-mobile-block__pagination",dynamicBullets:!0}})}(),$(".delivery-or-pickup.done").click((function(){$(this).find(".contract-info__delivered-adress").slideToggle(),$(this).find(".contract-info__delivered-toggle").toggleClass("opened")})),function(){if(document.querySelector(".contract-services")){var e=document.querySelectorAll(".contract-services__link"),t=function(e){var t=e.target;(t.classList.contains("checkbox-btn__label")||t.classList.contains("checkbox-btn__checkbox")||t.classList.contains("deliver-or-pickup__confirm-btn")||t.classList.contains("contract-services__delivery-confirm"))&&e.preventDefault()};e.forEach((function(e){e.addEventListener("click",t)}))}}(),function(){var e=document.querySelectorAll(".contracts__link");if(e[0]){var t=function(e){var t=e.target;(t.classList.contains("checkbox-btn__label")||t.classList.contains("checkbox-btn__checkbox")||t.classList.contains("contract-info__verification")||t.classList.contains("payment-waiting__confirm-btn")||t.classList.contains("contract-services__delivery-confirm"))&&e.preventDefault()};e.forEach((function(e){e.addEventListener("click",t)}))}}(),function(){if(document.querySelector(".contract-services-mobile"))new Swiper(".contract-services-mobile__slider",{slidesPerView:1,pagination:{el:".contract-services-mobile__pagination",dynamicBullets:!0}})}(),function(){if(document.querySelector(".contracts-mobile"))new Swiper(".contracts-mobile__slider",{slidesPerView:1,pagination:{el:".contracts-mobile__pagination",dynamicBullets:!0}})}(),function(){var e=document.querySelectorAll(".subscription-page__action-item--delete");if(e[0]){var t=document.getElementById("delete-service__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".deliver-or-pickup__confirm-btn");if(e[0]){var t=document.getElementById("delivery-or-pickup__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".contract-creation__delivery-device");e[0]&&e.forEach((function(e){var t=e.querySelectorAll(".contract-creation__delivery-type-wrapper  input");function n(e){var n=e.target.parentNode.parentNode.parentNode;t[0].checked&&n.classList.remove("show-for-pickup"),t[1].checked&&n.classList.add("show-for-pickup")}t.forEach((function(e){e.addEventListener("change",n)}))}))}(),function(){var e=document.getElementById("delivery-or-pickup__modal");if(e){var t=$("#delivery-or-pickup__modal .date-input");t.datepicker().on("change",(function(e){$("#delivery-or-pickup__modal").hasClass("js-show")&&p()}));var n=e.querySelector(".modal__close"),i=e.querySelector(".modal__overlay"),a=e.querySelector(".modal__submit"),o=e.querySelector(".delivery-or-pickup__modal-input-file"),c=e.querySelector(".input-file__input"),r=e.querySelector(".file-load__clear"),l=e.querySelector(".delivery-or-pickup__modal-date"),s=e.querySelector(".delivery-or-pickup__modal-time"),d=e.querySelector(".checkbox__input"),u=function(){o.classList.contains("loaded")&&(o.classList.remove("loaded"),c.value="",a.setAttribute("disabled",""),/safari/i.test(navigator.userAgent)||(c.type="",c.type="file")),l.value="",s.value="",d.checked=!1,t.datepicker("setDate","")},p=function(e){f()&&a.hasAttribute("disabled")?a.removeAttribute("disabled"):f()||a.hasAttribute("disabled")||a.setAttribute("disabled","")},f=function(){return t.datepicker("getDate")&&""!==s.value&&!0===d.checked&&""!==c.value};window.onDeliveryFileDrop=function(){p()},n.addEventListener("click",u),i.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&u()})),l.addEventListener("input",p),s.addEventListener("input",p),c.addEventListener("change",window.onDeliveryFileDrop),d.addEventListener("change",p),r.addEventListener("click",(function(){a.hasAttribute("disabled")||a.setAttribute("disabled","")}))}}(),function(){var e=$(".mutual-calcs__earned-date-menu");$(".mutual-calcs__earned-date-btn");$.extend($.datepicker,{_inlineDatepicker2:$.datepicker._inlineDatepicker,_inlineDatepicker:function(e,t){this._inlineDatepicker2(e,t);var n=$.datepicker._get(t,"beforeShow");n&&n.apply(e,[e,t])}}),$(".mutual-calcs__earned-date-btn").on("click",(function(){$(".mutual-calcs__earned-date-menu").toggle()})),$(".date-input-period").datepicker({range:"period",inline:!0,showButtonPanel:!0,showOtherMonths:!0,selectOtherMonths:!0,closeText:"Готово",beforeShow:function(e,t){t.dpDiv.css("transform","translateX(-24px)"),t.dpDiv.addClass("calendar-range")},onSelect:function(e,t,n){$(".mutual-calcs__earned-date-btn").text(n.startDateText+" - "+n.endDateText)}}),$(document).mouseup((function(e){var t=$(".mutual-calcs__earned-date-menu"),n=$(".mutual-calcs__earned-date-btn");t.is(e.target)||0!==t.has(e.target).length||n.is(e.target)||0!==n.has(e.target).length||t.hide()})),$(".mutual-calcs__earned-date-menu-btn").on("click",(function(){$(this).hasClass("all-time")?$(".mutual-calcs__earned-date-btn").text($(this).text()+" (с "+$(".earned-date__start-period").text()+")"):$(".mutual-calcs__earned-date-btn").text($(this).text()),e.hide()})),$(".mutual-calcs__earned-date-btn").text($(".mutual-calcs__earned-date-menu-btn.all-time").text()+" (с "+$(".earned-date__start-period").text()+")")}(),$(".filters__btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){var e=document.querySelectorAll(".installation__confirm-btn");if(e[0]){var t=document.getElementById("installation__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".delivery-or-pickup__installation-choose-block  input");if(e[0]){var t=e[0].parentNode.parentNode.parentNode.parentNode;e.forEach((function(e){e.addEventListener("change",n)}))}function n(){console.log(t),e[0].checked&&(t.classList.contains("show-for-manual")&&t.classList.remove("show-for-manual"),t.classList.contains("show-for-registration")&&t.classList.remove("show-for-registration"),t.classList.contains("show-for-delivery")||t.classList.add("show-for-delivery")),e[1].checked&&(t.classList.contains("show-for-manual")&&t.classList.remove("show-for-manual"),t.classList.contains("show-for-delivery")&&t.classList.remove("show-for-delivery"),t.classList.contains("show-for-registration")||t.classList.add("show-for-registration")),e[2].checked&&(t.classList.contains("show-for-delivery")&&t.classList.remove("show-for-delivery"),t.classList.contains("show-for-registration")&&t.classList.remove("show-for-registration"),t.classList.contains("show-for-manual")||t.classList.add("show-for-manual"))}}(),function(){var e=document.getElementById("installation__modal");if(e){var t=$("#installation__modal .date-input");t.datepicker().on("change",(function(e){$("#installation__modal").hasClass("js-show")&&p()}));var n=e.querySelector(".modal__close"),i=e.querySelector(".modal__overlay"),a=e.querySelector(".modal__submit"),o=e.querySelector(".delivery-or-pickup__modal-input-file"),c=e.querySelector(".input-file__input"),r=e.querySelector(".file-load__clear"),l=e.querySelector(".delivery-or-pickup__modal-date"),s=e.querySelector(".delivery-or-pickup__modal-time"),d=e.querySelector(".checkbox__input"),u=function(){o.classList.contains("loaded")&&(o.classList.remove("loaded"),c.value="",a.setAttribute("disabled",""),/safari/i.test(navigator.userAgent)||(c.type="",c.type="file")),l.value="",s.value="",d.checked=!1,t.datepicker("setDate","")},p=function(e){f()&&a.hasAttribute("disabled")?a.removeAttribute("disabled"):f()||a.hasAttribute("disabled")||a.setAttribute("disabled","")},f=function(){return t.datepicker("getDate")&&""!==s.value&&!0===d.checked&&""!==c.value};window.onInstallationFileDrop=function(){p()},n.addEventListener("click",u),i.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&u()})),l.addEventListener("input",p),s.addEventListener("input",p),c.addEventListener("change",window.onInstallationFileDrop),d.addEventListener("change",p),r.addEventListener("click",(function(){a.hasAttribute("disabled")||a.setAttribute("disabled","")}))}}(),function(){var e=document.querySelectorAll(".mutual-calcs__make-payment");if(e[0]){var t=document.getElementById("payment-waiting__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelector(".header__nav-btn");if(e){var t=document.querySelector(".header__close-btn"),n=document.querySelector(".header__nav"),i=function(){return window.matchMedia("(max-width: 1439px)").matches};i();e.addEventListener("click",(function(){i()&&(e.classList.toggle("js-opened"),n.classList.toggle("js-show"))})),t.addEventListener("click",(function(){n.classList.remove("js-show"),e.classList.toggle("js-opened")}))}}(),function(){if(document.querySelector(".mutual-calcs-payment-mobile"))new Swiper(".mutual-calcs-payment-mobile__slider",{slidesPerView:1,pagination:{el:".mutual-calcs-payment-mobile__pagination",dynamicBullets:!0}})}(),function(){if(document.querySelector(".mutual-calcs-block-mobile"))new Swiper(".mutual-calcs-block-mobile__slider",{slidesPerView:1,pagination:{el:".mutual-calcs-block-mobile__pagination",dynamicBullets:!0}})}(),function(){var e=document.querySelectorAll(".payment-waiting__confirm-btn");if(e[0]){var t=document.getElementById("payment-waiting__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("payment-waiting__modal");if(e){var t=e.querySelector(".modal__close"),n=e.querySelector(".modal__overlay"),i=e.querySelector(".transactions__check-all input"),a=e.querySelector(".payment-waiting__modal-sender input"),o=e.querySelector(".payment-waiting__modal-recipient input"),c=e.querySelector(".payment-waiting__modal-sum input"),r=e.querySelector(".payment-waiting__modal-purpose input"),l=function(){return e.querySelectorAll(".transactions__check input")},s=function(){return e.querySelectorAll(".transactions__mobile-check input")},d=function(){i.checked=!1,l().forEach((function(e){e.checked=!1,e.parentNode.parentNode.parentNode.parentNode.classList.remove("checked")})),s().forEach((function(e){e.checked=!1,e.parentNode.parentNode.parentNode.classList.remove("checked")})),$("#payment-date").datepicker("setDate",""),a.value="",o.value="",c.value="",r.value=""},u=function(e){e.target.checked?e.target.parentNode.parentNode.parentNode.parentNode.classList.add("checked"):e.target.parentNode.parentNode.parentNode.parentNode.classList.remove("checked")},p=function(e){e.target.checked?e.target.parentNode.parentNode.parentNode.classList.add("checked"):e.target.parentNode.parentNode.parentNode.classList.remove("checked")};t.addEventListener("click",d),n.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&d()})),i.addEventListener("change",(function(){l().forEach((function(e){var t=e.parentNode.parentNode.parentNode.parentNode;i.checked?(e.checked=!0,t.classList.contains("checked")||t.classList.add("checked")):(e.checked=!1,t.classList.contains("checked")&&t.classList.remove("checked"))}))})),l().forEach((function(e){e.addEventListener("change",u)})),s().forEach((function(e){e.addEventListener("change",p)}))}}(),function(){var e=document.querySelectorAll(".mutual-calcs-payment-block__link");if(e[0]){var t=document.getElementById("payment-info__modal");e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.querySelectorAll(".contract-device__schedule");if(e[0]){var t=document.getElementById("schedule__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){if(document.getElementById("schedule__modal")){var e=document.querySelectorAll(".schedule__modal-toggle input"),t=document.querySelector(".schedule__modal-toggle");e.forEach((function(e,n){e.addEventListener("change",(function(){0===n&&(t.classList.remove("second-tab"),t.classList.add("first-tab")),1===n&&(t.classList.remove("first-tab"),t.classList.add("second-tab"))}))}))}}(),function(){if(document.querySelector(".main-page")){var e=document.querySelector(".support"),t=document.querySelector(".support__container"),n=e.querySelectorAll(".support__item");!function(){var e=document.createDocumentFragment(),i=document.createElement("div");i.classList.add("swiper-container"),i.classList.add("support__slider");var a=document.createElement("div");a.classList.add("swiper-wrapper"),n.forEach((function(e,t){var n=document.createElement("div");n.classList.add("swiper-slide");var i=e.cloneNode(!0);n.appendChild(i),a.appendChild(n)}));var o=document.createElement("div");o.classList.add("support__slider-pagination","swiper-pagination"),i.appendChild(a),i.appendChild(o),e.appendChild(i),t.appendChild(e),new Swiper(".support__slider",{slidesPerView:1,pagination:{el:".support__slider-pagination"}})}()}}(),$(".support__docs-btn").click((function(){$(this).parent().next().slideToggle(),$(this).toggleClass("opened")})),function(){if(document.querySelector(".transactions-mobile-block"))new Swiper(".transactions-mobile-block__slider",{slidesPerView:1,pagination:{el:".transactions-mobile-block__pagination",dynamicBullets:!0}})}(),function(){var e=document.querySelectorAll(".contract-info__verification");if(e[0]){var t=document.getElementById("verification__modal");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("verification__modal");if(e){var t=e.querySelectorAll(".verification__modal-input-file"),n=e.querySelector(".modal__close"),i=e.querySelector(".modal__overlay"),a=e.querySelector(".modal__save"),o=function(){t.forEach((function(e){var t=e.querySelector(".input-file__input");e.classList.contains("loaded")&&(e.classList.remove("loaded"),t.value="",a.setAttribute("disabled",""),/safari/i.test(navigator.userAgent)||(t.type="",t.type="file"))}))},c=function(){a.hasAttribute("disabled")||a.setAttribute("disabled","")};window.onVerificationFileDrop=function(){var e;e=!0,t.forEach((function(t){""===t.querySelector(".input-file__input").value&&(e=!1)})),e&&a.hasAttribute("disabled")&&a.removeAttribute("disabled"),e||a.hasAttribute("disabled")||a.setAttribute("disabled","")},t.forEach((function(e){var t=e.querySelector(".input-file__input"),n=e.querySelector(".file-load__clear");t.addEventListener("change",window.onVerificationFileDrop),n.addEventListener("click",c)})),n.addEventListener("click",o),i.addEventListener("click",(function(e){e.target.classList.contains("modal__overlay")&&o()}))}}(),function(){var e=document.querySelectorAll(".contract-info__serial-btn");if(e[0]){var t=document.getElementById("write-serial");t&&e.forEach((function(e){new Modal(e,t)}))}}(),function(){var e=document.getElementById("write-serial");if(e){var t=e.querySelector(".write-serial__input .input-text"),n=e.querySelector(".modal__save");t.addEventListener("input",(function(e){var t=e.target.value;""!==t.split(" ").join("")&&t.length>0&&n.hasAttribute("disabled")&&n.removeAttribute("disabled"),""!==t.split(" ").join("")&&0!==t.length||n.hasAttribute("disabled")||n.setAttribute("disabled","")}))}}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyIsImNoZWNrYm94LTIuanMiLCJkYXRlLWlucHV0LmpzIiwiaW5wdXQtZmlsZS5qcyIsImlucHV0LXRleHQuanMiLCJtb2RhbC5qcyIsIm1vbmV5LW1hc2suanMiLCJwaG9uZS1tYXNrLmpzIiwic2VhcmNoLmpzIiwic2VsZWN0LmpzIiwidGltZS1tYXNrLmpzIiwiYWdlbnQtdXNlcnMtc2xpZGVyLmpzIiwiYWdlbnRzLmpzIiwiY2FuY2VsbGF0aW9uLW1vZGFsLmpzIiwiY2xpZW50LXR5cGUuanMiLCJjbGllbnRzLXNsaWRlci5qcyIsImNvbnRyYWN0LXBhZ2UuanMiLCJjb250cmFjdC1zZXJ2aWNlcy5qcyIsImNvbnRyYWN0cy1hbGwuanMiLCJjb250cmFjdHMtc2VydmljZXMtc2xpZGVyLmpzIiwiY29udHJhY3RzLXNsaWRlci5qcyIsImRlbGV0ZS1zZXJ2aWNlLW1vZGFsLmpzIiwiZGVsaXZlcnktbW9kYWwuanMiLCJkZWxpdmVyeS10eXBlLmpzIiwiZGVsaXZlcnkuanMiLCJlYXJuZWQtZGF0ZS5qcyIsImZpbHRlcnMuanMiLCJpbnN0YWxsYXRpb24tbW9kYWwuanMiLCJpbnN0YWxsYXRpb24td2FpdGluZy5qcyIsImluc3RhbGxhdGlvbi5qcyIsIm1ha2UtcGF5bWVudC1tb2RhbC5qcyIsIm1lbnUuanMiLCJtdXR1YWwtY2FsY3MtcGF5bWVudC1zbGlkZXIuanMiLCJtdXR1YWwtY2FsY3Mtc2xpZGVyLmpzIiwicGF5bWVudC1jb25maXJtLW1vZGFsLmpzIiwicGF5bWVudC1jb25maXJtLmpzIiwicGF5bWVudC1pbmZvLW1vZGFsLmpzIiwic2NoZWR1bGUtbW9kYWwuanMiLCJzY2hlZHVsZS5qcyIsInN1cHBvcnQtc2xpZGVyLmpzIiwic3VwcG9ydC5qcyIsInRyYW5zYWN0aW9ucy1zbGlkZXIuanMiLCJ2ZXJpZmljYXRpb24tbW9kYWwuanMiLCJ2ZXJpZmljYXRpb24uanMiLCJ3cml0ZS1zZXJpYWwtbW9kYWwuanMiLCJ3cml0ZS1zZXJpYWwuanMiXSwibmFtZXMiOlsiY2hlY2tib3gyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yQWxsIiwiZm9yRWFjaCIsIml0ZW0iLCJhZGRFdmVudExpc3RlbmVyIiwiZSIsInRhcmdldCIsImNoZWNrZWQiLCJwYXJlbnROb2RlIiwiY2xhc3NMaXN0IiwiYWRkIiwicmVtb3ZlIiwiJCIsImRhdGVwaWNrZXIiLCJmaWxlRHJvcEFyZWEiLCJtYWtlRmlsZUxvYWQiLCJmaWxlSW5wdXQiLCJxdWVyeVNlbGVjdG9yIiwiZmlsZUNsZWFyIiwicHJldmVudERlZmF1bHRzIiwicHJldmVudERlZmF1bHQiLCJzdG9wUHJvcGFnYXRpb24iLCJoaWdobGlnaHQiLCJ1bmhpZ2hsaWdodCIsImV2ZW50TmFtZSIsImZpbGVzIiwiZGF0YVRyYW5zZmVyIiwidmFsdWUiLCJ0ZXN0IiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwidHlwZSIsIm9uRmlsZUNoYW5nZSIsIndpbmRvdyIsIm9uVmVyaWZpY2F0aW9uRmlsZURyb3AiLCJvbkRlbGl2ZXJ5RmlsZURyb3AiLCJvbkluc3RhbGxhdGlvbkZpbGVEcm9wIiwicmVhZFVybCIsImlucHV0IiwicmVhZGVyIiwiRmlsZVJlYWRlciIsIm9ubG9hZCIsIm5leHRFbGVtZW50U2libGluZyIsInRleHRDb250ZW50IiwibmFtZSIsInJlYWRBc0RhdGFVUkwiLCJpbnB1dHMiLCJzcGxpdCIsImpvaW4iLCJjb250YWlucyIsInZoIiwiaW5uZXJIZWlnaHQiLCJkb2N1bWVudEVsZW1lbnQiLCJzdHlsZSIsInNldFByb3BlcnR5IiwiY29uY2F0IiwiZnVuYyIsInRpbWVyIiwiJGJvZHkiLCJNb2RhbCIsInRyaWdnZXIiLCJtb2RhbCIsInRoaXMiLCJvdmVybGF5IiwiY2xvc2VCdG4iLCJvbk92ZXJsYXlDbGljayIsImJpbmQiLCJvbkNsb3NlQ2xpY2siLCJvblRyaWdnZXJDbGljayIsImFkZEV2ZW50TGlzdGVuZXJzIiwiZXZlbnQiLCJjbGVhclRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicHJvdG90eXBlIiwib3BlbiIsImNsb3NlIiwibWFzayIsInJldmVyc2UiLCJpbSIsIklucHV0bWFzayIsIml0ZW1zIiwic2VhcmNoIiwicHJldmlvdXNFbGVtZW50U2libGluZyIsImZvcm1hdE9wdGlvbiIsInRleHQiLCJiciIsIm1hdGNoTWVkaWEiLCJtYXRjaGVzIiwibGVuZ3RoIiwic2VsZWN0MiIsInRlbXBsYXRlUmVzdWx0IiwidGVtcGxhdGVTZWxlY3Rpb24iLCJvbiIsImFkZENsYXNzIiwiZGVsaXZlcnlUaW1lSW5wdXRzIiwiU3dpcGVyIiwic2xpZGVzUGVyVmlldyIsInBhZ2luYXRpb24iLCJlbCIsImR5bmFtaWNCdWxsZXRzIiwicGFyZW50IiwibmV4dCIsInNsaWRlVG9nZ2xlIiwiY2xpY2siLCJ0b2dnbGVDbGFzcyIsImNhbmNlbGxhdGlvbkJ0biIsImdldEVsZW1lbnRCeUlkIiwicmFkaW9zIiwid3JhcHBlciIsIm9uUmFkaW9DaGFuZ2UiLCJmaW5kIiwibGlua3MiLCJvbkxpbmtDbGljayIsImxpbmsiLCJjb250cmFjdHNMaW5rQWxsIiwiZGVsaXZlcnlCdG5zIiwiYnRuIiwiZGV2aWNlcyIsIiRkYXRlIiwiZGF0ZVRleHQiLCJoYXNDbGFzcyIsIm9uRmllbGRDaGFuZ2UiLCJzdWJtaXQiLCJmaWxlSW5wdXRCbG9jayIsImRhdGVJbnB1dCIsInRpbWVJbnB1dCIsImNvbmZpcm1DaGVja2JveCIsInNldEF0dHJpYnV0ZSIsImlzRm9ybUZpbGxlZCIsImhhc0F0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIm1lbnUiLCJleHRlbmQiLCJfaW5saW5lRGF0ZXBpY2tlcjIiLCJfaW5saW5lRGF0ZXBpY2tlciIsImluc3QiLCJiZWZvcmVTaG93IiwiX2dldCIsImFwcGx5IiwidG9nZ2xlIiwicmFuZ2UiLCJpbmxpbmUiLCJzaG93QnV0dG9uUGFuZWwiLCJzaG93T3RoZXJNb250aHMiLCJzZWxlY3RPdGhlck1vbnRocyIsImNsb3NlVGV4dCIsImRwRGl2IiwiY3NzIiwib25TZWxlY3QiLCJleHRlbnNpb25SYW5nZSIsInN0YXJ0RGF0ZVRleHQiLCJlbmREYXRlVGV4dCIsIm1vdXNldXAiLCJpcyIsImhhcyIsImhpZGUiLCJjb25zb2xlIiwibG9nIiwicGF5bWVudENvbmZpcm1CdG5zIiwibWVudUJ0biIsIm5hdiIsImNoZWNrSWZUYWJsZXQiLCJtYWluQ2hlY2tib3giLCJzZW5kZXJJbnB1dCIsInJlY2lwaWVudElucHV0Iiwic3VtSW5wdXQiLCJwdXJwb3NlSW5wdXQiLCJnZXRBbGxDaGVja2JveCIsImdldEFsbE1vYmlsZUNoZWNrYm94Iiwib25DaGVja2JveENoYW5nZSIsIm9uTW9iaWxlQ2hlY2tib3hDaGFuZ2UiLCJyb3ciLCJwYXltZW50cyIsInNjaGVkdWxlQnRucyIsImlkIiwic3VwcG9ydCIsInN1cHBvcnRDb250YWluZXIiLCJmcmFnbWVudCIsImNyZWF0ZURvY3VtZW50RnJhZ21lbnQiLCJjb250YWluZXIiLCJjcmVhdGVFbGVtZW50IiwiaWR4Iiwic2xpZGUiLCJub2RlIiwiY2xvbmVOb2RlIiwiYXBwZW5kQ2hpbGQiLCJtYWtlU2xpZGVyIiwidmVyaWZpY2F0aW9uQnRuIiwic2F2ZUJ0biIsImlucHV0QmxvY2siLCJvbkZpbGVDbGVhciIsImZpbGxlZCJdLCJtYXBwaW5ncyI6IkFBQUEsY0NBQSxXQUNBLElBQUFBLEVBQUFDLFNBQUFDLGlCQUFBLHNCQUVBRixFQUFBLElBSUFBLEVBQUFHLFNBQUEsU0FBQUMsR0FDQUEsRUFBQUMsaUJBQUEsVUFBQSxTQUFBQyxHQUNBLElBQUFDLEVBQUFELEVBQUFDLFFBQ0EsSUFBQUEsRUFBQUMsUUFDQUQsRUFBQUUsV0FBQUMsVUFBQUMsSUFBQSxXQUVBSixFQUFBRSxXQUFBQyxVQUFBRSxPQUFBLGlCQWJBLEdDQ0FDLEVBQUEsZUFBQUMsYUNEQSxXQUNBLElBQUFDLEVBQUFkLFNBQUFDLGlCQUFBLHNCQUVBLFNBQUFjLEVBQUFELEdBQ0EsSUFBQUUsRUFBQUYsRUFBQUcsY0FBQSxTQUNBQyxFQUFBSixFQUFBTixXQUFBUyxj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M0QsYUFBQSxhQUNBMkQsRUFBQTdELGFBQUEsV0FBQSxLQThCQUosRUFBQXpILFNBQUEsU0FBQTJMLEdBQ0EsSUFBQTdLLEVBQUE2SyxFQUFBNUssY0FBQSxzQkFDQUMsRUFBQTJLLEVBQUE1SyxjQUFBLHFCQUdBRCxFQUFBWixpQkFBQSxTQUFBNkIsT0FBQUMsd0JBQ0FoQixFQUFBZCxpQkFBQSxRQUFBMEwsTUFHQW5ILEVBQUF2RSxpQkFBQSxRQUFBK0QsR0FDQUosRUFBQTNELGlCQUFBLFNBcENBLFNBQUFDLEdBQ0FBLEVBQUFDLE9BQUFHLFVBQUF3QyxTQUFBLG1CQUNBa0IsUUE3REEsR0NBQSxXQUNBLElBQUFzQyxFQUFBekcsU0FBQUMsaUJBQUEsOEJBRUEsR0FBQXdHLEVBQUEsR0FBQSxDQUlBLElBQUE1QyxFQUFBN0QsU0FBQTBHLGVBQUEsZ0JBRUE3QyxHQUlBNEMsRUFBQXZHLFNBQUEsU0FBQUMsR0FDQSxJQUFBd0QsTUFBQXhELEVBQUEwRCxPQWRBLEdDQUEsV0FPQSxJQUFBQSxFQUFBN0QsU0FBQTBHLGVBQUEsZ0JBRUEsR0FBQTdDLEVBQUEsQ0FJQSxJQUFBdkIsRUFBQXVCLEVBQUE1QyxjQUFBLG9DQUNBbUcsRUFBQXZELEVBQUE1QyxjQUFBLGdCQTJCQXFCLEVBQUFsQyxpQkFBQSxTQXpCQSxTQUFBQyxHQUNBLElBQUFzQixFQUFBdEIsRUFBQUMsT0FBQXFCLE1BR0EsS0FBQUEsRUFBQW9CLE1BQUEsS0FBQUMsS0FBQSxLQUNBckIsRUFBQTZELE9BQUEsR0FDQTRCLEVBQUFhLGFBQUEsYUFFQWIsRUFBQWMsZ0JBQUEsWUFJQSxLQUFBdkcsRUFBQW9CLE1BQUEsS0FBQUMsS0FBQSxLQUNBLElBQUFyQixFQUFBNkQsUUFFQTRCLEVBQUFhLGFBQUEsYUFDQWIsRUFBQVcsYUFBQSxXQUFBLFFBaENBIiwiZmlsZSI6InNjcmlwdC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNoZWNrYm94MiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jaGVja2JveC0yX19pbnB1dCcpO1xuXG4gIGlmICghY2hlY2tib3gyWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2hlY2tib3gyLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uIChlKSB7XG4gICAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICAgIGlmICh0YXJnZXQuY2hlY2tlZCA9PT0gdHJ1ZSkge1xuICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0YXJnZXQucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJCgnLmRhdGUtaW5wdXQnKS5kYXRlcGlja2VyKCk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgZmlsZURyb3BBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LWZpbGVfX2xhYmVsJyk7XG5cbiAgZnVuY3Rpb24gbWFrZUZpbGVMb2FkKGZpbGVEcm9wQXJlYSkge1xuICAgIHZhciBmaWxlSW5wdXQgPSBmaWxlRHJvcEFyZWEucXVlcnlTZWxlY3RvcignaW5wdXQnKTtcbiAgICB2YXIgZmlsZUNsZWFyID0gZmlsZURyb3BBcmVhLnBhcmVudE5vZGUucXVlcnlTZWxlY3RvcignLmZpbGUtbG9hZF9fY2xlYXInKTsgLy8g0KHQsdGA0LDRgdGL0LLQsNC10Lwg0YHRgtCw0L3QtNCw0YDRgtC90YvQtSDRgdC+0LHRi9GC0LjRjyDQv9GA0Lgg0L/QtdGA0LXRgtCw0YHQutC40LLQsNC90LjQuCDRhNCw0LnQu9CwXG5cbiAgICBbJ2RyYWdlbnRlcicsICdkcmFnb3ZlcicsICdkcmFnbGVhdmUnLCAnZHJvcCddLmZvckVhY2goZnVuY3Rpb24gKGV2ZW50TmFtZSkge1xuICAgICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBwcmV2ZW50RGVmYXVsdHMsIGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0cyhlKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgIH1cblxuICAgIDsgLy8g0JTQvtCx0LDQstC70Y/QtdC8INGB0YLQuNC70Lgg0L/RgNC4INC/0LXRgNC10YLQsNGB0LrQuNCy0LDQvdC40Lgg0YTQsNC50LvQsCDQvdCw0LQg0L3Rg9C20L3QvtC5INC+0LHQu9Cw0YHRgtGM0Y5cblxuICAgIFsnZHJhZ2VudGVyJywgJ2RyYWdvdmVyJ10uZm9yRWFjaChmdW5jdGlvbiAoZXZlbnROYW1lKSB7XG4gICAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcihldmVudE5hbWUsIGhpZ2hsaWdodCwgZmFsc2UpO1xuICAgIH0pO1xuICAgIFsnZHJhZ2xlYXZlJywgJ2Ryb3AnXS5mb3JFYWNoKGZ1bmN0aW9uIChldmVudE5hbWUpIHtcbiAgICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgdW5oaWdobGlnaHQsIGZhbHNlKTtcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIGhpZ2hsaWdodChlKSB7XG4gICAgICBmaWxlRHJvcEFyZWEuY2xhc3NMaXN0LmFkZCgnaGlnaGxpZ2h0Jyk7XG4gICAgfVxuXG4gICAgO1xuXG4gICAgZnVuY3Rpb24gdW5oaWdobGlnaHQoZSkge1xuICAgICAgZmlsZURyb3BBcmVhLmNsYXNzTGlzdC5yZW1vdmUoJ2hpZ2hsaWdodCcpO1xuICAgIH1cblxuICAgIDsgLy9cblxuICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlRHJvcCwgZmFsc2UpO1xuXG4gICAgZnVuY3Rpb24gaGFuZGxlRHJvcChlKSB7XG4gICAgICB2YXIgZHQgPSBlLmRhdGFUcmFuc2ZlcjtcbiAgICAgIHZhciBmaWxlcyA9IGR0LmZpbGVzO1xuXG4gICAgICBpZiAoZmlsZUlucHV0LmZpbGVzICYmIGZpbGVJbnB1dC5maWxlc1swXSkge1xuICAgICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgICAgICBpZiAoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBmaWxlSW5wdXQuZmlsZXMgPSBmaWxlcztcbiAgICAgIG9uRmlsZUNoYW5nZSgpO1xuICAgICAgd2luZG93Lm9uVmVyaWZpY2F0aW9uRmlsZURyb3AgJiYgd2luZG93Lm9uVmVyaWZpY2F0aW9uRmlsZURyb3AoKTtcbiAgICAgIHdpbmRvdy5vbkRlbGl2ZXJ5RmlsZURyb3AgJiYgd2luZG93Lm9uRGVsaXZlcnlGaWxlRHJvcCgpO1xuICAgICAgd2luZG93Lm9uSW5zdGFsbGF0aW9uRmlsZURyb3AgJiYgd2luZG93Lm9uSW5zdGFsbGF0aW9uRmlsZURyb3AoKTtcbiAgICB9XG5cbiAgICA7XG5cbiAgICB2YXIgb25GaWxlQ2hhbmdlID0gZnVuY3Rpb24gb25GaWxlQ2hhbmdlKCkge1xuICAgICAgcmVhZFVybChmaWxlSW5wdXQpO1xuICAgIH07XG5cbiAgICB2YXIgcmVhZFVybCA9IGZ1bmN0aW9uIHJlYWRVcmwoaW5wdXQpIHtcbiAgICAgIGlmIChpbnB1dC5maWxlcyAmJiBpbnB1dC5maWxlc1swXSkge1xuICAgICAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcblxuICAgICAgICByZWFkZXIub25sb2FkID0gZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICBmaWxlRHJvcEFyZWEucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdsb2FkZWQnKTtcbiAgICAgICAgICBmaWxlRHJvcEFyZWEubmV4dEVsZW1lbnRTaWJsaW5nLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX25hbWUnKS50ZXh0Q29udGVudCA9IGlucHV0LmZpbGVzWzBdLm5hbWU7XG4gICAgICAgIH07XG5cbiAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwoaW5wdXQuZmlsZXNbMF0pO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBmdW5jdGlvbiBvbkNsZWFyKCkge1xuICAgICAgZmlsZURyb3BBcmVhLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcblxuICAgICAgaWYgKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWxlQ2hhbmdlKTtcbiAgICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsZWFyKTtcbiAgfVxuXG4gIHdpbmRvdy5tYWtlRmlsZUxvYWQgPSBtYWtlRmlsZUxvYWQ7XG5cbiAgaWYgKCFmaWxlRHJvcEFyZWFbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBmaWxlRHJvcEFyZWEuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIG1ha2VGaWxlTG9hZChpdGVtKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXRleHQnKTtcblxuICBpZiAoIWlucHV0c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChpbnB1dCkge1xuICAgIGlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaW5wdXQudmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSA9PT0gJycpIHtcbiAgICAgICAgaW5wdXQudmFsdWUgPSAnJztcbiAgICAgIH1cblxuICAgICAgaWYgKGlucHV0LnZhbHVlICE9PSAnJyAmJiAhaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJykpIHtcbiAgICAgICAgaW5wdXQuY2xhc3NMaXN0LmFkZCgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaW5wdXQudmFsdWUgPT09ICcnICYmIGlucHV0LmNsYXNzTGlzdC5jb250YWlucygnanMtaW5wdXRlZCcpKSB7XG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgdmggPSB3aW5kb3cuaW5uZXJIZWlnaHQgKiAwLjAxO1xuICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBcIlwiLmNvbmNhdCh2aCwgXCJweFwiKSk7XG4gIHZhciAkYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcblxuICBmdW5jdGlvbiBkZWJvdW5jZShmdW5jKSB7XG4gICAgdmFyIHRpbWVyO1xuICAgIHJldHVybiBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgIGlmICh0aW1lcikgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jLCAxMDAsIGV2ZW50KTtcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gb25SZXNpemUoKSB7XG4gICAgdmFyIHZoID0gd2luZG93LmlubmVySGVpZ2h0ICogMC4wMTtcbiAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBcIlwiLmNvbmNhdCh2aCwgXCJweFwiKSk7XG4gIH1cblxuICA7XG4gIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBkZWJvdW5jZShvblJlc2l6ZSkpO1xuXG4gIGZ1bmN0aW9uIE1vZGFsKHRyaWdnZXIsIG1vZGFsKSB7XG4gICAgdGhpcy50cmlnZ2VyID0gdHJpZ2dlcjtcbiAgICB0aGlzLm1vZGFsID0gbW9kYWw7XG4gICAgdGhpcy5vdmVybGF5ID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgICB0aGlzLmNsb3NlQnRuID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gICAgdGhpcy5vbk92ZXJsYXlDbGljayA9IHRoaXMub25PdmVybGF5Q2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uQ2xvc2VDbGljayA9IHRoaXMub25DbG9zZUNsaWNrLmJpbmQodGhpcyk7XG4gICAgdGhpcy5vblRyaWdnZXJDbGljayA9IHRoaXMub25UcmlnZ2VyQ2xpY2suYmluZCh0aGlzKTsgLy90aGlzLm9uUmVzaXplID0gdGhpcy5vblJlc2l6ZS5iaW5kKHRoaXMpO1xuXG4gICAgdGhpcy5hZGRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgTW9kYWwucHJvdG90eXBlLm9wZW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCdqcy1zaG93Jyk7XG4gICAgJGJvZHkuY2xhc3NMaXN0LmFkZCgnanNfX2JvZHktbm8tc2Nyb2xsJyk7XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLmNsb3NlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubW9kYWwuY2xhc3NMaXN0LnJlbW92ZSgnanMtc2hvdycpO1xuICAgICRib2R5LmNsYXNzTGlzdC5yZW1vdmUoJ2pzX19ib2R5LW5vLXNjcm9sbCcpO1xuICB9O1xuXG4gIE1vZGFsLnByb3RvdHlwZS5vbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uIChlKSB7XG4gICAgaWYgKGUudGFyZ2V0ID09PSB0aGlzLm92ZXJsYXkpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLm9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLm9uVHJpZ2dlckNsaWNrID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMub3BlbigpO1xuICB9OyAvLyBNb2RhbC5wcm90b3R5cGUub25SZXNpemUgPSBmdW5jdGlvbigpIHtcbiAgLy8gICAgIGxldCB2aCA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuMDE7XG4gIC8vICAgICBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc3R5bGUuc2V0UHJvcGVydHkoJy0tdmgnLCBgJHt2aH1weGApO1xuICAvLyB9O1xuXG5cbiAgTW9kYWwucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMub3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25PdmVybGF5Q2xpY2spO1xuICAgIHRoaXMuY2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uQ2xvc2VDbGljayk7XG4gICAgdGhpcy50cmlnZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vblRyaWdnZXJDbGljayk7XG4gIH07XG5cbiAgd2luZG93Lk1vZGFsID0gTW9kYWw7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAkKCcuaW5wdXQtbW9uZXknKS5tYXNrKCcjICMjMCDigr0nLCB7XG4gICAgcmV2ZXJzZTogdHJ1ZVxuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBpbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuaW5wdXQtcGhvbmUnKTtcblxuICBpZiAoIWlucHV0c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBpbSA9IG5ldyBJbnB1dG1hc2soXCIrNyg5OTkpIDk5OS05OS05OVwiKTtcbiAgaW5wdXRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpbS5tYXNrKGl0ZW0pO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWFyY2gnKTtcbiAgdmFyIGNsb3NlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNlYXJjaCArIC5zZWFyY2gtY2xvc2UnKTtcblxuICBpZiAoIWl0ZW1zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2ZvY3VzJywgKCkgPT57XG4gIC8vICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdqcy1mb2N1cycpO1xuICAvLyAgIH0pO1xuICAvLyB9KTtcblxuXG4gIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2JsdXInLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaXRlbS52YWx1ZS5zcGxpdCgnICcpLmpvaW4oJycpID09PSAnJykge1xuICAgICAgICBpdGVtLnZhbHVlID0gJyc7XG4gICAgICB9XG5cbiAgICAgIGlmIChpdGVtLnZhbHVlICE9PSAnJyAmJiAhaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKSkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5hZGQoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0udmFsdWUgPT09ICcnICYmIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJykpIHtcbiAgICAgICAgaXRlbS5jbGFzc0xpc3QucmVtb3ZlKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xuICBjbG9zZS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAgIHZhciBzZWFyY2ggPSBpdGVtLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7XG4gICAgICBzZWFyY2gudmFsdWUgPSAnJztcblxuICAgICAgaWYgKHNlYXJjaC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKSkge1xuICAgICAgICBzZWFyY2guY2xhc3NMaXN0LnJlbW92ZSgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIGZ1bmN0aW9uIGZvcm1hdE9wdGlvbihpdGVtKSB7XG4gICAgdmFyIHZhbHVlID0gaXRlbS50ZXh0LnNwbGl0KCdzcGxpdHRlcicpO1xuICAgIHZhciBiciA9IHdpbmRvdy5tYXRjaE1lZGlhKCcobWF4LXdpZHRoOiA5OTlweCknKS5tYXRjaGVzID8gJzxicj4nIDogJyc7XG5cbiAgICBpZiAodmFsdWUubGVuZ3RoID4gMSkge1xuICAgICAgdmFyIHJlc3VsdCA9ICQoJzxzcGFuPicgKyB2YWx1ZVswXSArICc8L3NwYW4+JyArIGJyICsgJzxzcGFuPicgKyB2YWx1ZVsxXSArICc8L3NwYW4+Jyk7XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gaXRlbS50ZXh0O1xuICAgIH1cbiAgfVxuXG4gICQoJy5zZWxlY3QnKS5zZWxlY3QyKHtcbiAgICB0ZW1wbGF0ZVJlc3VsdDogZm9ybWF0T3B0aW9uLFxuICAgIHRlbXBsYXRlU2VsZWN0aW9uOiBmb3JtYXRPcHRpb25cbiAgfSk7XG4gICQoJy5zZWxlY3QnKS5vbignc2VsZWN0MjpzZWxlY3QnLCBmdW5jdGlvbiAoZSkge1xuICAgICQodGhpcykuYWRkQ2xhc3MoJ3BpY2tlZCcpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWxpdmVyeVRpbWVJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG5cbiAgaWYgKCFkZWxpdmVyeVRpbWVJbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKFwiOTk6OTlcIik7XG4gIGRlbGl2ZXJ5VGltZUlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaW0ubWFzayhpdGVtKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmFnZW50c19fdXNlcnMtYmxvY2stbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2xpZGVyID0gbmV3IFN3aXBlcignLmFnZW50c19fdXNlcnMtYmxvY2stbW9iaWxlX19zbGlkZXInLCB7XG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5hZ2VudHNfX3VzZXJzLWJsb2NrLW1vYmlsZV9fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZVxuICAgIH1cbiAgfSk7XG4gICQoJy5hZ2VudHNfX3VzZXJzLWJ0bicpLnBhcmVudCgpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJCgnLmFnZW50c19fdXNlcnMtYnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykucGFyZW50KCkubmV4dCgpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNhbmNlbGxhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX19jYW5jZWxsYXRpb24nKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjYW5jZWxsYXRpb25fX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNhbmNlbGxhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWNyZWF0aW9uX19jbGllbnQtdHlwZSAgaW5wdXQnKTtcblxuICBpZiAoIXJhZGlvc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyYWN0LWNyZWF0aW9uX19kZXRhaWxzJyk7XG5cbiAgZnVuY3Rpb24gb25SYWRpb0NoYW5nZSgpIHtcbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZW50aXR5Jyk7XG4gICAgfVxuXG4gICAgaWYgKHJhZGlvc1sxXS5jaGVja2VkKSB7XG4gICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3Nob3ctZm9yLWVudGl0eScpO1xuICAgIH1cbiAgfVxuXG4gIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvblJhZGlvQ2hhbmdlKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsaWVudHMtbW9iaWxlLWJsb2NrJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2xpZGVyID0gbmV3IFN3aXBlcignLmNsaWVudHMtbW9iaWxlLWJsb2NrX19zbGlkZXInLCB7XG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5jbGllbnRzLW1vYmlsZS1ibG9ja19fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZVxuICAgIH1cbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAkKCcuZGVsaXZlcnktb3ItcGlja3VwLmRvbmUnKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzKS5maW5kKCcuY29udHJhY3QtaW5mb19fZGVsaXZlcmVkLWFkcmVzcycpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS5maW5kKCcuY29udHJhY3QtaW5mb19fZGVsaXZlcmVkLXRvZ2dsZScpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RTZXJ2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cmFjdC1zZXJ2aWNlcycpO1xuXG4gIGlmICghY29udHJhY3RTZXJ2aWNlcykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBsaW5rcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1zZXJ2aWNlc19fbGluaycpO1xuXG4gIHZhciBvbkxpbmtDbGljayA9IGZ1bmN0aW9uIG9uTGlua0NsaWNrKGUpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tib3gtYnRuX19sYWJlbCcpIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdkZWxpdmVyLW9yLXBpY2t1cF9fY29uZmlybS1idG4nKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb250cmFjdC1zZXJ2aWNlc19fZGVsaXZlcnktY29uZmlybScpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfVxuICB9O1xuXG4gIGxpbmtzLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjb250cmFjdHNMaW5rQWxsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0c19fbGluaycpO1xuXG4gIGlmICghY29udHJhY3RzTGlua0FsbFswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBvbkxpbmtDbGljayA9IGZ1bmN0aW9uIG9uTGlua0NsaWNrKGUpIHtcbiAgICB2YXIgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAodGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tib3gtYnRuX19sYWJlbCcpIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKSB8fCB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdwYXltZW50LXdhaXRpbmdfX2NvbmZpcm0tYnRuJykgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3Qtc2VydmljZXNfX2RlbGl2ZXJ5LWNvbmZpcm0nKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfTtcblxuICBjb250cmFjdHNMaW5rQWxsLmZvckVhY2goZnVuY3Rpb24gKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjb250cmFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJhY3Qtc2VydmljZXMtbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2xpZGVyID0gbmV3IFN3aXBlcignLmNvbnRyYWN0LXNlcnZpY2VzLW1vYmlsZV9fc2xpZGVyJywge1xuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcuY29udHJhY3Qtc2VydmljZXMtbW9iaWxlX19wYWdpbmF0aW9uJyxcbiAgICAgIGR5bmFtaWNCdWxsZXRzOiB0cnVlXG4gICAgfVxuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjb250cmFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJhY3RzLW1vYmlsZScpO1xuXG4gIGlmICghY29udHJhY3RzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHNsaWRlciA9IG5ldyBTd2lwZXIoJy5jb250cmFjdHMtbW9iaWxlX19zbGlkZXInLCB7XG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5jb250cmFjdHMtbW9iaWxlX19wYWdpbmF0aW9uJyxcbiAgICAgIGR5bmFtaWNCdWxsZXRzOiB0cnVlXG4gICAgfVxuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBjYW5jZWxsYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc3Vic2NyaXB0aW9uLXBhZ2VfX2FjdGlvbi1pdGVtLS1kZWxldGUnKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxldGUtc2VydmljZV9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2FuY2VsbGF0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBkZWxpdmVyeUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJyk7XG5cbiAgaWYgKCFkZWxpdmVyeUJ0bnNbMF0pIHtcbiAgICByZXR1cm47XG4gIH0gLy8gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGRhdGVUZXh0KSB7XG4gIC8vICAgb25GaWVsZENoYW5nZSgpO1xuICAvLyB9KTtcblxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxpdmVyeS1vci1waWNrdXBfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgLy8gY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICAvLyBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cblxuICBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbiAoYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTsgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgLy8gICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAvLyAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgLy8gICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgLy8gICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gfVxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25GaWVsZENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoaXNGb3JtRmlsbGVkKCkgJiYgc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgLy8gICB9IGVsc2UgaWYgKCFpc0Zvcm1GaWxsZWQoKSAmJiAhc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IGlzRm9ybUZpbGxlZCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ2dldERhdGUnKVxuICAvLyAgICAgJiYgdGltZUlucHV0LnZhbHVlICE9PSAnJ1xuICAvLyAgICAgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWVcbiAgLy8gICAgICYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gfVxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyBjb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgZGV2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1jcmVhdGlvbl9fZGVsaXZlcnktZGV2aWNlJyk7XG5cbiAgaWYgKCFkZXZpY2VzWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZGV2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgdmFyIHJhZGlvcyA9IGl0ZW0ucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWNyZWF0aW9uX19kZWxpdmVyeS10eXBlLXdyYXBwZXIgIGlucHV0Jyk7XG5cbiAgICBmdW5jdGlvbiBvblJhZGlvQ2hhbmdlKGUpIHtcbiAgICAgIHZhciB3cmFwcGVyID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG5cbiAgICAgIGlmIChyYWRpb3NbMF0uY2hlY2tlZCkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXBpY2t1cCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1waWNrdXAnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByYWRpb3MuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvblJhZGlvQ2hhbmdlKTtcbiAgICB9KTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgJGRhdGUgPSAkKCcjZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbCAuZGF0ZS1pbnB1dCcpO1xuICAkZGF0ZS5kYXRlcGlja2VyKCkub24oJ2NoYW5nZScsIGZ1bmN0aW9uIChkYXRlVGV4dCkge1xuICAgIGlmICgkKCcjZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbCcpLmhhc0NsYXNzKCdqcy1zaG93JykpIHtcbiAgICAgIG9uRmllbGRDaGFuZ2UoKTtcbiAgICB9XG4gIH0pO1xuICB2YXIgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIHZhciBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIHZhciBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICB2YXIgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIHZhciBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgdmFyIGZpbGVDbGVhciA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG4gIHZhciBkYXRlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC1kYXRlJyk7XG4gIHZhciB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIHZhciBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cbiAgdmFyIG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uIG9uQ2xvc2VDbGljaygpIHtcbiAgICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgICBpZiAoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgfVxuICAgIH1cblxuICAgIGRhdGVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHRpbWVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgJGRhdGUuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgfTtcblxuICB2YXIgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbiBvbk92ZXJsYXlDbGljayhlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAgICAgb25DbG9zZUNsaWNrKCk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24gb25GaWVsZENoYW5nZShlKSB7XG4gICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25GaWxlQ2xlYXIgPSBmdW5jdGlvbiBvbkZpbGVDbGVhcigpIHtcbiAgICBpZiAoIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaXNGb3JtRmlsbGVkID0gZnVuY3Rpb24gaXNGb3JtRmlsbGVkKCkge1xuICAgIHJldHVybiAkZGF0ZS5kYXRlcGlja2VyKCdnZXREYXRlJykgJiYgdGltZUlucHV0LnZhbHVlICE9PSAnJyAmJiBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9PT0gdHJ1ZSAmJiBmaWxlSW5wdXQudmFsdWUgIT09ICcnO1xuICB9O1xuXG4gIHdpbmRvdy5vbkRlbGl2ZXJ5RmlsZURyb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgb25GaWVsZENoYW5nZSgpO1xuICB9O1xuXG4gIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgZGF0ZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIHRpbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgd2luZG93Lm9uRGVsaXZlcnlGaWxlRHJvcCk7XG4gIGNvbmZpcm1DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgZmlsZUNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25GaWxlQ2xlYXIpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIG1lbnUgPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51Jyk7XG4gIHZhciBidG4gPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKTtcbiAgJC5leHRlbmQoJC5kYXRlcGlja2VyLCB7XG4gICAgLy8gUmVmZXJlbmNlIHRoZSBvcmlnbmFsIGZ1bmN0aW9uIHNvIHdlIGNhbiBvdmVycmlkZSBpdCBhbmQgY2FsbCBpdCBsYXRlclxuICAgIF9pbmxpbmVEYXRlcGlja2VyMjogJC5kYXRlcGlja2VyLl9pbmxpbmVEYXRlcGlja2VyLFxuICAgIC8vIE92ZXJyaWRlIHRoZSBfaW5saW5lRGF0ZXBpY2tlciBtZXRob2RcbiAgICBfaW5saW5lRGF0ZXBpY2tlcjogZnVuY3Rpb24gX2lubGluZURhdGVwaWNrZXIodGFyZ2V0LCBpbnN0KSB7XG4gICAgICAvLyBDYWxsIHRoZSBvcmlnaW5hbFxuICAgICAgdGhpcy5faW5saW5lRGF0ZXBpY2tlcjIodGFyZ2V0LCBpbnN0KTtcblxuICAgICAgdmFyIGJlZm9yZVNob3cgPSAkLmRhdGVwaWNrZXIuX2dldChpbnN0LCAnYmVmb3JlU2hvdycpO1xuXG4gICAgICBpZiAoYmVmb3JlU2hvdykge1xuICAgICAgICBiZWZvcmVTaG93LmFwcGx5KHRhcmdldCwgW3RhcmdldCwgaW5zdF0pO1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG4gICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHtcbiAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51JykudG9nZ2xlKCk7XG4gIH0pO1xuICAkKCcuZGF0ZS1pbnB1dC1wZXJpb2QnKS5kYXRlcGlja2VyKHtcbiAgICByYW5nZTogJ3BlcmlvZCcsXG4gICAgaW5saW5lOiB0cnVlLFxuICAgIHNob3dCdXR0b25QYW5lbDogdHJ1ZSxcbiAgICBzaG93T3RoZXJNb250aHM6IHRydWUsXG4gICAgc2VsZWN0T3RoZXJNb250aHM6IHRydWUsXG4gICAgY2xvc2VUZXh0OiBcItCT0L7RgtC+0LLQvlwiLFxuICAgIGJlZm9yZVNob3c6IGZ1bmN0aW9uIGJlZm9yZVNob3coaW5wdXQsIGluc3QpIHtcbiAgICAgIGluc3QuZHBEaXYuY3NzKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlWCgtMjRweCknKTtcbiAgICAgIGluc3QuZHBEaXYuYWRkQ2xhc3MoJ2NhbGVuZGFyLXJhbmdlJyk7XG4gICAgfSxcbiAgICBvblNlbGVjdDogZnVuY3Rpb24gb25TZWxlY3QoZGF0ZVRleHQsIGluc3QsIGV4dGVuc2lvblJhbmdlKSB7XG4gICAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KGV4dGVuc2lvblJhbmdlLnN0YXJ0RGF0ZVRleHQgKyAnIC0gJyArIGV4dGVuc2lvblJhbmdlLmVuZERhdGVUZXh0KTtcbiAgICB9XG4gIH0pO1xuICAkKGRvY3VtZW50KS5tb3VzZXVwKGZ1bmN0aW9uIChlKSB7XG4gICAgdmFyIG1lbnUgPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51Jyk7XG4gICAgdmFyIGJ0biA9ICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpO1xuXG4gICAgaWYgKCFtZW51LmlzKGUudGFyZ2V0KSAmJiBtZW51LmhhcyhlLnRhcmdldCkubGVuZ3RoID09PSAwICYmICFidG4uaXMoZS50YXJnZXQpICYmIGJ0bi5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMCkge1xuICAgICAgbWVudS5oaWRlKCk7XG4gICAgfVxuICB9KTtcbiAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudS1idG4nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCQodGhpcykuaGFzQ2xhc3MoJ2FsbC10aW1lJykpIHtcbiAgICAgICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLnRleHQoJCh0aGlzKS50ZXh0KCkgKyBcIiAoXFx1MDQ0MVxceEEwXCIgKyAkKCcuZWFybmVkLWRhdGVfX3N0YXJ0LXBlcmlvZCcpLnRleHQoKSArICcpJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLnRleHQoJCh0aGlzKS50ZXh0KCkpO1xuICAgIH1cblxuICAgIG1lbnUuaGlkZSgpO1xuICB9KTtcbiAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykudGV4dCgkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51LWJ0bi5hbGwtdGltZScpLnRleHQoKSArIFwiIChcXHUwNDQxXFx4QTBcIiArICQoJy5lYXJuZWQtZGF0ZV9fc3RhcnQtcGVyaW9kJykudGV4dCgpICsgJyknKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gICQoJy5maWx0ZXJzX19idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7XG4gICAgJCh0aGlzKS5wYXJlbnQoKS5uZXh0KCkuc2xpZGVUb2dnbGUoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcblxuICBpZiAoIWRlbGl2ZXJ5QnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfSAvLyAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZGF0ZVRleHQpIHtcbiAgLy8gICBvbkZpZWxkQ2hhbmdlKCk7XG4gIC8vIH0pO1xuXG5cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RhbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHN1Ym1pdCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc3VibWl0Jyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICAvLyBjb25zdCBmaWxlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgLy8gY29uc3QgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICAvLyBjb25zdCB0aW1lSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG4gIC8vIGNvbnN0IGNvbmZpcm1DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5jaGVja2JveF9faW5wdXQnKTtcblxuXG4gIGRlbGl2ZXJ5QnRucy5mb3JFYWNoKGZ1bmN0aW9uIChidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pOyAvL2NvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAvLyAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAvLyAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gIC8vICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgdGltZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIC8vICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgLy8gICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAvLyAgIH1cbiAgLy8gfVxuICAvLyBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgLy8gICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gIC8vICAgICAvLyYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gfVxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvLyB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy9maWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG4gIC8vY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZWxpdmVyeS1vci1waWNrdXBfX2luc3RhbGxhdGlvbi1jaG9vc2UtYmxvY2sgIGlucHV0Jyk7XG5cbiAgaWYgKCFyYWRpb3NbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgd3JhcHBlciA9IHJhZGlvc1swXS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuXG4gIGZ1bmN0aW9uIG9uUmFkaW9DaGFuZ2UoKSB7XG4gICAgY29uc29sZS5sb2cod3JhcHBlcik7XG5cbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAocmFkaW9zWzJdLmNoZWNrZWQpIHtcbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItZGVsaXZlcnknKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLWRlbGl2ZXJ5Jyk7XG4gICAgICB9XG5cbiAgICAgIGlmICh3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItbWFudWFsJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1tYW51YWwnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByYWRpb3MuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25SYWRpb0NoYW5nZSk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgLy8gY29uc3QgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcbiAgLy8gaWYgKCFkZWxpdmVyeUJ0bnNbMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RhbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyICRkYXRlID0gJCgnI2luc3RhbGxhdGlvbl9fbW9kYWwgLmRhdGUtaW5wdXQnKTtcbiAgJGRhdGUuZGF0ZXBpY2tlcigpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbiAoZGF0ZVRleHQpIHtcbiAgICBpZiAoJCgnI2luc3RhbGxhdGlvbl9fbW9kYWwnKS5oYXNDbGFzcygnanMtc2hvdycpKSB7XG4gICAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gICAgfVxuICB9KTtcbiAgdmFyIGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICB2YXIgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICB2YXIgc3VibWl0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19zdWJtaXQnKTtcbiAgdmFyIGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtaW5wdXQtZmlsZScpO1xuICB2YXIgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIHZhciBmaWxlQ2xlYXIgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuZmlsZS1sb2FkX19jbGVhcicpO1xuICB2YXIgZGF0ZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtZGF0ZScpO1xuICB2YXIgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICB2YXIgY29uZmlybUNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmNoZWNrYm94X19pbnB1dCcpOyAvLyBkZWxpdmVyeUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgLy8gICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIC8vIH0pO1xuXG4gIHZhciBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbiBvbkNsb3NlQ2xpY2soKSB7XG4gICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAgICAgaWYgKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAgICRkYXRlLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIH07XG5cbiAgdmFyIG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24gb25PdmVybGF5Q2xpY2soZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25GaWVsZENoYW5nZSA9IGZ1bmN0aW9uIG9uRmllbGRDaGFuZ2UoZSkge1xuICAgIGlmIChpc0Zvcm1GaWxsZWQoKSAmJiBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSBpZiAoIWlzRm9ybUZpbGxlZCgpICYmICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIGlzRm9ybUZpbGxlZCA9IGZ1bmN0aW9uIGlzRm9ybUZpbGxlZCgpIHtcbiAgICByZXR1cm4gJGRhdGUuZGF0ZXBpY2tlcignZ2V0RGF0ZScpICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJycgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWUgJiYgZmlsZUlucHV0LnZhbHVlICE9PSAnJztcbiAgfTtcblxuICB2YXIgb25GaWxlQ2xlYXIgPSBmdW5jdGlvbiBvbkZpbGVDbGVhcigpIHtcbiAgICBpZiAoIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB3aW5kb3cub25JbnN0YWxsYXRpb25GaWxlRHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gIH07XG5cbiAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICBkYXRlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgdGltZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cub25JbnN0YWxsYXRpb25GaWxlRHJvcCk7XG4gIGNvbmZpcm1DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgZmlsZUNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25GaWxlQ2xlYXIpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHBheW1lbnRDb25maXJtQnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdXR1YWwtY2FsY3NfX21ha2UtcGF5bWVudCcpO1xuXG4gIGlmICghcGF5bWVudENvbmZpcm1CdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtd2FpdGluZ19fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IG1haW5DaGVja2JveCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2FjdGlvbnNfX2NoZWNrLWFsbCBpbnB1dCcpO1xuICAvLyBjb25zdCBzZW5kZXJJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXNlbmRlciBpbnB1dCcpO1xuICAvLyBjb25zdCByZWNpcGllbnRJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXJlY2lwaWVudCBpbnB1dCcpO1xuICAvLyBjb25zdCBzdW1JbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXN1bSBpbnB1dCcpO1xuICAvLyBjb25zdCBwdXJwb3NlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1wdXJwb3NlIGlucHV0Jyk7XG4gIC8vIGNvbnN0IGdldEFsbENoZWNrYm94ID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX2NoZWNrIGlucHV0Jyk7XG4gIC8vIH07XG4gIC8vIGNvbnN0IG9uQWxsQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGNvbnN0IHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgLy8gICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAvLyAgICAgICBpZiAoIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0gZWxzZSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH07XG4gIC8vIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIG1haW5DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9KTtcbiAgLy8gICAkKCcjcGF5bWVudC1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgLy8gICBzZW5kZXJJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHJlY2lwaWVudElucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgc3VtSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBwdXJwb3NlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gfTtcbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uQ2hlY2tib3hDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuXG4gIHBheW1lbnRDb25maXJtQnRucy5mb3JFYWNoKGZ1bmN0aW9uIChidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pOyAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIG1haW5DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkFsbENoYW5nZSk7XG4gIC8vIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2hhbmdlKTtcbiAgLy8gfSlcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBtZW51QnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2LWJ0bicpO1xuXG4gIGlmICghbWVudUJ0bikge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2Nsb3NlLWJ0bicpO1xuICB2YXIgbmF2ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhlYWRlcl9fbmF2Jyk7XG5cbiAgdmFyIGNoZWNrSWZUYWJsZXQgPSBmdW5jdGlvbiBjaGVja0lmVGFibGV0KCkge1xuICAgIHJldHVybiB3aW5kb3cubWF0Y2hNZWRpYSgnKG1heC13aWR0aDogMTQzOXB4KScpLm1hdGNoZXM7XG4gIH07XG5cbiAgdmFyIGlzVGFibGV0ID0gY2hlY2tJZlRhYmxldCgpO1xuXG4gIHZhciBvbkJ0bkNsaWNrID0gZnVuY3Rpb24gb25CdG5DbGljaygpIHtcbiAgICBpZiAoY2hlY2tJZlRhYmxldCgpKSB7XG4gICAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoJ2pzLW9wZW5lZCcpO1xuICAgICAgbmF2LmNsYXNzTGlzdC50b2dnbGUoJ2pzLXNob3cnKTtcbiAgICB9XG4gIH07XG5cbiAgdmFyIG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uIG9uQ2xvc2VDbGljaygpIHtcbiAgICBuYXYuY2xhc3NMaXN0LnJlbW92ZSgnanMtc2hvdycpO1xuICAgIG1lbnVCdG4uY2xhc3NMaXN0LnRvZ2dsZSgnanMtb3BlbmVkJyk7XG4gIH07XG5cbiAgbWVudUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQnRuQ2xpY2spO1xuICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm11dHVhbC1jYWxjcy1wYXltZW50LW1vYmlsZScpO1xuXG4gIGlmICghY29udHJhY3RzKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIHNsaWRlciA9IG5ldyBTd2lwZXIoJy5tdXR1YWwtY2FsY3MtcGF5bWVudC1tb2JpbGVfX3NsaWRlcicsIHtcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgIHBhZ2luYXRpb246IHtcbiAgICAgIGVsOiAnLm11dHVhbC1jYWxjcy1wYXltZW50LW1vYmlsZV9fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZVxuICAgIH1cbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgY29udHJhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm11dHVhbC1jYWxjcy1ibG9jay1tb2JpbGUnKTtcblxuICBpZiAoIWNvbnRyYWN0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBzbGlkZXIgPSBuZXcgU3dpcGVyKCcubXV0dWFsLWNhbGNzLWJsb2NrLW1vYmlsZV9fc2xpZGVyJywge1xuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcubXV0dWFsLWNhbGNzLWJsb2NrLW1vYmlsZV9fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZVxuICAgIH1cbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICB2YXIgcGF5bWVudENvbmZpcm1CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKTtcblxuICBpZiAoIXBheW1lbnRDb25maXJtQnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfSAvLyQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCk7XG5cblxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC13YWl0aW5nX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gY29uc3QgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIC8vIGNvbnN0IG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgLy8gY29uc3QgbWFpbkNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRyYW5zYWN0aW9uc19fY2hlY2stYWxsIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHNlbmRlcklucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc2VuZGVyIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHJlY2lwaWVudElucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcmVjaXBpZW50IGlucHV0Jyk7XG4gIC8vIGNvbnN0IHN1bUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc3VtIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHB1cnBvc2VJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXB1cnBvc2UgaW5wdXQnKTtcbiAgLy8gY29uc3QgZ2V0QWxsQ2hlY2tib3ggPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnRyYW5zYWN0aW9uc19fY2hlY2sgaW5wdXQnKTtcbiAgLy8gfTtcbiAgLy8gY29uc3Qgb25BbGxDaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgICAgY29uc3Qgcm93ID0gaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAvLyAgICAgaWYgKG1haW5DaGVja2JveC5jaGVja2VkKSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XG4gIC8vICAgICAgIGlmICghcm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgICAgIGlmIChyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgLy8gICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9XG4gIC8vICAgfSlcbiAgLy8gfTtcbiAgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgbWFpbkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgIH0pO1xuICAvLyAgICQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICAvLyAgIHNlbmRlcklucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgcmVjaXBpZW50SW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBzdW1JbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHB1cnBvc2VJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyB9O1xuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25DaGVja2JveENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2hlY2tlZCkge1xuICAvLyAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgfSBlbHNlIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG5cbiAgcGF5bWVudENvbmZpcm1CdG5zLmZvckVhY2goZnVuY3Rpb24gKGJ0bikge1xuICAgIG5ldyBNb2RhbChidG4sIG1vZGFsKTtcbiAgfSk7IC8vIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgLy8gb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgLy8gbWFpbkNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxsQ2hhbmdlKTtcbiAgLy8gZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDaGFuZ2UpO1xuICAvLyB9KVxufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgLy8gY29uc3QgcGF5bWVudENvbmZpcm1CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKTtcbiAgLy8gaWYgKCFwYXltZW50Q29uZmlybUJ0bnNbMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtd2FpdGluZ19fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICB2YXIgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICB2YXIgbWFpbkNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRyYW5zYWN0aW9uc19fY2hlY2stYWxsIGlucHV0Jyk7XG4gIHZhciBzZW5kZXJJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXNlbmRlciBpbnB1dCcpO1xuICB2YXIgcmVjaXBpZW50SW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1yZWNpcGllbnQgaW5wdXQnKTtcbiAgdmFyIHN1bUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc3VtIGlucHV0Jyk7XG4gIHZhciBwdXJwb3NlSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1wdXJwb3NlIGlucHV0Jyk7XG5cbiAgdmFyIGdldEFsbENoZWNrYm94ID0gZnVuY3Rpb24gZ2V0QWxsQ2hlY2tib3goKSB7XG4gICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX2NoZWNrIGlucHV0Jyk7XG4gIH07XG5cbiAgdmFyIGdldEFsbE1vYmlsZUNoZWNrYm94ID0gZnVuY3Rpb24gZ2V0QWxsTW9iaWxlQ2hlY2tib3goKSB7XG4gICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX21vYmlsZS1jaGVjayBpbnB1dCcpO1xuICB9O1xuXG4gIHZhciBvbkFsbENoYW5nZSA9IGZ1bmN0aW9uIG9uQWxsQ2hhbmdlKCkge1xuICAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgICAgdmFyIHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcblxuICAgICAgaWYgKG1haW5DaGVja2JveC5jaGVja2VkKSB7XG4gICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XG5cbiAgICAgICAgaWYgKCFyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcblxuICAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIHZhciBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbiBvbkNsb3NlQ2xpY2soKSB7XG4gICAgbWFpbkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgICB9KTtcbiAgICBnZXRBbGxNb2JpbGVDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfSk7XG4gICAgJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gICAgc2VuZGVySW5wdXQudmFsdWUgPSAnJztcbiAgICByZWNpcGllbnRJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHN1bUlucHV0LnZhbHVlID0gJyc7XG4gICAgcHVycG9zZUlucHV0LnZhbHVlID0gJyc7XG4gIH07XG5cbiAgdmFyIG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24gb25PdmVybGF5Q2xpY2soZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25DaGVja2JveENoYW5nZSA9IGZ1bmN0aW9uIG9uQ2hlY2tib3hDaGFuZ2UoZSkge1xuICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfVxuICB9O1xuXG4gIHZhciBvbk1vYmlsZUNoZWNrYm94Q2hhbmdlID0gZnVuY3Rpb24gb25Nb2JpbGVDaGVja2JveENoYW5nZShlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAgIH1cbiAgfTsgLy8gcGF5bWVudENvbmZpcm1CdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gIC8vICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICAvLyB9KTtcblxuXG4gIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgbWFpbkNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxsQ2hhbmdlKTtcbiAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2hhbmdlKTtcbiAgfSk7XG4gIGdldEFsbE1vYmlsZUNoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25Nb2JpbGVDaGVja2JveENoYW5nZSk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHBheW1lbnRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm11dHVhbC1jYWxjcy1wYXltZW50LWJsb2NrX19saW5rJyk7XG5cbiAgaWYgKCFwYXltZW50c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50LWluZm9fX21vZGFsJyk7XG4gIHBheW1lbnRzLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICB9KTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIHZhciBzY2hlZHVsZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtZGV2aWNlX19zY2hlZHVsZScpO1xuXG4gIGlmICghc2NoZWR1bGVCdG5zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH0gLy8gY29uc3QgcmFkaW9zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnNjaGVkdWxlX19tb2RhbC10b2dnbGUgaW5wdXQnKTtcbiAgLy8gY29uc3QgdG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjaGVkdWxlX19tb2RhbC10b2dnbGUnKTtcbiAgLy8gcmFkaW9zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaWQpIHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAvLyAgICAgaWYgKGlkID09PSAwKSB7XG4gIC8vICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWNvbmQtdGFiJyk7XG4gIC8vICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdmaXJzdC10YWInKTtcbiAgLy8gICAgIH1cbiAgLy8gICAgIGlmIChpZCA9PT0gMSkge1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnZmlyc3QtdGFiJyk7XG4gIC8vICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdzZWNvbmQtdGFiJyk7XG4gIC8vICAgICB9XG4gIC8vICAgfSlcbiAgLy8gfSlcblxuXG4gIHNjaGVkdWxlQnRucy5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCBzY2hlZHVsZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtZGV2aWNlX19zY2hlZHVsZScpO1xuICAvLyBpZiAoIXNjaGVkdWxlQnRuc1swXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NoZWR1bGVfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciByYWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2NoZWR1bGVfX21vZGFsLXRvZ2dsZSBpbnB1dCcpO1xuICB2YXIgdG9nZ2xlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnNjaGVkdWxlX19tb2RhbC10b2dnbGUnKTtcbiAgcmFkaW9zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGlkKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpZiAoaWQgPT09IDApIHtcbiAgICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ3NlY29uZC10YWInKTtcbiAgICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ2ZpcnN0LXRhYicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoaWQgPT09IDEpIHtcbiAgICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5yZW1vdmUoJ2ZpcnN0LXRhYicpO1xuICAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnc2Vjb25kLXRhYicpO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTsgLy8gc2NoZWR1bGVCdG5zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIC8vIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIG1haW5QYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1haW4tcGFnZScpO1xuXG4gIGlmICghbWFpblBhZ2UpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc3VwcG9ydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdXBwb3J0Jyk7XG4gIHZhciBzdXBwb3J0Q29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnN1cHBvcnRfX2NvbnRhaW5lcicpO1xuICB2YXIgaXRlbXMgPSBzdXBwb3J0LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zdXBwb3J0X19pdGVtJyk7XG5cbiAgZnVuY3Rpb24gbWFrZVNsaWRlcigpIHtcbiAgICB2YXIgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGNvbnRhaW5lci5jbGFzc0xpc3QuYWRkKCdzd2lwZXItY29udGFpbmVyJyk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3N1cHBvcnRfX3NsaWRlcicpO1xuICAgIHZhciB3cmFwcGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzd2lwZXItd3JhcHBlcicpO1xuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0sIGlkeCkge1xuICAgICAgdmFyIHNsaWRlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICBzbGlkZS5jbGFzc0xpc3QuYWRkKCdzd2lwZXItc2xpZGUnKTtcbiAgICAgIHZhciBub2RlID0gaXRlbS5jbG9uZU5vZGUodHJ1ZSk7XG4gICAgICBzbGlkZS5hcHBlbmRDaGlsZChub2RlKTtcbiAgICAgIHdyYXBwZXIuYXBwZW5kQ2hpbGQoc2xpZGUpO1xuICAgIH0pO1xuICAgIHZhciBwYWdpbmF0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcGFnaW5hdGlvbi5jbGFzc0xpc3QuYWRkKCdzdXBwb3J0X19zbGlkZXItcGFnaW5hdGlvbicsICdzd2lwZXItcGFnaW5hdGlvbicpO1xuICAgIGNvbnRhaW5lci5hcHBlbmRDaGlsZCh3cmFwcGVyKTtcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQocGFnaW5hdGlvbik7XG4gICAgZnJhZ21lbnQuYXBwZW5kQ2hpbGQoY29udGFpbmVyKTtcbiAgICBzdXBwb3J0Q29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcbiAgICB2YXIgc2xpZGVyID0gbmV3IFN3aXBlcignLnN1cHBvcnRfX3NsaWRlcicsIHtcbiAgICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgICBwYWdpbmF0aW9uOiB7XG4gICAgICAgIGVsOiAnLnN1cHBvcnRfX3NsaWRlci1wYWdpbmF0aW9uJ1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgbWFrZVNsaWRlcigpO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgJCgnLnN1cHBvcnRfX2RvY3MtYnRuJykuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICQodGhpcykucGFyZW50KCkubmV4dCgpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRyYW5zYWN0aW9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy50cmFuc2FjdGlvbnMtbW9iaWxlLWJsb2NrJyk7XG5cbiAgaWYgKCF0cmFuc2FjdGlvbnMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgc2xpZGVyID0gbmV3IFN3aXBlcignLnRyYW5zYWN0aW9ucy1tb2JpbGUtYmxvY2tfX3NsaWRlcicsIHtcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgIHBhZ2luYXRpb246IHtcbiAgICAgIGVsOiAnLnRyYW5zYWN0aW9ucy1tb2JpbGUtYmxvY2tfX3BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0J1bGxldHM6IHRydWVcbiAgICB9XG4gIH0pO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIHZlcmlmaWNhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKTtcblxuICBpZiAoIXZlcmlmaWNhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2ZXJpZmljYXRpb25fX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfSAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy52ZXJpZmljYXRpb25fX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICAvLyBjb25zdCBvdmVybGF5ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19vdmVybGF5Jyk7XG4gIC8vIGNvbnN0IHNhdmVCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3NhdmUnKTtcbiAgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgLy8gICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuICAvLyAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgICBzYXZlQnRuLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gIC8vICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAvLyAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAvLyAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgLy8gICAgIH1cbiAgLy8gICB9XG4gIC8vIH1cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG4gIC8vIGNvbnN0IG9uSW5wdXRDaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBpZiAoZmlsZUlucHV0LnZhbHVlICE9PSAnJykge1xuICAvLyAgICAgc2F2ZUJ0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gIC8vICAgfVxuICAvLyB9XG5cblxuICB2ZXJpZmljYXRpb25CdG4uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pOyAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbklucHV0Q2hhbmdlKTtcbn0pKCk7XG5cbihmdW5jdGlvbiAoKSB7XG4gIC8vIGNvbnN0IHZlcmlmaWNhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKTtcbiAgLy8gaWYgKCF2ZXJpZmljYXRpb25CdG5bMF0pIHtcbiAgLy8gICByZXR1cm47XG4gIC8vIH1cbiAgdmFyIG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZlcmlmaWNhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGZpbGVJbnB1dEJsb2NrID0gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnZlcmlmaWNhdGlvbl9fbW9kYWwtaW5wdXQtZmlsZScpOyAvL2NvbnN0IGZpbGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICAvL2NvbnN0IGZpbGVDbGVhciA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG5cbiAgdmFyIGNsb3NlID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19jbG9zZScpO1xuICB2YXIgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICB2YXIgc2F2ZUJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc2F2ZScpO1xuXG4gIHZhciBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbiBvbkNsb3NlQ2xpY2soKSB7XG4gICAgZmlsZUlucHV0QmxvY2suZm9yRWFjaChmdW5jdGlvbiAoaW5wdXRCbG9jaykge1xuICAgICAgdmFyIGZpbGVJbnB1dCA9IGlucHV0QmxvY2sucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG5cbiAgICAgIGlmIChpbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAgICAgaW5wdXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdsb2FkZWQnKTtcbiAgICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgIHNhdmVCdG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAgICAgICBpZiAoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKSB7XG4gICAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pO1xuICB9O1xuXG4gIHZhciBjaGVja0lucHV0cyA9IGZ1bmN0aW9uIGNoZWNrSW5wdXRzKCkge1xuICAgIHZhciBmaWxsZWQgPSB0cnVlO1xuICAgIGZpbGVJbnB1dEJsb2NrLmZvckVhY2goZnVuY3Rpb24gKGlucHV0QmxvY2spIHtcbiAgICAgIHZhciBmaWxlSW5wdXQgPSBpbnB1dEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuXG4gICAgICBpZiAoZmlsZUlucHV0LnZhbHVlID09PSAnJykge1xuICAgICAgICBmaWxsZWQgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIGlmIChmaWxsZWQgJiYgc2F2ZUJ0bi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIGlmICghZmlsbGVkICYmICFzYXZlQnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTtcblxuICB2YXIgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbiBvbk92ZXJsYXlDbGljayhlKSB7XG4gICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAgICAgb25DbG9zZUNsaWNrKCk7XG4gICAgfVxuICB9OyAvLyBjb25zdCBvbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgLy8gICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG5cbiAgdmFyIG9uRmlsZUNsZWFyID0gZnVuY3Rpb24gb25GaWxlQ2xlYXIoKSB7XG4gICAgaWYgKCFzYXZlQnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfTsgLy8gdmVyaWZpY2F0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIC8vIH0pXG5cblxuICB3aW5kb3cub25WZXJpZmljYXRpb25GaWxlRHJvcCA9IGZ1bmN0aW9uICgpIHtcbiAgICBjaGVja0lucHV0cygpO1xuICB9O1xuXG4gIGZpbGVJbnB1dEJsb2NrLmZvckVhY2goZnVuY3Rpb24gKGlucHV0QmxvY2spIHtcbiAgICB2YXIgZmlsZUlucHV0ID0gaW5wdXRCbG9jay5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcbiAgICB2YXIgZmlsZUNsZWFyID0gaW5wdXRCbG9jay5xdWVyeVNlbGVjdG9yKCcuZmlsZS1sb2FkX19jbGVhcicpO1xuICAgIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cub25WZXJpZmljYXRpb25GaWxlRHJvcCk7XG4gICAgZmlsZUNsZWFyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25GaWxlQ2xlYXIpO1xuICB9KTtcbiAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xufSkoKTtcblxuKGZ1bmN0aW9uICgpIHtcbiAgdmFyIGNhbmNlbGxhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX19zZXJpYWwtYnRuJyk7XG5cbiAgaWYgKCFjYW5jZWxsYXRpb25CdG5bMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3JpdGUtc2VyaWFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNhbmNlbGxhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuXG4oZnVuY3Rpb24gKCkge1xuICAvLyBjb25zdCB2ZXJpZmljYXRpb25CdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtaW5mb19fdmVyaWZpY2F0aW9uJyk7XG4gIC8vIGlmICghdmVyaWZpY2F0aW9uQnRuWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG4gIHZhciBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd3cml0ZS1zZXJpYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIGlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLndyaXRlLXNlcmlhbF9faW5wdXQgLmlucHV0LXRleHQnKTtcbiAgdmFyIGJ0biA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fc2F2ZScpO1xuXG4gIHZhciBvbklucHV0ID0gZnVuY3Rpb24gb25JbnB1dChlKSB7XG4gICAgdmFyIHZhbHVlID0gZS50YXJnZXQudmFsdWU7XG5cbiAgICBpZiAodmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSAhPT0gJycgJiYgdmFsdWUubGVuZ3RoID4gMCAmJiBidG4uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBidG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH1cblxuICAgIGlmICh2YWx1ZS5zcGxpdCgnICcpLmpvaW4oJycpID09PSAnJyB8fCB2YWx1ZS5sZW5ndGggPT09IDApIHtcbiAgICAgIGlmICghYnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgICBidG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICAgIH1cbiAgICB9XG4gIH07IC8vIHZlcmlmaWNhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICAvLyB9KVxuXG5cbiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBjaGVja2JveDIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY2hlY2tib3gtMl9faW5wdXQnKTtcblxuICBpZiAoIWNoZWNrYm94MlswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNoZWNrYm94Mi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKGUpIHtcbiAgICAgIGNvbnN0IHRhcmdldCA9IGUudGFyZ2V0O1xuICAgICAgaWYgKHRhcmdldC5jaGVja2VkID09PSB0cnVlKSB7XG4gICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRhcmdldC5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICQoJy5kYXRlLWlucHV0JykuZGF0ZXBpY2tlcigpO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgZmlsZURyb3BBcmVhID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LWZpbGVfX2xhYmVsJyk7XG5cbiAgZnVuY3Rpb24gbWFrZUZpbGVMb2FkKGZpbGVEcm9wQXJlYSkge1xuICAgIGNvbnN0IGZpbGVJbnB1dCA9IGZpbGVEcm9wQXJlYS5xdWVyeVNlbGVjdG9yKCdpbnB1dCcpO1xuICAgIGNvbnN0IGZpbGVDbGVhciA9IGZpbGVEcm9wQXJlYS5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG4gICAgLy8g0KHQsdGA0LDRgdGL0LLQsNC10Lwg0YHRgtCw0L3QtNCw0YDRgtC90YvQtSDRgdC+0LHRi9GC0LjRjyDQv9GA0Lgg0L/QtdGA0LXRgtCw0YHQutC40LLQsNC90LjQuCDRhNCw0LnQu9CwXG5cbiAgICBbJ2RyYWdlbnRlcicsICdkcmFnb3ZlcicsICdkcmFnbGVhdmUnLCAnZHJvcCddLmZvckVhY2goZXZlbnROYW1lID0+IHtcbiAgICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgcHJldmVudERlZmF1bHRzLCBmYWxzZSlcbiAgICB9KTtcblxuICAgIGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0cyAoZSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICB9O1xuXG4gICAgLy8g0JTQvtCx0LDQstC70Y/QtdC8INGB0YLQuNC70Lgg0L/RgNC4INC/0LXRgNC10YLQsNGB0LrQuNCy0LDQvdC40Lgg0YTQsNC50LvQsCDQvdCw0LQg0L3Rg9C20L3QvtC5INC+0LHQu9Cw0YHRgtGM0Y5cblxuICAgIFsnZHJhZ2VudGVyJywgJ2RyYWdvdmVyJ10uZm9yRWFjaChldmVudE5hbWUgPT4ge1xuICAgICAgZmlsZURyb3BBcmVhLmFkZEV2ZW50TGlzdGVuZXIoZXZlbnROYW1lLCBoaWdobGlnaHQsIGZhbHNlKVxuICAgIH0pO1xuXG4gICAgWydkcmFnbGVhdmUnLCAnZHJvcCddLmZvckVhY2goZXZlbnROYW1lID0+IHtcbiAgICAgIGZpbGVEcm9wQXJlYS5hZGRFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgdW5oaWdobGlnaHQsIGZhbHNlKVxuICAgIH0pXG5cbiAgICBmdW5jdGlvbiBoaWdobGlnaHQoZSkge1xuICAgICAgZmlsZURyb3BBcmVhLmNsYXNzTGlzdC5hZGQoJ2hpZ2hsaWdodCcpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiB1bmhpZ2hsaWdodChlKSB7XG4gICAgICBmaWxlRHJvcEFyZWEuY2xhc3NMaXN0LnJlbW92ZSgnaGlnaGxpZ2h0Jyk7XG4gICAgfTtcblxuICAgIC8vXG5cbiAgICBmaWxlRHJvcEFyZWEuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIGhhbmRsZURyb3AsIGZhbHNlKVxuXG4gICAgZnVuY3Rpb24gaGFuZGxlRHJvcChlKSB7XG4gICAgICBsZXQgZHQgPSBlLmRhdGFUcmFuc2ZlclxuICAgICAgbGV0IGZpbGVzID0gZHQuZmlsZXNcblxuICAgICAgaWYgKGZpbGVJbnB1dC5maWxlcyAmJiBmaWxlSW5wdXQuZmlsZXNbMF0pIHtcbiAgICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG5cbiAgICAgICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGZpbGVJbnB1dC5maWxlcyA9IGZpbGVzO1xuICAgICAgb25GaWxlQ2hhbmdlKCk7XG4gICAgICB3aW5kb3cub25WZXJpZmljYXRpb25GaWxlRHJvcCAmJiB3aW5kb3cub25WZXJpZmljYXRpb25GaWxlRHJvcCgpO1xuICAgICAgd2luZG93Lm9uRGVsaXZlcnlGaWxlRHJvcCAmJiB3aW5kb3cub25EZWxpdmVyeUZpbGVEcm9wKCk7XG4gICAgICB3aW5kb3cub25JbnN0YWxsYXRpb25GaWxlRHJvcCAmJiB3aW5kb3cub25JbnN0YWxsYXRpb25GaWxlRHJvcCgpO1xuICAgIH07XG5cbiAgICBjb25zdCBvbkZpbGVDaGFuZ2UgPSAoKSA9PiB7XG4gICAgICByZWFkVXJsKGZpbGVJbnB1dCk7XG4gICAgfVxuXG4gICAgY29uc3QgcmVhZFVybCA9IChpbnB1dCkgPT4ge1xuICAgICAgaWYgKGlucHV0LmZpbGVzICYmIGlucHV0LmZpbGVzWzBdKSB7XG4gICAgICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuXG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoZSkge1xuICAgICAgICAgIGZpbGVEcm9wQXJlYS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2xvYWRlZCcpO1xuICAgICAgICAgIGZpbGVEcm9wQXJlYVxuICAgICAgICAgICAgLm5leHRFbGVtZW50U2libGluZ1xuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX25hbWUnKVxuICAgICAgICAgICAgLnRleHRDb250ZW50ID0gaW5wdXQuZmlsZXNbMF0ubmFtZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJlYWRlci5yZWFkQXNEYXRhVVJMKGlucHV0LmZpbGVzWzBdKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBvbkNsZWFyKCkge1xuICAgICAgZmlsZURyb3BBcmVhLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuXG4gICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBmaWxlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWxlQ2hhbmdlKTtcbiAgICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsZWFyKTtcbiAgfVxuXG4gIHdpbmRvdy5tYWtlRmlsZUxvYWQgPSBtYWtlRmlsZUxvYWQ7XG5cblxuICBpZiAoIWZpbGVEcm9wQXJlYVswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGZpbGVEcm9wQXJlYS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBtYWtlRmlsZUxvYWQoaXRlbSk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXRleHQnKTtcblxuICBpZiAoIWlucHV0c1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGlucHV0cy5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0KSB7XG4gICAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKFxuICAgICAgICBpbnB1dC52YWx1ZS5zcGxpdCgnICcpLmpvaW4oJycpID09PSAnJ1xuICAgICAgKSB7XG4gICAgICAgIGlucHV0LnZhbHVlID0gJyc7XG4gICAgICB9XG5cbiAgICAgIGlmIChcbiAgICAgICAgaW5wdXQudmFsdWUgIT09ICcnXG4gICAgICAgICYmICFpbnB1dC5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKVxuICAgICAgKSB7XG4gICAgICAgIGlucHV0LmNsYXNzTGlzdC5hZGQoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBpbnB1dC52YWx1ZSA9PT0gJydcbiAgICAgICAgJiYgaW5wdXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJylcbiAgICAgICkge1xuICAgICAgICBpbnB1dC5jbGFzc0xpc3QucmVtb3ZlKCdqcy1pbnB1dGVkJyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufSkoKTtcbiIsIigoKSA9PiB7XG4gIGxldCB2aCA9IHdpbmRvdy5pbm5lckhlaWdodCAqIDAuMDE7XG4gIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aCcsIGAke3ZofXB4YCk7XG5cbiAgY29uc3QgJGJvZHkgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCdib2R5Jyk7XG5cbiAgZnVuY3Rpb24gZGVib3VuY2UoZnVuYyl7XG4gICAgdmFyIHRpbWVyO1xuICAgIHJldHVybiBmdW5jdGlvbihldmVudCl7XG4gICAgICBpZih0aW1lcikgY2xlYXJUaW1lb3V0KHRpbWVyKTtcbiAgICAgIHRpbWVyID0gc2V0VGltZW91dChmdW5jLDEwMCxldmVudCk7XG4gICAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9uUmVzaXplKCkge1xuICAgICAgbGV0IHZoID0gd2luZG93LmlubmVySGVpZ2h0ICogMC4wMTtcbiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aCcsIGAke3ZofXB4YCk7XG4gIH07XG5cbiAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZScsIGRlYm91bmNlKG9uUmVzaXplKSk7XG5cbiAgZnVuY3Rpb24gTW9kYWwgKHRyaWdnZXIsIG1vZGFsKSB7XG4gICAgdGhpcy50cmlnZ2VyID0gdHJpZ2dlcjtcbiAgICB0aGlzLm1vZGFsID0gbW9kYWw7XG4gICAgdGhpcy5vdmVybGF5ID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgICB0aGlzLmNsb3NlQnRuID0gdGhpcy5tb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG5cbiAgICB0aGlzLm9uT3ZlcmxheUNsaWNrID0gdGhpcy5vbk92ZXJsYXlDbGljay5iaW5kKHRoaXMpO1xuICAgIHRoaXMub25DbG9zZUNsaWNrID0gdGhpcy5vbkNsb3NlQ2xpY2suYmluZCh0aGlzKTtcbiAgICB0aGlzLm9uVHJpZ2dlckNsaWNrID0gdGhpcy5vblRyaWdnZXJDbGljay5iaW5kKHRoaXMpO1xuICAgIC8vdGhpcy5vblJlc2l6ZSA9IHRoaXMub25SZXNpemUuYmluZCh0aGlzKTtcblxuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vcGVuID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5tb2RhbC5jbGFzc0xpc3QuYWRkKCdqcy1zaG93Jyk7XG4gICAgJGJvZHkuY2xhc3NMaXN0LmFkZCgnanNfX2JvZHktbm8tc2Nyb2xsJyk7XG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm1vZGFsLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLXNob3cnKTtcbiAgICAkYm9keS5jbGFzc0xpc3QucmVtb3ZlKCdqc19fYm9keS1uby1zY3JvbGwnKTtcbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQgPT09IHRoaXMub3ZlcmxheSkge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfVxuXG4gIE1vZGFsLnByb3RvdHlwZS5vbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLmNsb3NlKCk7XG4gIH1cblxuICBNb2RhbC5wcm90b3R5cGUub25UcmlnZ2VyQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm9wZW4oKTtcbiAgfVxuXG4gIC8vIE1vZGFsLnByb3RvdHlwZS5vblJlc2l6ZSA9IGZ1bmN0aW9uKCkge1xuICAvLyAgICAgbGV0IHZoID0gd2luZG93LmlubmVySGVpZ2h0ICogMC4wMTtcbiAgLy8gICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zdHlsZS5zZXRQcm9wZXJ0eSgnLS12aCcsIGAke3ZofXB4YCk7XG4gIC8vIH07XG5cbiAgTW9kYWwucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5vdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5vbk92ZXJsYXlDbGljayk7XG4gICAgdGhpcy5jbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHRoaXMub25DbG9zZUNsaWNrKTtcbiAgICB0aGlzLnRyaWdnZXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLm9uVHJpZ2dlckNsaWNrKTtcbiAgfVxuXG4gIHdpbmRvdy5Nb2RhbCA9IE1vZGFsO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgICAkKCcuaW5wdXQtbW9uZXknKS5tYXNrKCcjICMjMCDigr0nLCB7XG4gICAgICByZXZlcnNlOiB0cnVlLFxuICAgIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgaW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmlucHV0LXBob25lJyk7XG5cbiAgaWYgKCFpbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBpbSA9IG5ldyBJbnB1dG1hc2soXCIrNyg5OTkpIDk5OS05OS05OVwiKTtcblxuICBpbnB1dHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgaW0ubWFzayhpdGVtKTtcbiAgfSlcbn0pKCk7XG4iLCIoKCkgPT4ge1xuICBjb25zdCBpdGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zZWFyY2gnKTtcbiAgY29uc3QgY2xvc2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2VhcmNoICsgLnNlYXJjaC1jbG9zZScpO1xuXG4gIGlmICghaXRlbXNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBpdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdmb2N1cycsICgpID0+e1xuICAvLyAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnanMtZm9jdXMnKTtcbiAgLy8gICB9KTtcbiAgLy8gfSk7XG5cbiAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignYmx1cicsICgpID0+IHtcbiAgICAgIGlmIChcbiAgICAgICAgaXRlbS52YWx1ZS5zcGxpdCgnICcpLmpvaW4oJycpID09PSAnJ1xuICAgICAgKSB7XG4gICAgICAgIGl0ZW0udmFsdWUgPSAnJztcbiAgICAgIH1cblxuICAgICAgaWYgKFxuICAgICAgICBpdGVtLnZhbHVlICE9PSAnJ1xuICAgICAgICAmJiAhaXRlbS5jbGFzc0xpc3QuY29udGFpbnMoJ2pzLWlucHV0ZWQnKVxuICAgICAgKSB7XG4gICAgICAgIGl0ZW0uY2xhc3NMaXN0LmFkZCgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoXG4gICAgICAgIGl0ZW0udmFsdWUgPT09ICcnXG4gICAgICAgICYmIGl0ZW0uY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJylcbiAgICAgICkge1xuICAgICAgICBpdGVtLmNsYXNzTGlzdC5yZW1vdmUoJ2pzLWlucHV0ZWQnKTtcbiAgICAgIH1cbiAgICB9KVxuICB9KTtcblxuICBjbG9zZS5mb3JFYWNoKChpdGVtKSA9PiB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgIGNvbnN0IHNlYXJjaCA9IGl0ZW0ucHJldmlvdXNFbGVtZW50U2libGluZztcbiAgICAgIHNlYXJjaC52YWx1ZSA9ICcnO1xuICAgICAgaWYgKFxuICAgICAgICBzZWFyY2guY2xhc3NMaXN0LmNvbnRhaW5zKCdqcy1pbnB1dGVkJylcbiAgICAgICkge1xuICAgICAgICBzZWFyY2guY2xhc3NMaXN0LnJlbW92ZSgnanMtaW5wdXRlZCcpO1xuICAgICAgfVxuICAgIH0pXG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcblxuICBmdW5jdGlvbiBmb3JtYXRPcHRpb24gKGl0ZW0pIHtcbiAgICBjb25zdCB2YWx1ZSA9IGl0ZW0udGV4dC5zcGxpdCgnc3BsaXR0ZXInKTtcbiAgICBjb25zdCBiciA9IHdpbmRvdy5tYXRjaE1lZGlhKCcobWF4LXdpZHRoOiA5OTlweCknKS5tYXRjaGVzID8gJzxicj4nIDogJyc7XG5cbiAgICBpZiAodmFsdWUubGVuZ3RoID4gMSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gJCgnPHNwYW4+J1xuICAgICAgICArIHZhbHVlWzBdXG4gICAgICAgICsgJzwvc3Bhbj4nXG4gICAgICAgICsgYnJcbiAgICAgICAgKyAnPHNwYW4+J1xuICAgICAgICArIHZhbHVlWzFdXG4gICAgICAgICsgJzwvc3Bhbj4nKTtcbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiBpdGVtLnRleHQ7XG4gICAgfVxuICB9XG5cbiAgJCgnLnNlbGVjdCcpLnNlbGVjdDIoe1xuICAgIHRlbXBsYXRlUmVzdWx0OiBmb3JtYXRPcHRpb24sXG4gICAgdGVtcGxhdGVTZWxlY3Rpb246IGZvcm1hdE9wdGlvblxuICB9KTtcblxuICAkKCcuc2VsZWN0Jykub24oJ3NlbGVjdDI6c2VsZWN0JywgZnVuY3Rpb24gKGUpIHtcbiAgICAkKHRoaXMpLmFkZENsYXNzKCdwaWNrZWQnKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBkZWxpdmVyeVRpbWVJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbC10aW1lJyk7XG5cbiAgaWYgKCFkZWxpdmVyeVRpbWVJbnB1dHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICB2YXIgaW0gPSBuZXcgSW5wdXRtYXNrKFwiOTk6OTlcIik7XG5cbiAgZGVsaXZlcnlUaW1lSW5wdXRzLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGltLm1hc2soaXRlbSk7XG4gIH0pO1xuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBjb250cmFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYWdlbnRzX191c2Vycy1ibG9jay1tb2JpbGUnKTtcblxuICBpZiAoIWNvbnRyYWN0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHNsaWRlciA9IG5ldyBTd2lwZXIoJy5hZ2VudHNfX3VzZXJzLWJsb2NrLW1vYmlsZV9fc2xpZGVyJywge1xuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcuYWdlbnRzX191c2Vycy1ibG9jay1tb2JpbGVfX3BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0J1bGxldHM6IHRydWUsXG4gICAgfVxuICB9KTtcblxuXG4gICQoJy5hZ2VudHNfX3VzZXJzLWJ0bicpLnBhcmVudCgpLm5leHQoKS5zbGlkZVRvZ2dsZSgpO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJCgnLmFnZW50c19fdXNlcnMtYnRuJykuY2xpY2soZnVuY3Rpb24oKSB7XG4gICAgJCh0aGlzKS5wYXJlbnQoKS5uZXh0KCkuc2xpZGVUb2dnbGUoKTtcbiAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdvcGVuZWQnKTtcbiAgfSlcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNhbmNlbGxhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX19jYW5jZWxsYXRpb24nKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbmNlbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2FuY2VsbGF0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pO1xuXG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1jcmVhdGlvbl9fY2xpZW50LXR5cGUgIGlucHV0Jyk7XG5cbiAgaWYgKCFyYWRpb3NbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB3cmFwcGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNvbnRyYWN0LWNyZWF0aW9uX19kZXRhaWxzJyk7XG5cbiAgZnVuY3Rpb24gb25SYWRpb0NoYW5nZSgpIHtcbiAgICBpZiAocmFkaW9zWzBdLmNoZWNrZWQpIHtcbiAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZW50aXR5Jyk7XG4gICAgfVxuXG4gICAgaWYgKHJhZGlvc1sxXS5jaGVja2VkKSB7XG4gICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3Nob3ctZm9yLWVudGl0eScpO1xuICAgIH1cbiAgfVxuXG4gIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uUmFkaW9DaGFuZ2UpO1xuICB9KTtcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY29udHJhY3RzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmNsaWVudHMtbW9iaWxlLWJsb2NrJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzbGlkZXIgPSBuZXcgU3dpcGVyKCcuY2xpZW50cy1tb2JpbGUtYmxvY2tfX3NsaWRlcicsIHtcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgIHBhZ2luYXRpb246IHtcbiAgICAgIGVsOiAnLmNsaWVudHMtbW9iaWxlLWJsb2NrX19wYWdpbmF0aW9uJyxcbiAgICAgIGR5bmFtaWNCdWxsZXRzOiB0cnVlLFxuICAgIH1cbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gICQoJy5kZWxpdmVyeS1vci1waWNrdXAuZG9uZScpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQodGhpcykuZmluZCgnLmNvbnRyYWN0LWluZm9fX2RlbGl2ZXJlZC1hZHJlc3MnKS5zbGlkZVRvZ2dsZSgpO1xuICAgICQodGhpcykuZmluZCgnLmNvbnRyYWN0LWluZm9fX2RlbGl2ZXJlZC10b2dnbGUnKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY29udHJhY3RTZXJ2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cmFjdC1zZXJ2aWNlcycpO1xuXG4gIGlmICghY29udHJhY3RTZXJ2aWNlcykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LXNlcnZpY2VzX19saW5rJyk7XG5cbiAgY29uc3Qgb25MaW5rQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAoXG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2JveC1idG5fX2xhYmVsJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnZGVsaXZlci1vci1waWNrdXBfX2NvbmZpcm0tYnRuJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NvbnRyYWN0LXNlcnZpY2VzX19kZWxpdmVyeS1jb25maXJtJylcbiAgICApIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9XG4gIH1cblxuICBsaW5rcy5mb3JFYWNoKGZ1bmN0aW9uKGxpbmspIHtcbiAgICBsaW5rLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25MaW5rQ2xpY2spO1xuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNvbnRyYWN0c0xpbmtBbGwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3RzX19saW5rJyk7XG5cbiAgaWYgKCFjb250cmFjdHNMaW5rQWxsWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgb25MaW5rQ2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gICAgY29uc3QgdGFyZ2V0ID0gZS50YXJnZXQ7XG5cbiAgICBpZiAoXG4gICAgICB0YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2JveC1idG5fX2xhYmVsJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrYm94LWJ0bl9fY2hlY2tib3gnKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3QtaW5mb19fdmVyaWZpY2F0aW9uJylcbiAgICAgIHx8IHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ3BheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKVxuICAgICAgfHwgdGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnY29udHJhY3Qtc2VydmljZXNfX2RlbGl2ZXJ5LWNvbmZpcm0nKVxuICAgICkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnRyYWN0c0xpbmtBbGwuZm9yRWFjaChmdW5jdGlvbihsaW5rKSB7XG4gICAgbGluay5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uTGlua0NsaWNrKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBjb250cmFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29udHJhY3Qtc2VydmljZXMtbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzbGlkZXIgPSBuZXcgU3dpcGVyKCcuY29udHJhY3Qtc2VydmljZXMtbW9iaWxlX19zbGlkZXInLCB7XG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5jb250cmFjdC1zZXJ2aWNlcy1tb2JpbGVfX3BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0J1bGxldHM6IHRydWUsXG4gICAgfVxuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNvbnRyYWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5jb250cmFjdHMtbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzbGlkZXIgPSBuZXcgU3dpcGVyKCcuY29udHJhY3RzLW1vYmlsZV9fc2xpZGVyJywge1xuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcuY29udHJhY3RzLW1vYmlsZV9fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZSxcbiAgICB9XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY2FuY2VsbGF0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnN1YnNjcmlwdGlvbi1wYWdlX19hY3Rpb24taXRlbS0tZGVsZXRlJyk7XG5cbiAgaWYgKCFjYW5jZWxsYXRpb25CdG5bMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkZWxldGUtc2VydmljZV9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY2FuY2VsbGF0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIH0pXG5cbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGRlbGl2ZXJ5QnRucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5kZWxpdmVyLW9yLXBpY2t1cF9fY29uZmlybS1idG4nKTtcblxuICBpZiAoIWRlbGl2ZXJ5QnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcigpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihkYXRlVGV4dCkge1xuICAvLyAgIG9uRmllbGRDaGFuZ2UoKTtcbiAgLy8gfSk7XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgLy8gY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICAvLyBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cbiAgZGVsaXZlcnlCdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTtcblxuICAvLyBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAvLyAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgLy8gICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG5cbiAgLy8gICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gIC8vICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAvLyAgICAgfVxuICAvLyAgIH1cblxuICAvLyAgIGRhdGVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHRpbWVJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICAvLyB9XG5cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gY29uc3Qgb25GaWVsZENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoaXNGb3JtRmlsbGVkKCkgJiYgc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgLy8gICB9IGVsc2UgaWYgKCFpc0Zvcm1GaWxsZWQoKSAmJiAhc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAvLyAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gY29uc3QgaXNGb3JtRmlsbGVkID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgcmV0dXJuICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcignZ2V0RGF0ZScpXG4gIC8vICAgICAmJiB0aW1lSW5wdXQudmFsdWUgIT09ICcnXG4gIC8vICAgICAmJiBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9PT0gdHJ1ZVxuICAvLyAgICAgJiYgZmlsZUlucHV0LnZhbHVlICE9PSAnJ1xuICAvLyB9XG5cbiAgLy8gY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICAvLyBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAvLyBkYXRlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gdGltZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIC8vIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy8gY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgZGV2aWNlcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1jcmVhdGlvbl9fZGVsaXZlcnktZGV2aWNlJyk7XG5cbiAgaWYgKCFkZXZpY2VzWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgZGV2aWNlcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICBjb25zdCByYWRpb3MgPSBpdGVtLnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1jcmVhdGlvbl9fZGVsaXZlcnktdHlwZS13cmFwcGVyICBpbnB1dCcpO1xuXG4gICAgZnVuY3Rpb24gb25SYWRpb0NoYW5nZShlKSB7XG4gICAgICBjb25zdCB3cmFwcGVyID0gZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG5cbiAgICAgIGlmIChyYWRpb3NbMF0uY2hlY2tlZCkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXBpY2t1cCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAocmFkaW9zWzFdLmNoZWNrZWQpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QuYWRkKCdzaG93LWZvci1waWNrdXAnKTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICByYWRpb3MuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uUmFkaW9DaGFuZ2UpO1xuICAgIH0pO1xuICB9KVxuXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgJGRhdGUgPSAkKCcjZGVsaXZlcnktb3ItcGlja3VwX19tb2RhbCAuZGF0ZS1pbnB1dCcpO1xuXG4gICRkYXRlLmRhdGVwaWNrZXIoKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZGF0ZVRleHQpIHtcbiAgICBpZiAoJCgnI2RlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwnKS5oYXNDbGFzcygnanMtc2hvdycpKSB7XG4gICAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIGNvbnN0IGZpbGVDbGVhciA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG4gIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cbiAgY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuXG4gICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuXG4gICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICcnO1xuICAgICAgICBmaWxlSW5wdXQudHlwZSA9ICdmaWxlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICBkYXRlSW5wdXQudmFsdWUgPSAnJztcbiAgICB0aW1lSW5wdXQudmFsdWUgPSAnJztcbiAgICBjb25maXJtQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAgICRkYXRlLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIH1cblxuICBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChpc0Zvcm1GaWxsZWQoKSAmJiBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAgIH0gZWxzZSBpZiAoIWlzRm9ybUZpbGxlZCgpICYmICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbkZpbGVDbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3QgaXNGb3JtRmlsbGVkID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICRkYXRlLmRhdGVwaWNrZXIoJ2dldERhdGUnKVxuICAgICAgJiYgdGltZUlucHV0LnZhbHVlICE9PSAnJ1xuICAgICAgJiYgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPT09IHRydWVcbiAgICAgICYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgfVxuXG4gIHdpbmRvdy5vbkRlbGl2ZXJ5RmlsZURyb3AgPSBmdW5jdGlvbiAoKSB7XG4gICAgb25GaWVsZENoYW5nZSgpO1xuICB9XG5cbiAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICBkYXRlSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgdGltZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCB3aW5kb3cub25EZWxpdmVyeUZpbGVEcm9wKTtcbiAgY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBtZW51ID0gJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudScpO1xuICBjb25zdCBidG4gPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKTtcblxuICAgICQuZXh0ZW5kKCQuZGF0ZXBpY2tlciwge1xuXG4gICAgICAgIC8vIFJlZmVyZW5jZSB0aGUgb3JpZ25hbCBmdW5jdGlvbiBzbyB3ZSBjYW4gb3ZlcnJpZGUgaXQgYW5kIGNhbGwgaXQgbGF0ZXJcbiAgICAgICAgX2lubGluZURhdGVwaWNrZXIyOiAkLmRhdGVwaWNrZXIuX2lubGluZURhdGVwaWNrZXIsXG5cbiAgICAgICAgLy8gT3ZlcnJpZGUgdGhlIF9pbmxpbmVEYXRlcGlja2VyIG1ldGhvZFxuICAgICAgICBfaW5saW5lRGF0ZXBpY2tlcjogZnVuY3Rpb24gKHRhcmdldCwgaW5zdCkge1xuXG4gICAgICAgICAgICAvLyBDYWxsIHRoZSBvcmlnaW5hbFxuICAgICAgICAgICAgdGhpcy5faW5saW5lRGF0ZXBpY2tlcjIodGFyZ2V0LCBpbnN0KTtcblxuICAgICAgICAgICAgdmFyIGJlZm9yZVNob3cgPSAkLmRhdGVwaWNrZXIuX2dldChpbnN0LCAnYmVmb3JlU2hvdycpO1xuXG4gICAgICAgICAgICBpZiAoYmVmb3JlU2hvdykge1xuICAgICAgICAgICAgICAgIGJlZm9yZVNob3cuYXBwbHkodGFyZ2V0LCBbdGFyZ2V0LCBpbnN0XSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9KTtcblxuXG4gICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLW1lbnUnKS50b2dnbGUoKTtcbiAgfSk7XG5cbiAgJCgnLmRhdGUtaW5wdXQtcGVyaW9kJykuZGF0ZXBpY2tlcih7XG4gICAgcmFuZ2U6ICdwZXJpb2QnLFxuICAgIGlubGluZTogdHJ1ZSxcbiAgICBzaG93QnV0dG9uUGFuZWw6IHRydWUsXG4gICAgc2hvd090aGVyTW9udGhzOiB0cnVlLFxuICAgIHNlbGVjdE90aGVyTW9udGhzOiB0cnVlLFxuICAgIGNsb3NlVGV4dCA6IFwi0JPQvtGC0L7QstC+XCIsXG5cbiAgICBiZWZvcmVTaG93OiBmdW5jdGlvbihpbnB1dCwgaW5zdCkge1xuICAgICAgaW5zdC5kcERpdi5jc3MoJ3RyYW5zZm9ybScsICd0cmFuc2xhdGVYKC0yNHB4KScpO1xuICAgICAgaW5zdC5kcERpdi5hZGRDbGFzcygnY2FsZW5kYXItcmFuZ2UnKTtcbiAgICB9LFxuXG4gICAgb25TZWxlY3Q6IGZ1bmN0aW9uKGRhdGVUZXh0LCBpbnN0LCBleHRlbnNpb25SYW5nZSkge1xuICAgICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJykudGV4dChleHRlbnNpb25SYW5nZS5zdGFydERhdGVUZXh0ICsgJyAtICcgKyBleHRlbnNpb25SYW5nZS5lbmREYXRlVGV4dCk7XG5cbiAgICB9XG4gIH0pO1xuXG4gICQoZG9jdW1lbnQpLm1vdXNldXAoZnVuY3Rpb24gKGUpe1xuXHRcdGNvbnN0IG1lbnUgPSAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51Jyk7XG5cdFx0Y29uc3QgYnRuID0gJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtYnRuJyk7XG4gICAgaWYgKCFtZW51LmlzKGUudGFyZ2V0KVxuICAgICAgJiYgbWVudS5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMFxuICAgICAgJiYgIWJ0bi5pcyhlLnRhcmdldClcbiAgICAgICYmIGJ0bi5oYXMoZS50YXJnZXQpLmxlbmd0aCA9PT0gMFxuICAgICkge1xuXHRcdFx0bWVudS5oaWRlKCk7XG5cdFx0fVxuICB9KTtcblxuICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1tZW51LWJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uKCkge1xuICAgIGlmICgkKHRoaXMpLmhhc0NsYXNzKCdhbGwtdGltZScpKSB7XG4gICAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KFxuICAgICAgICAkKHRoaXMpLnRleHQoKVxuICAgICAgICArICcgKNGBXFx1MDBhMCdcbiAgICAgICAgKyAkKCcuZWFybmVkLWRhdGVfX3N0YXJ0LXBlcmlvZCcpLnRleHQoKVxuICAgICAgICArICcpJ1xuICAgICAgKVxuICAgIH0gZWxzZSB7XG4gICAgICAkKCcubXV0dWFsLWNhbGNzX19lYXJuZWQtZGF0ZS1idG4nKS50ZXh0KFxuICAgICAgICAkKHRoaXMpLnRleHQoKVxuICAgICAgKVxuICAgIH1cblxuICAgIG1lbnUuaGlkZSgpO1xuXG4gIH0pO1xuXG4gICQoJy5tdXR1YWwtY2FsY3NfX2Vhcm5lZC1kYXRlLWJ0bicpLnRleHQoXG4gICAgJCgnLm11dHVhbC1jYWxjc19fZWFybmVkLWRhdGUtbWVudS1idG4uYWxsLXRpbWUnKS50ZXh0KClcbiAgICArICcgKNGBXFx1MDBhMCdcbiAgICArICQoJy5lYXJuZWQtZGF0ZV9fc3RhcnQtcGVyaW9kJykudGV4dCgpXG4gICAgKyAnKSdcbiAgKVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgJCgnLmZpbHRlcnNfX2J0bicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQodGhpcykucGFyZW50KCkubmV4dCgpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcblxuICBpZiAoIWRlbGl2ZXJ5QnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vICQoJyNkZWxpdmVyeS1kYXRlJykuZGF0ZXBpY2tlcigpLm9uKCdjaGFuZ2UnLCBmdW5jdGlvbihkYXRlVGV4dCkge1xuICAvLyAgIG9uRmllbGRDaGFuZ2UoKTtcbiAgLy8gfSk7XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaW5zdGFsbGF0aW9uX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICAvLyBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgLy8gY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgLy8gY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICAvLyBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cbiAgZGVsaXZlcnlCdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICB9KTtcblxuICAvL2NvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIGlmIChmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2xvYWRlZCcpKSB7XG4gICAgLy8gICBmaWxlSW5wdXRCbG9jay5jbGFzc0xpc3QucmVtb3ZlKCdsb2FkZWQnKTtcblxuICAgIC8vICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgLy8gICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAgIC8vICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgICAvLyAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgLy8gICB9XG4gICAgLy8gfVxuXG4gIC8vICAgZGF0ZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgdGltZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgY29uZmlybUNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAkKCcjZGVsaXZlcnktZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gIC8vICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBvbkZpZWxkQ2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChpc0Zvcm1GaWxsZWQoKSAmJiBzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gIC8vICAgICBzdWJtaXQucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH0gZWxzZSBpZiAoIWlzRm9ybUZpbGxlZCgpICYmICFzdWJtaXQuaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gIC8vICAgICBzdWJtaXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBjb25zdCBpc0Zvcm1GaWxsZWQgPSBmdW5jdGlvbigpIHtcbiAgLy8gICByZXR1cm4gJCgnI2RlbGl2ZXJ5LWRhdGUnKS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgLy8gICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gIC8vICAgICAvLyYmIGZpbGVJbnB1dC52YWx1ZSAhPT0gJydcbiAgLy8gfVxuXG4gIC8vIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgLy8gb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgLy8gZGF0ZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2lucHV0Jywgb25GaWVsZENoYW5nZSk7XG4gIC8vIHRpbWVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICAvL2ZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgLy9jb25maXJtQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25GaWVsZENoYW5nZSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCByYWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuZGVsaXZlcnktb3ItcGlja3VwX19pbnN0YWxsYXRpb24tY2hvb3NlLWJsb2NrICBpbnB1dCcpO1xuXG4gIGlmICghcmFkaW9zWzBdKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgd3JhcHBlciA9IHJhZGlvc1swXS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuXG4gIGZ1bmN0aW9uIG9uUmFkaW9DaGFuZ2UoKSB7XG4gICAgY29uc29sZS5sb2cod3JhcHBlcik7XG4gICAgaWYgKHJhZGlvc1swXS5jaGVja2VkKSB7XG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1tYW51YWwnKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLW1hbnVhbCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpO1xuICAgICAgfVxuXG4gICAgICBpZiAoICF3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItZGVsaXZlcnknKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5hZGQoJ3Nob3ctZm9yLWRlbGl2ZXJ5Jyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJhZGlvc1sxXS5jaGVja2VkKSB7XG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1tYW51YWwnKSkge1xuICAgICAgICB3cmFwcGVyLmNsYXNzTGlzdC5yZW1vdmUoJ3Nob3ctZm9yLW1hbnVhbCcpO1xuICAgICAgfVxuXG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCAhd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLXJlZ2lzdHJhdGlvbicpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJyk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHJhZGlvc1syXS5jaGVja2VkKSB7XG4gICAgICBpZiAoIHdyYXBwZXIuY2xhc3NMaXN0LmNvbnRhaW5zKCdzaG93LWZvci1kZWxpdmVyeScpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LnJlbW92ZSgnc2hvdy1mb3ItZGVsaXZlcnknKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCB3cmFwcGVyLmNsYXNzTGlzdC5jb250YWlucygnc2hvdy1mb3ItcmVnaXN0cmF0aW9uJykpIHtcbiAgICAgICAgd3JhcHBlci5jbGFzc0xpc3QucmVtb3ZlKCdzaG93LWZvci1yZWdpc3RyYXRpb24nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKCAhd3JhcHBlci5jbGFzc0xpc3QuY29udGFpbnMoJ3Nob3ctZm9yLW1hbnVhbCcpKSB7XG4gICAgICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc2hvdy1mb3ItbWFudWFsJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmFkaW9zLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25SYWRpb0NoYW5nZSk7XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgLy8gY29uc3QgZGVsaXZlcnlCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmluc3RhbGxhdGlvbl9fY29uZmlybS1idG4nKTtcblxuICAvLyBpZiAoIWRlbGl2ZXJ5QnRuc1swXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2luc3RhbGxhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgJGRhdGUgPSAkKCcjaW5zdGFsbGF0aW9uX19tb2RhbCAuZGF0ZS1pbnB1dCcpO1xuXG4gICRkYXRlLmRhdGVwaWNrZXIoKS5vbignY2hhbmdlJywgZnVuY3Rpb24oZGF0ZVRleHQpIHtcbiAgICBpZiAoJCgnI2luc3RhbGxhdGlvbl9fbW9kYWwnKS5oYXNDbGFzcygnanMtc2hvdycpKSB7XG4gICAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gICAgfVxuICB9KTtcblxuICBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICBjb25zdCBzdWJtaXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX3N1Ym1pdCcpO1xuICBjb25zdCBmaWxlSW5wdXRCbG9jayA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWlucHV0LWZpbGUnKTtcbiAgY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIGNvbnN0IGZpbGVDbGVhciA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5maWxlLWxvYWRfX2NsZWFyJyk7XG4gIGNvbnN0IGRhdGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5kZWxpdmVyeS1vci1waWNrdXBfX21vZGFsLWRhdGUnKTtcbiAgY29uc3QgdGltZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmRlbGl2ZXJ5LW9yLXBpY2t1cF9fbW9kYWwtdGltZScpO1xuICBjb25zdCBjb25maXJtQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcuY2hlY2tib3hfX2lucHV0Jyk7XG5cbiAgLy8gZGVsaXZlcnlCdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gIC8vICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICAvLyB9KTtcblxuICBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LmNvbnRhaW5zKCdsb2FkZWQnKSkge1xuICAgICAgZmlsZUlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgICAgIGZpbGVJbnB1dC52YWx1ZSA9ICcnO1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG5cbiAgICAgIGlmKCEvc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSl7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgIGZpbGVJbnB1dC50eXBlID0gJ2ZpbGUnO1xuICAgICAgfVxuICAgIH1cblxuICAgIGRhdGVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHRpbWVJbnB1dC52YWx1ZSA9ICcnO1xuICAgIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG4gICAgJGRhdGUuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgfVxuXG4gIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgICAgIG9uQ2xvc2VDbGljaygpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG9uRmllbGRDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gICAgaWYgKGlzRm9ybUZpbGxlZCgpICYmIHN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgfSBlbHNlIGlmICghaXNGb3JtRmlsbGVkKCkgJiYgIXN1Ym1pdC5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHN1Ym1pdC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IGlzRm9ybUZpbGxlZCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkZGF0ZS5kYXRlcGlja2VyKCdnZXREYXRlJylcbiAgICAgICYmIHRpbWVJbnB1dC52YWx1ZSAhPT0gJydcbiAgICAgICYmIGNvbmZpcm1DaGVja2JveC5jaGVja2VkID09PSB0cnVlXG4gICAgICAmJiBmaWxlSW5wdXQudmFsdWUgIT09ICcnXG4gIH1cblxuICBjb25zdCBvbkZpbGVDbGVhciA9IGZ1bmN0aW9uKCkge1xuICAgIGlmICghc3VibWl0Lmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgfVxuICB9XG5cbiAgd2luZG93Lm9uSW5zdGFsbGF0aW9uRmlsZURyb3AgPSBmdW5jdGlvbigpIHtcbiAgICBvbkZpZWxkQ2hhbmdlKCk7XG4gIH1cblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIGRhdGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdpbnB1dCcsIG9uRmllbGRDaGFuZ2UpO1xuICB0aW1lSW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbkZpZWxkQ2hhbmdlKTtcbiAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5vbkluc3RhbGxhdGlvbkZpbGVEcm9wKTtcbiAgY29uZmlybUNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uRmllbGRDaGFuZ2UpO1xuICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBwYXltZW50Q29uZmlybUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubXV0dWFsLWNhbGNzX19tYWtlLXBheW1lbnQnKTtcblxuICBpZiAoIXBheW1lbnRDb25maXJtQnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BheW1lbnQtd2FpdGluZ19fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gY29uc3QgY2xvc2UgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX2Nsb3NlJyk7XG4gIC8vIGNvbnN0IG92ZXJsYXkgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcubW9kYWxfX292ZXJsYXknKTtcbiAgLy8gY29uc3QgbWFpbkNoZWNrYm94ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnRyYW5zYWN0aW9uc19fY2hlY2stYWxsIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHNlbmRlcklucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc2VuZGVyIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHJlY2lwaWVudElucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcmVjaXBpZW50IGlucHV0Jyk7XG4gIC8vIGNvbnN0IHN1bUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtc3VtIGlucHV0Jyk7XG4gIC8vIGNvbnN0IHB1cnBvc2VJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5wYXltZW50LXdhaXRpbmdfX21vZGFsLXB1cnBvc2UgaW5wdXQnKTtcblxuICAvLyBjb25zdCBnZXRBbGxDaGVja2JveCA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIHJldHVybiBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcudHJhbnNhY3Rpb25zX19jaGVjayBpbnB1dCcpO1xuICAvLyB9O1xuXG4gIC8vIGNvbnN0IG9uQWxsQ2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICAgIGNvbnN0IHJvdyA9IGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZTtcbiAgLy8gICAgIGlmIChtYWluQ2hlY2tib3guY2hlY2tlZCkge1xuICAvLyAgICAgICBpdGVtLmNoZWNrZWQgPSB0cnVlO1xuICAvLyAgICAgICBpZiAoIXJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAvLyAgICAgICAgIHJvdy5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH0gZWxzZSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgICAgICBpZiAocm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfVxuICAvLyAgIH0pXG4gIC8vIH07XG5cbiAgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgbWFpbkNoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgIH0pO1xuICAvLyAgICQoJyNwYXltZW50LWRhdGUnKS5kYXRlcGlja2VyKCdzZXREYXRlJywgJycpO1xuICAvLyAgIHNlbmRlcklucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgcmVjaXBpZW50SW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICBzdW1JbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHB1cnBvc2VJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyB9O1xuXG4gIC8vIGNvbnN0IG9uT3ZlcmxheUNsaWNrID0gZnVuY3Rpb24oZSkge1xuICAvLyAgIGlmIChlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoJ21vZGFsX19vdmVybGF5JykpIHtcbiAgLy8gICAgIG9uQ2xvc2VDbGljaygpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIC8vIGNvbnN0IG9uQ2hlY2tib3hDaGFuZ2UgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNoZWNrZWQpIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAvLyAgIH0gZWxzZSB7XG4gIC8vICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5yZW1vdmUoJ2NoZWNrZWQnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICBwYXltZW50Q29uZmlybUJ0bnMuZm9yRWFjaChmdW5jdGlvbihidG4pIHtcbiAgICBuZXcgTW9kYWwoYnRuLCBtb2RhbCk7XG4gIH0pO1xuXG4gIC8vIGNsb3NlLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25DbG9zZUNsaWNrKTtcbiAgLy8gb3ZlcmxheS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uT3ZlcmxheUNsaWNrKTtcbiAgLy8gbWFpbkNoZWNrYm94LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQWxsQ2hhbmdlKTtcbiAgLy8gZ2V0QWxsQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIG9uQ2hlY2tib3hDaGFuZ2UpO1xuICAvLyB9KVxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgbWVudUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX25hdi1idG4nKTtcblxuICBpZiAoIW1lbnVCdG4pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBjbG9zZUJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5oZWFkZXJfX2Nsb3NlLWJ0bicpO1xuICBjb25zdCBuYXYgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuaGVhZGVyX19uYXYnKTtcblxuICBjb25zdCBjaGVja0lmVGFibGV0ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHdpbmRvdy5tYXRjaE1lZGlhKCcobWF4LXdpZHRoOiAxNDM5cHgpJykubWF0Y2hlc1xuICB9O1xuXG4gIGxldCBpc1RhYmxldCA9IGNoZWNrSWZUYWJsZXQoKTtcblxuICBjb25zdCBvbkJ0bkNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKGNoZWNrSWZUYWJsZXQoKSkge1xuICAgICAgbWVudUJ0bi5jbGFzc0xpc3QudG9nZ2xlKCdqcy1vcGVuZWQnKTtcbiAgICAgIG5hdi5jbGFzc0xpc3QudG9nZ2xlKCdqcy1zaG93Jyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgbmF2LmNsYXNzTGlzdC5yZW1vdmUoJ2pzLXNob3cnKTtcbiAgICBtZW51QnRuLmNsYXNzTGlzdC50b2dnbGUoJ2pzLW9wZW5lZCcpO1xuICB9XG5cbiAgbWVudUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQnRuQ2xpY2spO1xuICBjbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBjb250cmFjdHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubXV0dWFsLWNhbGNzLXBheW1lbnQtbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzbGlkZXIgPSBuZXcgU3dpcGVyKCcubXV0dWFsLWNhbGNzLXBheW1lbnQtbW9iaWxlX19zbGlkZXInLCB7XG4gICAgc2xpZGVzUGVyVmlldzogMSxcbiAgICBwYWdpbmF0aW9uOiB7XG4gICAgICBlbDogJy5tdXR1YWwtY2FsY3MtcGF5bWVudC1tb2JpbGVfX3BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0J1bGxldHM6IHRydWUsXG4gICAgfVxuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IGNvbnRyYWN0cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tdXR1YWwtY2FsY3MtYmxvY2stbW9iaWxlJyk7XG5cbiAgaWYgKCFjb250cmFjdHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBzbGlkZXIgPSBuZXcgU3dpcGVyKCcubXV0dWFsLWNhbGNzLWJsb2NrLW1vYmlsZV9fc2xpZGVyJywge1xuICAgIHNsaWRlc1BlclZpZXc6IDEsXG4gICAgcGFnaW5hdGlvbjoge1xuICAgICAgZWw6ICcubXV0dWFsLWNhbGNzLWJsb2NrLW1vYmlsZV9fcGFnaW5hdGlvbicsXG4gICAgICBkeW5hbWljQnVsbGV0czogdHJ1ZSxcbiAgICB9XG4gIH0pO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgcGF5bWVudENvbmZpcm1CdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBheW1lbnQtd2FpdGluZ19fY29uZmlybS1idG4nKTtcblxuICBpZiAoIXBheW1lbnRDb25maXJtQnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoKTtcblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50LXdhaXRpbmdfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuICAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBtYWluQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNhY3Rpb25zX19jaGVjay1hbGwgaW5wdXQnKTtcbiAgLy8gY29uc3Qgc2VuZGVySW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zZW5kZXIgaW5wdXQnKTtcbiAgLy8gY29uc3QgcmVjaXBpZW50SW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1yZWNpcGllbnQgaW5wdXQnKTtcbiAgLy8gY29uc3Qgc3VtSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zdW0gaW5wdXQnKTtcbiAgLy8gY29uc3QgcHVycG9zZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcHVycG9zZSBpbnB1dCcpO1xuXG4gIC8vIGNvbnN0IGdldEFsbENoZWNrYm94ID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX2NoZWNrIGlucHV0Jyk7XG4gIC8vIH07XG5cbiAgLy8gY29uc3Qgb25BbGxDaGFuZ2UgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgICAgY29uc3Qgcm93ID0gaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlO1xuICAvLyAgICAgaWYgKG1haW5DaGVja2JveC5jaGVja2VkKSB7XG4gIC8vICAgICAgIGl0ZW0uY2hlY2tlZCA9IHRydWU7XG4gIC8vICAgICAgIGlmICghcm93LmNsYXNzTGlzdC5jb250YWlucygnY2hlY2tlZCcpKSB7XG4gIC8vICAgICAgICAgcm93LmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgLy8gICAgICAgfVxuICAvLyAgICAgfSBlbHNlIHtcbiAgLy8gICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gIC8vICAgICAgIGlmIChyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgLy8gICAgICAgICByb3cuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgICAgICB9XG4gIC8vICAgICB9XG4gIC8vICAgfSlcbiAgLy8gfTtcblxuICAvLyBjb25zdCBvbkNsb3NlQ2xpY2sgPSBmdW5jdGlvbigpIHtcbiAgLy8gICBtYWluQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuICAvLyAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gIC8vICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgLy8gICAgIGl0ZW0ucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gIC8vICAgfSk7XG4gIC8vICAgJCgnI3BheW1lbnQtZGF0ZScpLmRhdGVwaWNrZXIoJ3NldERhdGUnLCAnJyk7XG4gIC8vICAgc2VuZGVySW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICByZWNpcGllbnRJbnB1dC52YWx1ZSA9ICcnO1xuICAvLyAgIHN1bUlucHV0LnZhbHVlID0gJyc7XG4gIC8vICAgcHVycG9zZUlucHV0LnZhbHVlID0gJyc7XG4gIC8vIH07XG5cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gY29uc3Qgb25DaGVja2JveENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgLy8gICBpZiAoZS50YXJnZXQuY2hlY2tlZCkge1xuICAvLyAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QuYWRkKCdjaGVja2VkJyk7XG4gIC8vICAgfSBlbHNlIHtcbiAgLy8gICAgIGUudGFyZ2V0LnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIHBheW1lbnRDb25maXJtQnRucy5mb3JFYWNoKGZ1bmN0aW9uKGJ0bikge1xuICAgIG5ldyBNb2RhbChidG4sIG1vZGFsKTtcbiAgfSk7XG5cbiAgLy8gY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICAvLyBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xuICAvLyBtYWluQ2hlY2tib3guYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25BbGxDaGFuZ2UpO1xuICAvLyBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25DaGVja2JveENoYW5nZSk7XG4gIC8vIH0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAvLyBjb25zdCBwYXltZW50Q29uZmlybUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucGF5bWVudC13YWl0aW5nX19jb25maXJtLWJ0bicpO1xuXG4gIC8vIGlmICghcGF5bWVudENvbmZpcm1CdG5zWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncGF5bWVudC13YWl0aW5nX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICBjb25zdCBtYWluQ2hlY2tib3ggPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudHJhbnNhY3Rpb25zX19jaGVjay1hbGwgaW5wdXQnKTtcbiAgY29uc3Qgc2VuZGVySW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zZW5kZXIgaW5wdXQnKTtcbiAgY29uc3QgcmVjaXBpZW50SW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1yZWNpcGllbnQgaW5wdXQnKTtcbiAgY29uc3Qgc3VtSW5wdXQgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcucGF5bWVudC13YWl0aW5nX19tb2RhbC1zdW0gaW5wdXQnKTtcbiAgY29uc3QgcHVycG9zZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLnBheW1lbnQtd2FpdGluZ19fbW9kYWwtcHVycG9zZSBpbnB1dCcpO1xuXG4gIGNvbnN0IGdldEFsbENoZWNrYm94ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG1vZGFsLnF1ZXJ5U2VsZWN0b3JBbGwoJy50cmFuc2FjdGlvbnNfX2NoZWNrIGlucHV0Jyk7XG4gIH07XG5cbiAgY29uc3QgZ2V0QWxsTW9iaWxlQ2hlY2tib3ggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gbW9kYWwucXVlcnlTZWxlY3RvckFsbCgnLnRyYW5zYWN0aW9uc19fbW9iaWxlLWNoZWNrIGlucHV0Jyk7XG4gIH1cblxuICBjb25zdCBvbkFsbENoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAgIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgICBjb25zdCByb3cgPSBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gICAgICBpZiAobWFpbkNoZWNrYm94LmNoZWNrZWQpIHtcbiAgICAgICAgaXRlbS5jaGVja2VkID0gdHJ1ZTtcbiAgICAgICAgaWYgKCFyb3cuY2xhc3NMaXN0LmNvbnRhaW5zKCdjaGVja2VkJykpIHtcbiAgICAgICAgICByb3cuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcbiAgICAgICAgaWYgKHJvdy5jbGFzc0xpc3QuY29udGFpbnMoJ2NoZWNrZWQnKSkge1xuICAgICAgICAgIHJvdy5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9O1xuXG4gIGNvbnN0IG9uQ2xvc2VDbGljayA9IGZ1bmN0aW9uKCkge1xuICAgIG1haW5DaGVja2JveC5jaGVja2VkID0gZmFsc2U7XG5cbiAgICBnZXRBbGxDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgICAgaXRlbS5jaGVja2VkID0gZmFsc2U7XG4gICAgICBpdGVtLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LnJlbW92ZSgnY2hlY2tlZCcpO1xuICAgIH0pO1xuXG4gICAgZ2V0QWxsTW9iaWxlQ2hlY2tib3goKS5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuICAgICAgaXRlbS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfSk7XG5cbiAgICAkKCcjcGF5bWVudC1kYXRlJykuZGF0ZXBpY2tlcignc2V0RGF0ZScsICcnKTtcbiAgICBzZW5kZXJJbnB1dC52YWx1ZSA9ICcnO1xuICAgIHJlY2lwaWVudElucHV0LnZhbHVlID0gJyc7XG4gICAgc3VtSW5wdXQudmFsdWUgPSAnJztcbiAgICBwdXJwb3NlSW5wdXQudmFsdWUgPSAnJztcbiAgfTtcblxuICBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbkNoZWNrYm94Q2hhbmdlID0gZnVuY3Rpb24oZSkge1xuICAgIGlmIChlLnRhcmdldC5jaGVja2VkKSB7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5wYXJlbnROb2RlLmNsYXNzTGlzdC5hZGQoJ2NoZWNrZWQnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgb25Nb2JpbGVDaGVja2JveENoYW5nZSA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2hlY2tlZCkge1xuICAgICAgZS50YXJnZXQucGFyZW50Tm9kZS5wYXJlbnROb2RlLnBhcmVudE5vZGUuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBlLnRhcmdldC5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZS5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgfVxuICB9XG5cbiAgLy8gcGF5bWVudENvbmZpcm1CdG5zLmZvckVhY2goZnVuY3Rpb24oYnRuKSB7XG4gIC8vICAgbmV3IE1vZGFsKGJ0biwgbW9kYWwpO1xuICAvLyB9KTtcblxuICBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIG1haW5DaGVja2JveC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkFsbENoYW5nZSk7XG4gIGdldEFsbENoZWNrYm94KCkuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbkNoZWNrYm94Q2hhbmdlKTtcbiAgfSlcblxuICBnZXRBbGxNb2JpbGVDaGVja2JveCgpLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAgIGl0ZW0uYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgb25Nb2JpbGVDaGVja2JveENoYW5nZSk7XG4gIH0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCBwYXltZW50cyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5tdXR1YWwtY2FsY3MtcGF5bWVudC1ibG9ja19fbGluaycpO1xuXG4gIGlmICghcGF5bWVudHNbMF0pIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdwYXltZW50LWluZm9fX21vZGFsJyk7XG5cbiAgcGF5bWVudHMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSlcblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3Qgc2NoZWR1bGVCdG5zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWRldmljZV9fc2NoZWR1bGUnKTtcblxuICBpZiAoIXNjaGVkdWxlQnRuc1swXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NjaGVkdWxlX19tb2RhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBjb25zdCByYWRpb3MgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2NoZWR1bGVfX21vZGFsLXRvZ2dsZSBpbnB1dCcpO1xuICAvLyBjb25zdCB0b2dnbGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc2NoZWR1bGVfX21vZGFsLXRvZ2dsZScpO1xuXG4gIC8vIHJhZGlvcy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0sIGlkKSB7XG4gIC8vICAgaXRlbS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBmdW5jdGlvbigpIHtcbiAgLy8gICAgIGlmIChpZCA9PT0gMCkge1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnc2Vjb25kLXRhYicpO1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LmFkZCgnZmlyc3QtdGFiJyk7XG4gIC8vICAgICB9XG5cbiAgLy8gICAgIGlmIChpZCA9PT0gMSkge1xuICAvLyAgICAgICB0b2dnbGUuY2xhc3NMaXN0LnJlbW92ZSgnZmlyc3QtdGFiJyk7XG4gIC8vICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdzZWNvbmQtdGFiJyk7XG4gIC8vICAgICB9XG4gIC8vICAgfSlcbiAgLy8gfSlcblxuICBzY2hlZHVsZUJ0bnMuZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICAvLyBjb25zdCBzY2hlZHVsZUJ0bnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuY29udHJhY3QtZGV2aWNlX19zY2hlZHVsZScpO1xuXG4gIC8vIGlmICghc2NoZWR1bGVCdG5zWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2NoZWR1bGVfX21vZGFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IHJhZGlvcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5zY2hlZHVsZV9fbW9kYWwtdG9nZ2xlIGlucHV0Jyk7XG4gIGNvbnN0IHRvZ2dsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zY2hlZHVsZV9fbW9kYWwtdG9nZ2xlJyk7XG5cbiAgcmFkaW9zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaWQpIHtcbiAgICBpdGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgICAgaWYgKGlkID09PSAwKSB7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdzZWNvbmQtdGFiJyk7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QuYWRkKCdmaXJzdC10YWInKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGlkID09PSAxKSB7XG4gICAgICAgIHRvZ2dsZS5jbGFzc0xpc3QucmVtb3ZlKCdmaXJzdC10YWInKTtcbiAgICAgICAgdG9nZ2xlLmNsYXNzTGlzdC5hZGQoJ3NlY29uZC10YWInKTtcbiAgICAgIH1cbiAgICB9KVxuICB9KVxuXG4gIC8vIHNjaGVkdWxlQnRucy5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICAvLyB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24gKCkge1xuICBjb25zdCBtYWluUGFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYWluLXBhZ2UnKTtcblxuICBpZiAoIW1haW5QYWdlKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc3VwcG9ydCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5zdXBwb3J0Jyk7XG4gIGNvbnN0IHN1cHBvcnRDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuc3VwcG9ydF9fY29udGFpbmVyJyk7XG4gIGNvbnN0IGl0ZW1zID0gc3VwcG9ydC5xdWVyeVNlbGVjdG9yQWxsKCcuc3VwcG9ydF9faXRlbScpO1xuXG4gIGZ1bmN0aW9uIG1ha2VTbGlkZXIoKSB7XG4gICAgY29uc3QgZnJhZ21lbnQgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7XG4gICAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgY29udGFpbmVyLmNsYXNzTGlzdC5hZGQoJ3N3aXBlci1jb250YWluZXInKTtcbiAgICBjb250YWluZXIuY2xhc3NMaXN0LmFkZCgnc3VwcG9ydF9fc2xpZGVyJyk7XG4gICAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIHdyYXBwZXIuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXdyYXBwZXInKTtcblxuICAgIGl0ZW1zLmZvckVhY2goZnVuY3Rpb24oaXRlbSwgaWR4KSB7XG4gICAgICBjb25zdCBzbGlkZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgc2xpZGUuY2xhc3NMaXN0LmFkZCgnc3dpcGVyLXNsaWRlJylcbiAgICAgIGNvbnN0IG5vZGUgPSBpdGVtLmNsb25lTm9kZSh0cnVlKTtcbiAgICAgIHNsaWRlLmFwcGVuZENoaWxkKG5vZGUpO1xuICAgICAgd3JhcHBlci5hcHBlbmRDaGlsZChzbGlkZSk7XG4gICAgfSk7XG5cbiAgICBjb25zdCBwYWdpbmF0aW9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgcGFnaW5hdGlvbi5jbGFzc0xpc3QuYWRkKCdzdXBwb3J0X19zbGlkZXItcGFnaW5hdGlvbicsJ3N3aXBlci1wYWdpbmF0aW9uJyk7XG5cbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG4gICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHBhZ2luYXRpb24pO1xuICAgIGZyYWdtZW50LmFwcGVuZENoaWxkKGNvbnRhaW5lcik7XG5cbiAgICBzdXBwb3J0Q29udGFpbmVyLmFwcGVuZENoaWxkKGZyYWdtZW50KTtcblxuICAgIGNvbnN0IHNsaWRlciA9IG5ldyBTd2lwZXIoJy5zdXBwb3J0X19zbGlkZXInLCB7XG4gICAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgICAgcGFnaW5hdGlvbjoge1xuICAgICAgICBlbDogJy5zdXBwb3J0X19zbGlkZXItcGFnaW5hdGlvbidcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIG1ha2VTbGlkZXIoKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gICQoJy5zdXBwb3J0X19kb2NzLWJ0bicpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQodGhpcykucGFyZW50KCkubmV4dCgpLnNsaWRlVG9nZ2xlKCk7XG4gICAgJCh0aGlzKS50b2dnbGVDbGFzcygnb3BlbmVkJyk7XG4gIH0pXG59KSgpO1xuIiwiKGZ1bmN0aW9uKCkge1xuICBjb25zdCB0cmFuc2FjdGlvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcudHJhbnNhY3Rpb25zLW1vYmlsZS1ibG9jaycpO1xuXG4gIGlmICghdHJhbnNhY3Rpb25zKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3Qgc2xpZGVyID0gbmV3IFN3aXBlcignLnRyYW5zYWN0aW9ucy1tb2JpbGUtYmxvY2tfX3NsaWRlcicsIHtcbiAgICBzbGlkZXNQZXJWaWV3OiAxLFxuICAgIHBhZ2luYXRpb246IHtcbiAgICAgIGVsOiAnLnRyYW5zYWN0aW9ucy1tb2JpbGUtYmxvY2tfX3BhZ2luYXRpb24nLFxuICAgICAgZHluYW1pY0J1bGxldHM6IHRydWUsXG4gICAgfVxuICB9KTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIGNvbnN0IHZlcmlmaWNhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKTtcblxuICBpZiAoIXZlcmlmaWNhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZlcmlmaWNhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gY29uc3QgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yKCcudmVyaWZpY2F0aW9uX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIC8vIGNvbnN0IGZpbGVJbnB1dCA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICAvLyBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgLy8gY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICAvLyBjb25zdCBzYXZlQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLm1vZGFsX19zYXZlJyk7XG5cbiAgLy8gY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5jb250YWlucygnbG9hZGVkJykpIHtcbiAgLy8gICAgIGZpbGVJbnB1dEJsb2NrLmNsYXNzTGlzdC5yZW1vdmUoJ2xvYWRlZCcpO1xuXG4gIC8vICAgICBmaWxlSW5wdXQudmFsdWUgPSAnJztcbiAgLy8gICAgIHNhdmVCdG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAvLyAgICAgaWYoIS9zYWZhcmkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpKXtcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnJztcbiAgLy8gICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gIC8vICAgICB9XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gY29uc3Qgb25PdmVybGF5Q2xpY2sgPSBmdW5jdGlvbihlKSB7XG4gIC8vICAgaWYgKGUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucygnbW9kYWxfX292ZXJsYXknKSkge1xuICAvLyAgICAgb25DbG9zZUNsaWNrKCk7XG4gIC8vICAgfVxuICAvLyB9XG5cbiAgLy8gY29uc3Qgb25JbnB1dENoYW5nZSA9IGZ1bmN0aW9uKCkge1xuICAvLyAgIGlmIChmaWxlSW5wdXQudmFsdWUgIT09ICcnKSB7XG4gIC8vICAgICBzYXZlQnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgLy8gICB9XG4gIC8vIH1cblxuICB2ZXJpZmljYXRpb25CdG4uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSlcblxuICAvLyBjbG9zZS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIG9uQ2xvc2VDbGljayk7XG4gIC8vIG92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbk92ZXJsYXlDbGljayk7XG4gIC8vIGZpbGVJbnB1dC5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCBvbklucHV0Q2hhbmdlKTtcbn0pKCk7XG4iLCIoZnVuY3Rpb24oKSB7XG4gIC8vIGNvbnN0IHZlcmlmaWNhdGlvbkJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5jb250cmFjdC1pbmZvX192ZXJpZmljYXRpb24nKTtcblxuICAvLyBpZiAoIXZlcmlmaWNhdGlvbkJ0blswXSkge1xuICAvLyAgIHJldHVybjtcbiAgLy8gfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZlcmlmaWNhdGlvbl9fbW9kYWwnKTtcblxuICBpZiAoIW1vZGFsKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgY29uc3QgZmlsZUlucHV0QmxvY2sgPSBtb2RhbC5xdWVyeVNlbGVjdG9yQWxsKCcudmVyaWZpY2F0aW9uX19tb2RhbC1pbnB1dC1maWxlJyk7XG4gIC8vY29uc3QgZmlsZUlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmlucHV0LWZpbGVfX2lucHV0Jyk7XG4gIC8vY29uc3QgZmlsZUNsZWFyID0gbW9kYWwucXVlcnlTZWxlY3RvcignLmZpbGUtbG9hZF9fY2xlYXInKTtcblxuICBjb25zdCBjbG9zZSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fY2xvc2UnKTtcbiAgY29uc3Qgb3ZlcmxheSA9IG1vZGFsLnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbF9fb3ZlcmxheScpO1xuICBjb25zdCBzYXZlQnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19zYXZlJyk7XG5cbiAgY29uc3Qgb25DbG9zZUNsaWNrID0gZnVuY3Rpb24oKSB7XG4gICAgZmlsZUlucHV0QmxvY2suZm9yRWFjaChmdW5jdGlvbihpbnB1dEJsb2NrKSB7XG4gICAgICBjb25zdCBmaWxlSW5wdXQgPSBpbnB1dEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuXG4gICAgICBpZiAoaW5wdXRCbG9jay5jbGFzc0xpc3QuY29udGFpbnMoJ2xvYWRlZCcpKSB7XG4gICAgICAgIGlucHV0QmxvY2suY2xhc3NMaXN0LnJlbW92ZSgnbG9hZGVkJyk7XG5cbiAgICAgICAgZmlsZUlucHV0LnZhbHVlID0gJyc7XG4gICAgICAgIHNhdmVCdG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcblxuICAgICAgICBpZighL3NhZmFyaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCkpe1xuICAgICAgICAgIGZpbGVJbnB1dC50eXBlID0gJyc7XG4gICAgICAgICAgZmlsZUlucHV0LnR5cGUgPSAnZmlsZSc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgY29uc3QgY2hlY2tJbnB1dHMgPSBmdW5jdGlvbigpIHtcbiAgICBsZXQgZmlsbGVkID0gdHJ1ZTtcblxuICAgIGZpbGVJbnB1dEJsb2NrLmZvckVhY2goZnVuY3Rpb24oaW5wdXRCbG9jaykge1xuICAgICAgY29uc3QgZmlsZUlucHV0ID0gaW5wdXRCbG9jay5xdWVyeVNlbGVjdG9yKCcuaW5wdXQtZmlsZV9faW5wdXQnKTtcblxuICAgICAgaWYgKGZpbGVJbnB1dC52YWx1ZSA9PT0gJycpIHtcbiAgICAgICAgZmlsbGVkID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAoZmlsbGVkICYmIHNhdmVCdG4uaGFzQXR0cmlidXRlKCdkaXNhYmxlZCcpKSB7XG4gICAgICBzYXZlQnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICB9XG5cbiAgICBpZiAoIWZpbGxlZCAmJiAhc2F2ZUJ0bi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgIHNhdmVCdG4uc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgICB9XG4gIH1cblxuICBjb25zdCBvbk92ZXJsYXlDbGljayA9IGZ1bmN0aW9uKGUpIHtcbiAgICBpZiAoZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKCdtb2RhbF9fb3ZlcmxheScpKSB7XG4gICAgICBvbkNsb3NlQ2xpY2soKTtcbiAgICB9XG4gIH1cblxuICAvLyBjb25zdCBvbklucHV0Q2hhbmdlID0gZnVuY3Rpb24oKSB7XG4gIC8vICAgaWYgKGZpbGVJbnB1dC52YWx1ZSAhPT0gJycpIHtcbiAgLy8gICAgIHNhdmVCdG4ucmVtb3ZlQXR0cmlidXRlKCdkaXNhYmxlZCcpO1xuICAvLyAgIH1cbiAgLy8gfVxuXG4gIGNvbnN0IG9uRmlsZUNsZWFyID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCFzYXZlQnRuLmhhc0F0dHJpYnV0ZSgnZGlzYWJsZWQnKSkge1xuICAgICAgc2F2ZUJ0bi5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICAgIH1cbiAgfVxuXG4gIC8vIHZlcmlmaWNhdGlvbkJ0bi5mb3JFYWNoKGZ1bmN0aW9uKGl0ZW0pIHtcbiAgLy8gICBuZXcgTW9kYWwoaXRlbSwgbW9kYWwpO1xuICAvLyB9KVxuXG4gIHdpbmRvdy5vblZlcmlmaWNhdGlvbkZpbGVEcm9wID0gZnVuY3Rpb24oKSB7XG4gICAgY2hlY2tJbnB1dHMoKTtcbiAgfTtcblxuICBmaWxlSW5wdXRCbG9jay5mb3JFYWNoKGZ1bmN0aW9uKGlucHV0QmxvY2spIHtcbiAgICBjb25zdCBmaWxlSW5wdXQgPSBpbnB1dEJsb2NrLnF1ZXJ5U2VsZWN0b3IoJy5pbnB1dC1maWxlX19pbnB1dCcpO1xuICAgIGNvbnN0IGZpbGVDbGVhciA9IGlucHV0QmxvY2sucXVlcnlTZWxlY3RvcignLmZpbGUtbG9hZF9fY2xlYXInKTtcblxuXG4gICAgZmlsZUlucHV0LmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIHdpbmRvdy5vblZlcmlmaWNhdGlvbkZpbGVEcm9wKTtcbiAgICBmaWxlQ2xlYXIuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkZpbGVDbGVhcik7XG4gIH0pXG5cbiAgY2xvc2UuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBvbkNsb3NlQ2xpY2spO1xuICBvdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgb25PdmVybGF5Q2xpY2spO1xufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgY29uc3QgY2FuY2VsbGF0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWluZm9fX3NlcmlhbC1idG4nKTtcblxuICBpZiAoIWNhbmNlbGxhdGlvbkJ0blswXSkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IG1vZGFsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dyaXRlLXNlcmlhbCcpO1xuXG4gIGlmICghbW9kYWwpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBjYW5jZWxsYXRpb25CdG4uZm9yRWFjaChmdW5jdGlvbihpdGVtKSB7XG4gICAgbmV3IE1vZGFsKGl0ZW0sIG1vZGFsKTtcbiAgfSk7XG5cblxufSkoKTtcbiIsIihmdW5jdGlvbigpIHtcbiAgLy8gY29uc3QgdmVyaWZpY2F0aW9uQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbnRyYWN0LWluZm9fX3ZlcmlmaWNhdGlvbicpO1xuXG4gIC8vIGlmICghdmVyaWZpY2F0aW9uQnRuWzBdKSB7XG4gIC8vICAgcmV0dXJuO1xuICAvLyB9XG5cbiAgY29uc3QgbW9kYWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd3JpdGUtc2VyaWFsJyk7XG5cbiAgaWYgKCFtb2RhbCkge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIGNvbnN0IGlucHV0ID0gbW9kYWwucXVlcnlTZWxlY3RvcignLndyaXRlLXNlcmlhbF9faW5wdXQgLmlucHV0LXRleHQnKTtcbiAgY29uc3QgYnRuID0gbW9kYWwucXVlcnlTZWxlY3RvcignLm1vZGFsX19zYXZlJyk7XG5cbiAgY29uc3Qgb25JbnB1dCA9IGZ1bmN0aW9uKGUpIHtcbiAgICBjb25zdCB2YWx1ZSA9IGUudGFyZ2V0LnZhbHVlO1xuXG4gICAgaWYgKFxuICAgICAgdmFsdWUuc3BsaXQoJyAnKS5qb2luKCcnKSAhPT0gJydcbiAgICAgICYmIHZhbHVlLmxlbmd0aCA+IDBcbiAgICAgICYmIGJ0bi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICApIHtcbiAgICAgIGJ0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJylcbiAgICB9XG5cbiAgICBpZiAoXG4gICAgICB2YWx1ZS5zcGxpdCgnICcpLmpvaW4oJycpID09PSAnJ1xuICAgICAgfHwgdmFsdWUubGVuZ3RoID09PSAwXG4gICAgKSB7XG4gICAgICBpZiAoIWJ0bi5oYXNBdHRyaWJ1dGUoJ2Rpc2FibGVkJykpIHtcbiAgICAgICAgYnRuLnNldEF0dHJpYnV0ZSgnZGlzYWJsZWQnLCAnJyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLy8gdmVyaWZpY2F0aW9uQnRuLmZvckVhY2goZnVuY3Rpb24oaXRlbSkge1xuICAvLyAgIG5ldyBNb2RhbChpdGVtLCBtb2RhbCk7XG4gIC8vIH0pXG5cbiAgaW5wdXQuYWRkRXZlbnRMaXN0ZW5lcignaW5wdXQnLCBvbklucHV0KTtcbn0pKCk7XG4iXX0=
